<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hexoåšå®¢æ­å»ºè®°å½•</title>
    <url>/2021/04/24/Hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h1 id="é—®é¢˜1-Hexoæœ¬åœ°åšå®¢é¢„è§ˆæ­£å¸¸ï¼Œdeployåˆ°githubä¹‹åæ— æ ¼å¼æ˜¾ç¤ºï¼ˆç©ºç™½æ˜¾ç¤ºï¼‰"><a href="#é—®é¢˜1-Hexoæœ¬åœ°åšå®¢é¢„è§ˆæ­£å¸¸ï¼Œdeployåˆ°githubä¹‹åæ— æ ¼å¼æ˜¾ç¤ºï¼ˆç©ºç™½æ˜¾ç¤ºï¼‰" class="headerlink" title="é—®é¢˜1:Hexoæœ¬åœ°åšå®¢é¢„è§ˆæ­£å¸¸ï¼Œdeployåˆ°githubä¹‹åæ— æ ¼å¼æ˜¾ç¤ºï¼ˆç©ºç™½æ˜¾ç¤ºï¼‰"></a>é—®é¢˜1:Hexoæœ¬åœ°åšå®¢é¢„è§ˆæ­£å¸¸ï¼Œdeployåˆ°githubä¹‹åæ— æ ¼å¼æ˜¾ç¤ºï¼ˆç©ºç™½æ˜¾ç¤ºï¼‰</h1><p>æœ€å¼€å§‹ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯Nextä¸»é¢˜ï¼Œåœ¨ç½‘ä¸Šæ‰¾è¿‡è®¸å¤šç­”æ¡ˆï¼Œå…¶ä¸­ä¸€ç§é’ˆå¯¹Nextä¸»é¢˜ä»¥å‰çš„ä¸€ä¸ªé—®é¢˜æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼š<a href="https://github.com/iissnan/hexo-theme-next/issues/1214">vendorsæ–‡ä»¶ä¿®æ”¹</a>ï¼Œä½†æ˜¯vendorsæ–‡ä»¶å¤¹é—®é¢˜åœ¨éšåçš„Nextç‰ˆæœ¬ä¸­å¾—åˆ°äº†è§£å†³ã€‚</p>
<p>å¦‚ä»Šåˆå‡ºç°è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘æ ¹æ®ç½‘ä¸Šçš„å„ç§å›ç­”è¿›è¡Œäº†è®¸å¤šåœ°æ–¹çš„ä¸€ä¸ªä¿®æ”¹ï¼Œè¿™é‡Œåšä¸ªæ€»ç»“ï¼š</p>
<ol>
<li>é¦–å…ˆæ˜¯åœ¨æœ¬åœ°deployä¹‹å‰ï¼Œå…ˆæ‰§è¡Œ<strong>hexo clean</strong>ï¼Œæ¥æ¸…é™¤ç›¸å…³ç¼“å­˜ï¼Œç„¶åhexo g &amp;&amp; hexo dï¼ˆå¯ä»¥å¤šæ‰§è¡Œå‡ éï¼‰</li>
<li>åœ¨ä¹‹å‰æ­å»ºgithubä¸»é¡µæ—¶ï¼Œgithubé»˜è®¤ç»™æˆ‘è®¾ç½®çš„åˆ†æ”¯æ˜¯mainï¼Œçœ‹åˆ°è¿‡ç½‘ä¸Šçš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å°†åˆ†æ”¯åä»mainæ”¹æˆmasterï¼ˆgithubæƒé™é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿï¼‰</li>
<li><strong>æ¸…é™¤æµè§ˆå™¨çš„ç¼“å­˜</strong>ï¼Œåœ¨æˆ‘çš„å®é™…åˆ·æ–°æ¥çœ‹ï¼Œè¿™ä¸ªåŠæ³•åº”è¯¥æ˜¯æœ€æœ‰ç”¨çš„ï¼Œæˆ‘ç”¨chromeå’Œsafariéƒ½éªŒè¯è¿‡äº†ã€‚<a href="https://www.cnblogs.com/Chesky/p/chrome_disabling_cache.html">æ¸…é™¤Chromeæµè§ˆå™¨æŒ‡å®šç½‘é¡µç¼“å­˜</a>ï¼Œæ¯æ¬¡åŠ è½½ç½‘ç«™éƒ½èƒ½é‡æ–°è½½å…¥ã€‚</li>
<li>Hexoæœ¬åœ°ç½‘ç«™æ ¹ç›®å½•ä¸‹é¢çš„_config.ymlæ–‡ä»¶é…ç½®ä¸å¯¹ã€‚åœ¨deployè®¾ç½®ä¸­branché€‰é¡¹çš„å€¼åº”è¯¥å’Œä½ åœ¨githubé¡¹ç›®çš„åˆ†æ”¯ä¿æŒä¸€è‡´ã€‚è‡³äºé…ç½®æ–‡ä»¶çš„urlè®¾ç½®ï¼Œä¸ªäººè®¤ä¸ºæ²¡å½±å“ï¼Œåœ¨æˆ‘çš„ä½¿ç”¨æ¥çœ‹ï¼Œè¿™ä¸ªurlä¸»è¦æ˜¯å½±å“ç½‘ç«™sitemap.xmlæ–‡ä»¶çš„ç”Ÿæˆå’Œæœ‰æ•ˆæ€§ã€‚</li>
</ol>
<h1 id="é—®é¢˜2-Hexoåšå®¢é¡µé¢åŠ è½½ç¼“æ…¢æˆ–è€…å¡é¡¿"><a href="#é—®é¢˜2-Hexoåšå®¢é¡µé¢åŠ è½½ç¼“æ…¢æˆ–è€…å¡é¡¿" class="headerlink" title="é—®é¢˜2:Hexoåšå®¢é¡µé¢åŠ è½½ç¼“æ…¢æˆ–è€…å¡é¡¿"></a>é—®é¢˜2:Hexoåšå®¢é¡µé¢åŠ è½½ç¼“æ…¢æˆ–è€…å¡é¡¿</h1><p>ç°åœ¨ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯<a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterflyä¸»é¢˜</a>ï¼Œæ‰€åšçš„æ›´æ”¹åŸºæœ¬éƒ½æ˜¯<a href="https://butterfly.js.org/">Jerryçš„æ•™ç¨‹</a>å»ºè®®çš„</p>
<ol>
<li><p>æœ€ç›´è§‚çš„æ–¹æ³•å°±æ˜¯åœ¨åŠ è½½ç½‘é¡µåï¼ŒF12æ‰“å¼€æµè§ˆå™¨çš„å¼€å‘è€…æ¨¡å¼ï¼Œé€‰åˆ°Consoleï¼Œç„¶åå°±èƒ½çœ‹åˆ°åŠ è½½Hexoç½‘é¡µæ—¶å‡ºç°äº†å“ªäº›é”™è¯¯ã€‚ä¸‹å›¾æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ‰“å¼€Consoleæ—¶å‡ºç°çš„é”™è¯¯å›¾ï¼š</p>
<p><img src="/images/Hexo-blog-build-record/chrome-F12-Console-errors.jpg"></p>
<p>ç„¶åå°±å¯ä»¥æ ¹æ®é”™è¯¯å¯¹ä¸»é¢˜æˆ–è€…ç«™ç‚¹é…ç½®æ–‡ä»¶è¿›è¡Œå“åº”çš„æ”¹åŠ¨ï¼Œè®°å¾—æ”¹åŠ¨ä¹‹å‰å¤‡ä»½ï¼Œä¸ç„¶ä½ å¯èƒ½ä¼šåæ‚”çš„</p>
</li>
<li><p>åˆ é™¤ä¸€äº›æ— å…³çš„æ’ä»¶ï¼Œ<a href="https://www.dazhuanlan.com/2019/10/12/5da110cdd9a7b/">å¸è½½ hexo æ’ä»¶</a></p>
</li>
</ol>
<h1 id="é—®é¢˜3-Hexoå’ŒTyporaå›¾åƒå­˜å‚¨å’Œè®¾ç½®é—®é¢˜"><a href="#é—®é¢˜3-Hexoå’ŒTyporaå›¾åƒå­˜å‚¨å’Œè®¾ç½®é—®é¢˜" class="headerlink" title="é—®é¢˜3:Hexoå’ŒTyporaå›¾åƒå­˜å‚¨å’Œè®¾ç½®é—®é¢˜"></a>é—®é¢˜3:Hexoå’ŒTyporaå›¾åƒå­˜å‚¨å’Œè®¾ç½®é—®é¢˜</h1><p>å·²è§£å†³-ä¸ªäººè§‰å¾—å¾ˆå¥½çš„ä¸€ä¸ªå›ç­”ï¼š<a href="https://yinyoupoet.github.io/2019/09/03/hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87/">typora + hexoåšå®¢ä¸­æ’å…¥å›¾ç‰‡</a></p>
<h1 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h1><ol>
<li><a href="https://www.jianshu.com/p/c9d3a53fb8e3">Hexoé¡µé¢åŠ è½½æ€§èƒ½ä¼˜åŒ–</a></li>
<li><a href="https://link.jianshu.com/?t=http://www.ieclipse.cn/2016/08/29/Web/Hexo-deploy-lines/">Hexoåšå®¢åŒçº¿éƒ¨ç½²</a></li>
<li><a href="https://gaomf.cn/2015/11/01/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E5%8A%A0%E8%BD%BD%E9%80%9F%E5%BA%A6/">Hexoåšå®¢ä¼˜åŒ–åŠ è½½é€Ÿåº¦</a></li>
<li><a href="https://blog.csdn.net/weixin_44676935/article/details/107440479">Hexoåšå®¢å› å›¾æ ‡å¤±æ•ˆå¯¼è‡´åŠ è½½è¿‡æ…¢ï¼ˆicarusä¸»é¢˜ï¼‰</a></li>
</ol>
]]></content>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaå¤šçº¿ç¨‹é«˜å¹¶å‘</title>
    <url>/2021/05/24/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/</url>
    <content><![CDATA[<h1 id="çº¿ç¨‹ç®€ä»‹"><a href="#çº¿ç¨‹ç®€ä»‹" class="headerlink" title="çº¿ç¨‹ç®€ä»‹"></a>çº¿ç¨‹ç®€ä»‹</h1><p>è§†é¢‘è¯¾ç¨‹åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1V4411p7EF?p=9">ã€ç‹‚ç¥è¯´Javaã€‘å¤šçº¿ç¨‹è¯¦è§£</a></p>
<p>å¤šä»»åŠ¡ã€å¤šçº¿ç¨‹ã€ç¨‹åºâ€“&gt;è¿›ç¨‹processâ€“&gt;çº¿ç¨‹thread</p>
<h1 id="çº¿ç¨‹åˆ›å»º"><a href="#çº¿ç¨‹åˆ›å»º" class="headerlink" title="çº¿ç¨‹åˆ›å»º"></a>çº¿ç¨‹åˆ›å»º</h1><h2 id="Thread-classâ€“-gt-ç»§æ‰¿Threadç±»ï¼ˆé‡ç‚¹ï¼‰"><a href="#Thread-classâ€“-gt-ç»§æ‰¿Threadç±»ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="Thread.classâ€“&gt;ç»§æ‰¿Threadç±»ï¼ˆé‡ç‚¹ï¼‰"></a>Thread.classâ€“&gt;ç»§æ‰¿Threadç±»ï¼ˆé‡ç‚¹ï¼‰</h2><p>run()æ–¹æ³•å’Œstart()æ–¹æ³•çš„åŒºåˆ«ï¼š</p>
<p><img src="/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/run&start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg"></p>
<p>æ ¹æ®Javaæ‰‹å†Œï¼ŒThreadå®ç°çš„æ¥å£æœ‰Runnableæ¥å£ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œçº¿ç¨‹æœ‰ä¸¤ç§æ–¹æ³•ã€‚ </p>
<p>ä¸€ä¸ªæ˜¯å°†ä¸€ä¸ªç±»å£°æ˜ä¸º<code>Thread</code>çš„å­ç±»ã€‚ è¿™ä¸ªå­ç±»åº”è¯¥é‡å†™<code>run</code>ç±»çš„æ–¹æ³•<code>Thread</code> ã€‚ ç„¶åå¯ä»¥åˆ†é…å¹¶å¯åŠ¨å­ç±»çš„å®ä¾‹ã€‚ ä¾‹å¦‚ï¼Œè®¡ç®—å¤§äºè§„å®šå€¼çš„ç´ æ•°çš„çº¿ç¨‹å¯ä»¥å†™æˆå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PrimeThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> minPrime;</span><br><span class="line">    PrimeThread(<span class="keyword">long</span> minPrime) &#123;</span><br><span class="line">        <span class="keyword">this</span>.minPrime = minPrime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// compute primes larger than minPrime</span></span><br><span class="line">         . . .</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œä»¥ä¸‹ä»£ç å°†åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å¯åŠ¨å®ƒè¿è¡Œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PrimeThread p = <span class="keyword">new</span> PrimeThread(<span class="number">143</span>);</span><br><span class="line">p.start();</span><br></pre></td></tr></table></figure>

<p>è‡ªå·±ç¼–å†™çš„ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> xidian.edu.cn.stu.ltf.multithread03;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> taifengliu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/05/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç»§æ‰¿Threadç±»ï¼Œé‡å†™run()æ–¹æ³•ï¼Œè°ƒç”¨startå¼€å¯çº¿ç¨‹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrimeThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// runæ–¹æ³•çº¿ç¨‹ä½“</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;run()-&quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// mainçº¿ç¨‹ï¼Œä¸»çº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œç„¶åè°ƒç”¨start()æ–¹æ³•</span></span><br><span class="line">        PrimeThread newThread1 = <span class="keyword">new</span> PrimeThread();</span><br><span class="line">        newThread1.start();  <span class="comment">// start()æ–¹æ³•ï¼Œä¼šå‘ç°ä¸¤æ¡çº¿ç¨‹æ˜¯åŒæ—¶æ‰§è¡Œçš„ï¼Œç©¿æ’å®ç°ï¼Œä¸”æ¯æ¬¡æ‰§è¡Œç»“æœä¸ä¸€æ ·</span></span><br><span class="line">        <span class="comment">//newThread1.run();  // run()æ–¹æ³•ä¼šå…ˆæ‰§è¡Œrunæ–¹æ³•ï¼Œç„¶åæ‰§è¡Œmain()æ–¹æ³•ï¼ˆè¿™æ˜¯å› ä¸ºæ–¹æ³•ä¹‹é—´æ˜¯å›ºå®šé¡ºåºï¼‰</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Main()---&quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»ƒä¹ ä¾‹å­ï¼šç½‘å›¾å¤šçº¿ç¨‹ä¸‹è½½ï¼Œéœ€è¦æå‰ä¸‹è½½å¹¶å¯¼å…¥commons-io-2.6.jaråŒ…ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> xidian.edu.cn.stu.ltf.multithread04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: TaifengLiu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/5/25</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MultiPhotosDownload</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String url;  <span class="comment">// ç½‘ç»œå›¾ç‰‡åœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> String name;   <span class="comment">// ä¿å­˜çš„æ–‡ä»¶å</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MultiPhotosDownload</span><span class="params">(String url, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.url = url;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸‹è½½å›¾ç‰‡çš„ç»“æ„ä½“</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        WebDowmloader webDowmloader = <span class="keyword">new</span> WebDowmloader();</span><br><span class="line">        webDowmloader.downloader(url, name);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹è½½äº†æ–‡ä»¶åä¸ºï¼š&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MultiPhotosDownload multiPhotosDownload1 = <span class="keyword">new</span> MultiPhotosDownload(</span><br><span class="line">                <span class="string">&quot;https://koper.top/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/run&amp;start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg&quot;</span>,</span><br><span class="line">                <span class="string">&quot;1.jpg&quot;</span>);</span><br><span class="line">        MultiPhotosDownload multiPhotosDownload2 = <span class="keyword">new</span> MultiPhotosDownload(</span><br><span class="line">                <span class="string">&quot;https://koper.top/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/run&amp;start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg&quot;</span>,</span><br><span class="line">                <span class="string">&quot;2.jpg&quot;</span>);</span><br><span class="line">        MultiPhotosDownload multiPhotosDownload3 = <span class="keyword">new</span> MultiPhotosDownload(</span><br><span class="line">                <span class="string">&quot;https://koper.top/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/run&amp;start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg&quot;</span>,</span><br><span class="line">                <span class="string">&quot;3.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯ä»¥å‘ç°ä¸‹é¢ä¸æ˜¯é¡ºåºæ‰§è¡Œï¼Œå¤šçº¿ç¨‹</span></span><br><span class="line">        multiPhotosDownload1.start();</span><br><span class="line">        multiPhotosDownload2.start();</span><br><span class="line">        multiPhotosDownload3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ä¸‹è½½å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/5/25</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebDowmloader</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¸‹è½½æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">downloader</span><span class="params">(String url, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileUtils.copyURLToFile(<span class="keyword">new</span> URL(url),<span class="keyword">new</span> File(name));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;IOå¼‚å¸¸,downloader()æ–¹æ³•å‡ºç°é—®é¢˜&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Runnableæ¥å£â€“-gt-å®ç°Runnableæ¥å£ï¼ˆæ ¼å¤–é‡ç‚¹ï¼‰ğŸŒŸğŸŒŸğŸŒŸ"><a href="#Runnableæ¥å£â€“-gt-å®ç°Runnableæ¥å£ï¼ˆæ ¼å¤–é‡ç‚¹ï¼‰ğŸŒŸğŸŒŸğŸŒŸ" class="headerlink" title="Runnableæ¥å£â€“&gt;å®ç°Runnableæ¥å£ï¼ˆæ ¼å¤–é‡ç‚¹ï¼‰ğŸŒŸğŸŒŸğŸŒŸ"></a>Runnableæ¥å£â€“&gt;å®ç°Runnableæ¥å£ï¼ˆæ ¼å¤–é‡ç‚¹ï¼‰ğŸŒŸğŸŒŸğŸŒŸ</h2><p>æ ¹æ®Javaæ‰‹å†Œï¼Œå®ç°å¤šçº¿ç¨‹çš„ç¬¬äºŒç§æ–¹æ³•æ˜¯å®ç°Runnableæ¥å£ï¼Œå…¶å®è¿™ç§æ–¹æ³•å’Œç»§æ‰¿Threadå¾ˆåƒï¼Œå°±æ˜¯æ”¹äº†çº¿ç¨‹å¯åŠ¨çš„æ–¹æ³•ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ˜¯å£°æ˜å®ç°ç±»<code>Runnable</code>æ¥å£ã€‚ é‚£ä¸ªç±»ç„¶åå®ç°äº†<code>run</code>æ–¹æ³•ã€‚ ç„¶åå¯ä»¥åˆ†é…ç±»çš„å®ä¾‹ï¼Œåœ¨åˆ›å»º<code>Thread</code>æ—¶ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå¹¶å¯åŠ¨ã€‚ è¿™ç§å…¶ä»–é£æ ¼çš„åŒä¸€ä¸ªä¾‹å­å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PrimeRun</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> minPrime;</span><br><span class="line">    PrimeRun(<span class="keyword">long</span> minPrime) &#123;</span><br><span class="line">        <span class="keyword">this</span>.minPrime = minPrime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// compute primes larger than minPrime</span></span><br><span class="line">         . . .</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œä»¥ä¸‹ä»£ç å°†åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å¯åŠ¨å®ƒè¿è¡Œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PrimeRun p = <span class="keyword">new</span> PrimeRun(<span class="number">143</span>);</span><br><span class="line"><span class="keyword">new</span> Thread(p).start();</span><br></pre></td></tr></table></figure>

<p>è‡ªå·±å®ç°çš„ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> xidian.edu.cn.stu.ltf.multithread05;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: TaifengLiu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å®ç°Runnableæ¥å£ï¼Œé‡å†™run()æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/5/25</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImpRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;run()&quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ImpRunnable impRunnable = <span class="keyword">new</span> ImpRunnable();</span><br><span class="line">        <span class="keyword">new</span> Thread(impRunnable).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Main&quot;</span>+ i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹æ¯”-ç»§æ‰¿Threadå’ŒRunnableæ¥å£å®ç°çš„åŒºåˆ«å’Œä¼˜åŠ£åŠ¿ï¼š</p>
<p><img src="/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/threadvsrunnable.png"></p>
<p>å¹¶å‘é—®é¢˜ï¼šå¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºå¯¹è±¡ï¼Œä¼šå‡ºç°ç´Šä¹±ï¼Œæ —å­å¦‚ä¸‹ï¼ˆæŠ¢ç«è½¦ç¥¨ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> xidian.edu.cn.stu.ltf.multithread06;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: TaifengLiu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æµ‹è¯•Runnableå®ç°å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªå¯¹è±¡--ä¹°ç«è½¦ç¥¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/5/25</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ticketNums = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ticketNums &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿå»¶æ—¶</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">200</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() +  <span class="string">&quot;æ‹¿åˆ°äº†ç¬¬&quot;</span> + ticketNums-- + <span class="string">&quot;ç¥¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        TestThread testThread = <span class="keyword">new</span> TestThread();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‘ç°é—®é¢˜ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºçš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•°æ®ç´Šä¹±----çº¿ç¨‹åŒæ­¥çš„æ—¶å€™è§£å†³</span></span><br><span class="line">        <span class="keyword">new</span> Thread(testThread, <span class="string">&quot;1&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(testThread, <span class="string">&quot;2&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(testThread, <span class="string">&quot;3&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç è¾“å‡ºç»“æœï¼šå‡ºç°äº†æŠ¢åŒä¸€å¼ ç¥¨ä»¥åŠæœ‰äººæŠ¢åˆ°è´Ÿæ•°ç¥¨ï¼Œä¸ç°å®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">3æ‹¿åˆ°äº†ç¬¬8ç¥¨</span><br><span class="line">1æ‹¿åˆ°äº†ç¬¬10ç¥¨</span><br><span class="line">2æ‹¿åˆ°äº†ç¬¬9ç¥¨</span><br><span class="line">1æ‹¿åˆ°äº†ç¬¬7ç¥¨</span><br><span class="line">2æ‹¿åˆ°äº†ç¬¬7ç¥¨</span><br><span class="line">3æ‹¿åˆ°äº†ç¬¬7ç¥¨</span><br><span class="line">2æ‹¿åˆ°äº†ç¬¬5ç¥¨</span><br><span class="line">3æ‹¿åˆ°äº†ç¬¬4ç¥¨</span><br><span class="line">1æ‹¿åˆ°äº†ç¬¬6ç¥¨</span><br><span class="line">2æ‹¿åˆ°äº†ç¬¬3ç¥¨</span><br><span class="line">1æ‹¿åˆ°äº†ç¬¬2ç¥¨</span><br><span class="line">3æ‹¿åˆ°äº†ç¬¬2ç¥¨</span><br><span class="line">2æ‹¿åˆ°äº†ç¬¬1ç¥¨</span><br><span class="line">3æ‹¿åˆ°äº†ç¬¬-1ç¥¨</span><br><span class="line">1æ‹¿åˆ°äº†ç¬¬0ç¥¨</span><br></pre></td></tr></table></figure>

<p>å¹¶å‘çš„ä¾‹å­-é¾Ÿå…”èµ›è·‘ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> xidian.edu.cn.stu.ltf.multithread07;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.plaf.TableHeaderUI;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: TaifengLiu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å¤šçº¿ç¨‹æ¨¡æ‹Ÿé¾Ÿå…”èµ›è·‘ï¼Œå…”å­ä¸­é—´ç¡ä¼šå„¿è§‰ï¼Œæœ€ç»ˆçœ‹è°å…ˆåˆ°ç»ˆç‚¹å…ˆèƒœåˆ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/5/25</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Race</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// èƒœåˆ©è€…</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String winner;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿå…”å­ä¼‘æ¯</span></span><br><span class="line">            <span class="keyword">if</span> (Thread.currentThread().getName().equals(<span class="string">&quot;å…”å­&quot;</span>) &amp;&amp; i%<span class="number">10</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">2</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ¯”èµ›æ˜¯å¦ç»“æŸ</span></span><br><span class="line">            <span class="keyword">boolean</span> flag = gameover(i);</span><br><span class="line">            <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;--&gt;è·‘äº†&quot;</span> + i + <span class="string">&quot;æ­¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦å®Œæˆæ¯”èµ›</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">gameover</span><span class="params">(<span class="keyword">int</span> steps)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦æœ‰èƒœåˆ©è€…</span></span><br><span class="line">        <span class="keyword">if</span> (winner != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;&#123;</span><br><span class="line">            <span class="keyword">if</span> (steps == <span class="number">100</span>) &#123;</span><br><span class="line">                winner = Thread.currentThread().getName();</span><br><span class="line">                System.out.println(<span class="string">&quot;The winner is: &quot;</span> + winner);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Race race = <span class="keyword">new</span> Race();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread(race, <span class="string">&quot;å…”å­&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(race, <span class="string">&quot;ä¹Œé¾Ÿ&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Callableæ¥å£â€“-gt-å®ç°Callableæ¥å£ï¼ˆäº†è§£ï¼‰"><a href="#Callableæ¥å£â€“-gt-å®ç°Callableæ¥å£ï¼ˆäº†è§£ï¼‰" class="headerlink" title="Callableæ¥å£â€“&gt;å®ç°Callableæ¥å£ï¼ˆäº†è§£ï¼‰"></a>Callableæ¥å£â€“&gt;å®ç°Callableæ¥å£ï¼ˆäº†è§£ï¼‰</h2><p>è‡ªå·±çš„ä»£ç å®ç°-ç½‘å›¾å¤šçº¿ç¨‹ä¸‹è½½-å®ç°Callableæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> xidian.edu.cn.stu.ltf.multithread08;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"><span class="keyword">import</span> xidian.edu.cn.stu.ltf.multithread04.MultiPhotosDownload;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: TaifengLiu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å®ç°Callableå¤šçº¿ç¨‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/5/25</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImpCallable</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">Boolean</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String url;  <span class="comment">// ç½‘ç»œå›¾ç‰‡åœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> String name;   <span class="comment">// ä¿å­˜çš„æ–‡ä»¶å</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ImpCallable</span><span class="params">(String url, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.url = url;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸‹è½½å›¾ç‰‡çš„ç»“æ„ä½“</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        WebDowmloader1 webDowmloader = <span class="keyword">new</span> WebDowmloader1();</span><br><span class="line">        webDowmloader.downloader1(url, name);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹è½½äº†æ–‡ä»¶åä¸ºï¼š&quot;</span> + name);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException </span>&#123;</span><br><span class="line">        ImpCallable impCallable1 = <span class="keyword">new</span> ImpCallable(</span><br><span class="line">                <span class="string">&quot;https://koper.top/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/run&amp;start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg&quot;</span>,</span><br><span class="line">                <span class="string">&quot;1.jpg&quot;</span>);</span><br><span class="line">        ImpCallable impCallable2  = <span class="keyword">new</span> ImpCallable(</span><br><span class="line">                <span class="string">&quot;https://koper.top/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/run&amp;start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg&quot;</span>,</span><br><span class="line">                <span class="string">&quot;2.jpg&quot;</span>);</span><br><span class="line">        ImpCallable impCallable3 = <span class="keyword">new</span> ImpCallable(</span><br><span class="line">                <span class="string">&quot;https://koper.top/images/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91/run&amp;start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg&quot;</span>,</span><br><span class="line">                <span class="string">&quot;3.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯ä»¥å‘ç°ä¸‹é¢ä¸æ˜¯é¡ºåºæ‰§è¡Œï¼Œå¤šçº¿ç¨‹</span></span><br><span class="line">        ExecutorService ser = Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line">        Future&lt;Boolean&gt; result1 = ser.submit(impCallable1);</span><br><span class="line">        Future&lt;Boolean&gt; result2 = ser.submit(impCallable2);</span><br><span class="line">        Future&lt;Boolean&gt; result3 = ser.submit(impCallable3);</span><br><span class="line">        <span class="keyword">boolean</span> r1 = result1.get();</span><br><span class="line">        <span class="keyword">boolean</span> r2 = result2.get();</span><br><span class="line">        <span class="keyword">boolean</span> r3 = result3.get();</span><br><span class="line"></span><br><span class="line">        ser.shutdownNow();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ä¸‹è½½å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/5/25</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebDowmloader1</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¸‹è½½æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">downloader1</span><span class="params">(String url, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileUtils.copyURLToFile(<span class="keyword">new</span> URL(url),<span class="keyword">new</span> File(name));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;IOå¼‚å¸¸,downloader()æ–¹æ³•å‡ºç°é—®é¢˜&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>LeetCode</title>
    <url>/2021/04/27/LeetCode/</url>
    <content><![CDATA[<h1 id="Array-35ï¼ˆsearch-insert-positionï¼‰"><a href="#Array-35ï¼ˆsearch-insert-positionï¼‰" class="headerlink" title="Array_35ï¼ˆsearch-insert-positionï¼‰"></a>Array_35ï¼ˆsearch-insert-positionï¼‰</h1><p>å…ˆç¡®è®¤æŸ¥æ‰¾ç®—æ³•æ˜¯äºŒåˆ†æŸ¥æ‰¾ï¼ˆbinary-searchï¼‰ï¼Œå°†<a href="https://leetcode-cn.com/problems/binary-search/">äºŒåˆ†æŸ¥æ‰¾çš„ç®—æ³•</a>è§£äº†ä¸€æ¬¡ã€‚é—®é¢˜ï¼šæ‰§è¡Œç”¨æ—¶å¾ˆå°‘ï¼Œä½†å†…å­˜å ç”¨å¤š</p>
<p>å½“æ²¡æ‰¾åˆ°indexåï¼Œæ¯”è¾ƒtargetå’Œnums[pivot]ï¼Œè¿”å›æ’å…¥ä½ç½®å°±è¡Œã€‚é—®é¢˜ï¼šç©ºé—´å¤æ‚åº¦é«˜</p>
<p><img src="/images/LeetCode/search-insert-position-1.jpg"></p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://leetcode-cn.com/circle/article/wGp7Y9/">LeetCodeæœ€å¼ºåˆ·é¢˜æŒ‡å—</a></p>
<p><a href="https://github.com/youngyangyang04/leetcode-master">LeetCodeåˆ·é¢˜æ”»ç•¥</a></p>
]]></content>
      <tags>
        <tag>leetcode</tag>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>SSL/TLSç›¸å…³</title>
    <url>/2021/05/19/SSL-TLS%E7%9B%B8%E5%85%B3/</url>
    <content><![CDATA[<p><a href="https://www.rfc-editor.org/">RFCå®˜æ–¹æ–‡æ¡£</a>ï¼ˆPDF|HTMLï¼‰ï¼š<a href="https://www.rfc-editor.org/info/rfc2246">RFC-2246ï¼ˆTLS1.0ï¼‰</a>ã€<a href="https://www.rfc-editor.org/info/rfc4346">RFC-4346ï¼ˆTLS1.1ï¼‰</a>ã€<a href="https://www.rfc-editor.org/info/rfc5246">RFC-5246ï¼ˆTLS1.2ï¼‰</a>ã€<a href="https://www.rfc-editor.org/info/rfc8446">RFC-8446ï¼ˆTLS1.3ï¼‰</a>ã€RFC-4492ã€RFC-5764ã€<a href="https://www.rfc-editor.org/info/rfc5878">RFC-5878</a>ã€<a href="https://www.rfc-editor.org/info/rfc5077">RFC-5077</a>ã€</p>
]]></content>
      <tags>
        <tag>ssl/tls</tag>
      </tags>
  </entry>
  <entry>
    <title>TLS-Attackeræ¡†æ¶ï¼šé¡¹ç›®å¤ç°</title>
    <url>/2021/04/24/TLS-Attacker%E6%A1%86%E6%9E%B6%EF%BC%9A%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="ç†Ÿæ‚‰TLS-Attackeråº•å±‚é€šä¿¡"><a href="#ç†Ÿæ‚‰TLS-Attackeråº•å±‚é€šä¿¡" class="headerlink" title="ç†Ÿæ‚‰TLS-Attackeråº•å±‚é€šä¿¡"></a>ç†Ÿæ‚‰TLS-Attackeråº•å±‚é€šä¿¡</h1><h2 id="ATTacks"><a href="#ATTacks" class="headerlink" title="ATTacks"></a>ATTacks</h2><h2 id="TLS-Core"><a href="#TLS-Core" class="headerlink" title="TLS-Core"></a>TLS-Core</h2><h3 id="constants-Packages"><a href="#constants-Packages" class="headerlink" title="constants(Packages)"></a>constants(Packages)</h3><h4 id="AlertByteLength-class"><a href="#AlertByteLength-class" class="headerlink" title="AlertByteLength.class"></a>AlertByteLength.class</h4><h4 id="AlertDescription-class"><a href="#AlertDescription-class" class="headerlink" title="AlertDescription.class"></a>AlertDescription.class</h4><h4 id="AlertLevel-class"><a href="#AlertLevel-class" class="headerlink" title="AlertLevel.class"></a>AlertLevel.class</h4><h4 id="AlgorithmResolver-class"><a href="#AlgorithmResolver-class" class="headerlink" title="AlgorithmResolver.class"></a>AlgorithmResolver.class</h4><p>ç”±å¯†ç ç»„ä»¶è§£æå‡ºå„ç§å…ƒä»¶ç®—æ³•å¹¶è¿”å›ï¼š</p>
<ol>
<li>PRFç®—æ³•</li>
<li>Digestç®—æ³•</li>
<li>KeyExchangeç®—æ³•</li>
<li>CertificateKeyç±»å‹</li>
<li>RequiredKeystoreï¼ˆå…¬é’¥ï¼‰ç®—æ³•</li>
<li>Cipherç®—æ³•</li>
<li>BulkCipherç®—æ³•</li>
<li>Cipherç±»å‹</li>
<li>Macç®—æ³•</li>
<li>HKDFç®—æ³•</li>
</ol>
<h4 id="AuthzDataFormat-class"><a href="#AuthzDataFormat-class" class="headerlink" title="AuthzDataFormat.class"></a>AuthzDataFormat.class</h4><p>è®¤è¯æˆæƒçš„æ ‡å‡†</p>
<h4 id="Bits-class"><a href="#Bits-class" class="headerlink" title="Bits.class"></a>Bits.class</h4><p>å®šä¹‰1å­—èŠ‚==8æ¯”ç‰¹</p>
<h4 id="BulkCipherAlgorithm-class"><a href="#BulkCipherAlgorithm-class" class="headerlink" title="BulkCipherAlgorithm.class"></a>BulkCipherAlgorithm.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: NULL,IDEA,DESede,DES40,DES,RC4,RC2,FORTEZZA,CAMELLIA,SEED,ARIA,CHACHA20_POLY1305,GOST28147,AES,SMS4;</span><br></pre></td></tr></table></figure>

<h4 id="CachedInfoType-class"><a href="#CachedInfoType-class" class="headerlink" title="CachedInfoType.class"></a>CachedInfoType.class</h4><p>ç¼“å­˜çš„ä¿¡æ¯ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: CERT((byte) 1), CERT_REQ((byte) 2)</span><br></pre></td></tr></table></figure>

<h4 id="CertificateKeyType-class"><a href="#CertificateKeyType-class" class="headerlink" title="CertificateKeyType.class"></a>CertificateKeyType.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: DH,ECDH,RSA,DSS,ECDSA,GOST01,GOST12,FORTEZZA,ECNRA,NONE,SM2</span><br></pre></td></tr></table></figure>

<h4 id="CertificateStatusRequestType-class"><a href="#CertificateStatusRequestType-class" class="headerlink" title="CertificateStatusRequestType.class"></a>CertificateStatusRequestType.class</h4><p>è¯ä¹¦çŠ¶æ€è¯·æ±‚ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: OCSP((int) 1), OCSP_multi((int) 2)</span><br></pre></td></tr></table></figure>

<h4 id="CertificateType-class"><a href="#CertificateType-class" class="headerlink" title="CertificateType.class"></a>CertificateType.class</h4><p>è¯ä¹¦ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: X509((byte) 0), OPEN_PGP((byte) 1), RAW_PUBLIC_KEY((byte) 2)</span><br></pre></td></tr></table></figure>

<h4 id="CertificateVerifiyConstants-class"><a href="#CertificateVerifiyConstants-class" class="headerlink" title="CertificateVerifiyConstants.class"></a>CertificateVerifiyConstants.class</h4><p>è¯ä¹¦éªŒè¯å¸¸é‡çš„å…¨å±€å˜é‡å®šä¹‰</p>
<h4 id="ChangeCipherSpecByteLength-class"><a href="#ChangeCipherSpecByteLength-class" class="headerlink" title="ChangeCipherSpecByteLength.class"></a>ChangeCipherSpecByteLength.class</h4><p>å®šä¹‰äº†Change Cipher Specå¯†é’¥å˜æ›´åè®®çš„ç±»å‹é•¿åº¦ï¼ˆå›ºå®šï¼‰<em>TYPE_LENGTH</em> = 1</p>
<h4 id="ChooserType-class"><a href="#ChooserType-class" class="headerlink" title="ChooserType.class"></a>ChooserType.class</h4><p>å®šä¹‰äº†é€‰æ‹©å™¨çš„ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: DEFAULT</span><br></pre></td></tr></table></figure>

<h4 id="CipherAlgorithm-class"><a href="#CipherAlgorithm-class" class="headerlink" title="CipherAlgorithm.class"></a>CipherAlgorithm.class</h4><p>å¯¹ç§°å¯†ç ç®—æ³•åŠå…¶åˆ°Javaåç§°çš„æ˜ å°„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum:</span><br><span class="line">NULL(0, 0, 0, 0),</span><br><span class="line">RC2_128(16, 8, 0, 8, &quot;RC2&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">RC4_128(16, 0, 0, 0, &quot;RC4&quot;),</span><br><span class="line">DES_CBC(8, 8, 0, 8, &quot;DES&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">DES_EDE_CBC(24, 8, 0, 8, &quot;DESede&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">AES_128_CBC(16, 16, 0, 16, &quot;AES&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">AES_256_CBC(32, 16, 0, 16, &quot;AES&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">AES_128_GCM(16, 4, 8, 16, &quot;AES&#x2F;GCM&#x2F;NoPadding&quot;),</span><br><span class="line">AES_256_GCM(32, 4, 8, 16, &quot;AES&#x2F;GCM&#x2F;NoPadding&quot;),</span><br><span class="line">CAMELLIA_128_CBC(16, 16, 0, 16, &quot;Camellia&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">CAMELLIA_256_CBC(32, 16, 0, 16, &quot;Camellia&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">CAMELLIA_128_GCM(16, 16, 8, 16, &quot;Camellia&#x2F;GCM&#x2F;NoPadding&quot;),</span><br><span class="line">CAMELLIA_256_GCM(32, 16, 8, 16, &quot;Camellia&#x2F;GCM&#x2F;NoPadding&quot;),</span><br><span class="line">IDEA_128(16, 8, 0, 8, &quot;IDEA&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">SEED_CBC(16, 16, 0, 16, &quot;SEED&#x2F;CBC&#x2F;NoPadding&quot;),</span><br><span class="line">AES_128_CCM(16, 4, 8, 16, &quot;AES&#x2F;CCM&#x2F;NoPadding&quot;),</span><br><span class="line">AES_256_CCM(32, 4, 8, 16, &quot;AES&#x2F;CCM&#x2F;NoPadding&quot;),</span><br><span class="line">ChaCha20Poly1305(32, 12, 0, 0, &quot;ChaCha20Poly1305&quot;),</span><br><span class="line">DES40_CBC(8, 8, 0, 8, &quot;DES&#x2F;CBC&#x2F;NoPadding&quot;), &#x2F;&#x2F; currently uses des 56bit</span><br><span class="line">ARIA_128_CBC(16, 16, 0, 16, &quot;ARIA&#x2F;CBC&#x2F;NoPadding&quot;), &#x2F;&#x2F; not tested yet</span><br><span class="line">ARIA_256_CBC(32, 16, 0, 16, &quot;ARIA&#x2F;CBC&#x2F;NoPadding&quot;), &#x2F;&#x2F; not tested yet</span><br><span class="line">ARIA_128_GCM(16, 16, 8, 16, &quot;ARIA&#x2F;GCM&#x2F;NoPadding&quot;), &#x2F;&#x2F; not tested yet</span><br><span class="line">ARIA_256_GCM(16, 16, 8, 16, &quot;ARIA&#x2F;GCM&#x2F;NoPadding&quot;), &#x2F;&#x2F; not tested yet</span><br><span class="line">GOST_28147_CNT(32, 8, 0, 8, &quot;GOST28147&#x2F;ECB&#x2F;NoPadding&quot;),</span><br><span class="line">FORTEZZA_CBC(0, 0, 0, 0),&#x2F;&#x2F; TODO</span><br><span class="line">SMS4_GCM(0, 0, 0, 0);   &#x2F;&#x2F;æ·»åŠ GmSSLæ”¯æŒçš„å¯¹ç§°å¯†ç ç®—æ³•</span><br></pre></td></tr></table></figure>

<h4 id="CipherSuite-class"><a href="#CipherSuite-class" class="headerlink" title="CipherSuite.class"></a>CipherSuite.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum:</span><br><span class="line">&#x2F;&#x2F; GmSSL CipherSuites  æ·»åŠ GMçš„8ä¸ªå¯†ç ç»„ä»¶</span><br><span class="line">ECDHE_SM4_SM3(0xE011),</span><br><span class="line">ECC_SM4_SM3(0xE013),</span><br><span class="line">IBSDH_SM4_SM3(0xE015),</span><br><span class="line">IBC_SM4_SM3(0xE017),</span><br><span class="line">RSA_SM4_SM3(0xE019),</span><br><span class="line">RSA_SM4_SHA1(0xE01a),</span><br><span class="line">ECDHE_SM2_WITH_SMS4_SM3(0xE102),</span><br><span class="line">ECDHE_SM2_WITH_SMS4_GCM_SM3(0xE107);</span><br></pre></td></tr></table></figure>

<h4 id="CipherType-class"><a href="#CipherType-class" class="headerlink" title="CipherType.class"></a>CipherType.class</h4><p>å¯†ç ç±»å‹ï¼šæµå¯†ç ï¼Œåˆ†ç»„å¯†ç ï¼ŒAEADå¯†ç ï¼ˆå¯†ç ç»„ä»¶æœ‰GCMæ¨¡å¼çš„éƒ½æ˜¯AEADå¯†ç ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: STREAM, BLOCK, AEAD</span><br></pre></td></tr></table></figure>

<h4 id="ClientAuthenticationType-class"><a href="#ClientAuthenticationType-class" class="headerlink" title="ClientAuthenticationType.class"></a>ClientAuthenticationType.class</h4><p>å®¢æˆ·ç«¯èº«ä»½éªŒè¯ç±»å‹ï¼Œå‚è€ƒ<a href="https://tools.ietf.org/html/rfc5077#section-4">RFC-4077ç¬¬4èŠ‚</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: </span><br><span class="line">ANONYMOUS((byte) 0x00),  &#x2F;&#x2F;åŒ¿å</span><br><span class="line">CERTIFICATE_BASED((byte) 0x01),  &#x2F;&#x2F;åŸºäºè¯ä¹¦</span><br><span class="line">PSK((byte) 0x02);  &#x2F;&#x2F;PSK</span><br></pre></td></tr></table></figure>

<h4 id="ClientCertificateType-class"><a href="#ClientCertificateType-class" class="headerlink" title="ClientCertificateType.class"></a>ClientCertificateType.class</h4><p>å®¢æˆ·ç«¯è¯ä¹¦ç±»å‹ï¼Œå‚è€ƒ<a href="http://tools.ietf.org/html/rfc5246#section-7.4.4">RFC-5246ç¬¬7.4.4èŠ‚</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum:</span><br><span class="line">RSA_SIGN((byte) 1),</span><br><span class="line">DSS_SIGN((byte) 2),</span><br><span class="line">RSA_FIXED_DH((byte) 3),</span><br><span class="line">DSS_FIXED_DH((byte) 4),</span><br><span class="line">RSA_EPHEMERAL_DH_RESERVED((byte) 5),</span><br><span class="line">DSS_EPHEMERAL_DH_RESERVED((byte) 6),</span><br><span class="line">FORTEZZA_DMS_RESERVED((byte) 20),</span><br><span class="line">GOSTR34101994((byte) 21),</span><br><span class="line">GOSTR34102001((byte) 22),</span><br><span class="line">ECDSA_SIGN((byte) 64), &#x2F;&#x2F; TODO Implement these</span><br><span class="line">RSA_FIXED_ECDH((byte) 65),</span><br><span class="line">ECDSA_FIXED_ECDH((byte) 66),</span><br><span class="line">GOST_SIGN256((byte) 66),</span><br><span class="line">GOST_SIGN512((byte) 67),</span><br><span class="line">GOSTR34102012_256((byte) 238),</span><br><span class="line">GOSTR34102012_512((byte) 239);</span><br></pre></td></tr></table></figure>

<h4 id="CompressionMethod-class"><a href="#CompressionMethod-class" class="headerlink" title="CompressionMethod.class"></a>CompressionMethod.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enumï¼šNULL((byte) 0x00), DEFLATE((byte) 0x01), LZS((byte) 0x40);</span><br></pre></td></tr></table></figure>

<h4 id="DigestAlgorithm-class"><a href="#DigestAlgorithm-class" class="headerlink" title="DigestAlgorithm.class"></a>DigestAlgorithm.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum: </span><br><span class="line">SSL_DIGEST(&quot;&quot;),</span><br><span class="line">LEGACY(&quot;&quot;),</span><br><span class="line">SHA256(&quot;SHA-256&quot;),</span><br><span class="line">SHA384(&quot;SHA-384&quot;),</span><br><span class="line">GOSTR3411(&quot;GOST3411&quot;),</span><br><span class="line">GOSTR34112012_256(&quot;GOST3411-2012-256&quot;);</span><br></pre></td></tr></table></figure>

<h4 id="ECPointFormat-class"><a href="#ECPointFormat-class" class="headerlink" title="ECPointFormat.class"></a>ECPointFormat.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum:</span><br><span class="line">UNCOMPRESSED((byte) 0),</span><br><span class="line">ANSIX962_COMPRESSED_PRIME((byte) 1),</span><br><span class="line">ANSIX962_COMPRESSED_CHAR2((byte) 2);</span><br></pre></td></tr></table></figure>

<h4 id="EllipticCurveType-class"><a href="#EllipticCurveType-class" class="headerlink" title="EllipticCurveType.class"></a>EllipticCurveType.class</h4><p>æ¤­åœ†æ›²çº¿ç±»å‹åœ¨æ–‡æ¡£<a href="https://tools.ietf.org/html/rfc4492#section-5.4">RFC-4492ç¬¬5.4èŠ‚</a>ä¸­å®šä¹‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enumï¼š</span><br><span class="line">EXPLICIT_PRIME((byte) 1),</span><br><span class="line">EXPLICIT_CHAR2((byte) 2),</span><br><span class="line">NAMED_CURVE((byte) 3);</span><br></pre></td></tr></table></figure>

<h4 id="EsniDnsKeyRecordVersion-class"><a href="#EsniDnsKeyRecordVersion-class" class="headerlink" title="EsniDnsKeyRecordVersion.class"></a>EsniDnsKeyRecordVersion.class</h4><p>ESNI DNSå¯†é’¥è®°å½•ç‰ˆæœ¬</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enumï¼š</span><br><span class="line">NULL(null),</span><br><span class="line">VERSION_FF01(new byte[] &#123; (byte) 0xff, (byte) 0x01 &#125;),</span><br><span class="line">VERSION_FF02(new byte[] &#123; (byte) 0xff, (byte) 0x02 &#125;),</span><br><span class="line">VERSION_FF03(new byte[] &#123; (byte) 0xff, (byte) 0x03 &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="EsniVersion-class"><a href="#EsniVersion-class" class="headerlink" title="EsniVersion.class"></a>EsniVersion.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enumï¼š</span><br><span class="line">DRAFT_0(EsniDnsKeyRecordVersion.NULL),</span><br><span class="line">DRAFT_1(EsniDnsKeyRecordVersion.VERSION_FF01),</span><br><span class="line">DRAFT_2(EsniDnsKeyRecordVersion.VERSION_FF01),</span><br><span class="line">DRAFT_3(EsniDnsKeyRecordVersion.VERSION_FF02),</span><br><span class="line">DRAFT_4(EsniDnsKeyRecordVersion.VERSION_FF03),</span><br><span class="line">DRAFT_5(EsniDnsKeyRecordVersion.VERSION_FF03);</span><br></pre></td></tr></table></figure>

<h4 id="ExtensionByteLength-class"><a href="#ExtensionByteLength-class" class="headerlink" title="ExtensionByteLength.class"></a>ExtensionByteLength.class</h4><p>å®šä¹‰äº†å„ç§æ‹“å±•å­—èŠ‚éƒ¨åˆ†çš„å­—èŠ‚é•¿åº¦ï¼ˆå…¨å±€å¸¸é‡ï¼‰</p>
<h4 id="ExtensionType-class"><a href="#ExtensionType-class" class="headerlink" title="ExtensionType.class"></a>ExtensionType.class</h4><p>å®šä¹‰äº†å„ç§æ‹“å±•çš„ç±»å‹</p>
<h4 id="FiniteFieldGroups-class"><a href="#FiniteFieldGroups-class" class="headerlink" title="FiniteFieldGroups.class"></a>FiniteFieldGroups.class</h4><p>æœ‰é™åŸŸç¾¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enumï¼š</span><br><span class="line">FFDHE2048(new byte[] &#123; 01, 00 &#125;),</span><br><span class="line">FFDHE3072(new byte[] &#123; 01, 01 &#125;),</span><br><span class="line">FFDHE4096(new byte[] &#123; 01, 02 &#125;),</span><br><span class="line">FFDHE6144(new byte[] &#123; 01, 03 &#125;),</span><br><span class="line">FFDHE8192(new byte[] &#123; 01, 04 &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="GOSTCurve-class"><a href="#GOSTCurve-class" class="headerlink" title="GOSTCurve.class"></a>GOSTCurve.class</h4><h4 id="HandshakeMessageType-class"><a href="#HandshakeMessageType-class" class="headerlink" title="HandshakeMessageType.class"></a>HandshakeMessageType.class</h4><p>TLSåè®®æ¡æ‰‹åè®®çš„æ¶ˆæ¯ç±»å‹ï¼Œå…±22ç§</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enumï¼š</span><br><span class="line">UNKNOWN((byte) 255),</span><br><span class="line">HELLO_REQUEST((byte) 0),</span><br><span class="line">CLIENT_HELLO((byte) 1),</span><br><span class="line">SSL2_CLIENT_HELLO((byte) 1),</span><br><span class="line">SERVER_HELLO((byte) 2),</span><br><span class="line">SSL2_CLIENT_MASTER_KEY((byte) 2),</span><br><span class="line">HELLO_VERIFY_REQUEST((byte) 3),</span><br><span class="line">NEW_SESSION_TICKET((byte) 4),</span><br><span class="line">SSL2_SERVER_HELLO((byte) 4),</span><br><span class="line">END_OF_EARLY_DATA((byte) 5),</span><br><span class="line">SSL2_SERVER_VERIFY((byte) 5),</span><br><span class="line">HELLO_RETRY_REQUEST((byte) 6),</span><br><span class="line">ENCRYPTED_EXTENSIONS((byte) 8),</span><br><span class="line">CERTIFICATE((byte) 11),</span><br><span class="line">SERVER_KEY_EXCHANGE((byte) 12),</span><br><span class="line">CERTIFICATE_REQUEST((byte) 13),</span><br><span class="line">SERVER_HELLO_DONE((byte) 14),</span><br><span class="line">CERTIFICATE_VERIFY((byte) 15),</span><br><span class="line">CLIENT_KEY_EXCHANGE((byte) 16),</span><br><span class="line">FINISHED((byte) 20),</span><br><span class="line">CERTIFICATE_STATUS((byte) 22),</span><br><span class="line">SUPPLEMENTAL_DATA((byte) 23);</span><br></pre></td></tr></table></figure>

<h4 id="HandshakeByteLength-class"><a href="#HandshakeByteLength-class" class="headerlink" title="HandshakeByteLength.class"></a>HandshakeByteLength.class</h4><h4 id="HashAlgorithm-class"><a href="#HashAlgorithm-class" class="headerlink" title="HashAlgorithm.class"></a>HashAlgorithm.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum:</span><br><span class="line">NONE(&quot;&quot;),</span><br><span class="line">MD5(&quot;MD5&quot;),</span><br><span class="line">SHA1(&quot;SHA-1&quot;),</span><br><span class="line">SHA224(&quot;SHA-224&quot;),</span><br><span class="line">SHA256(&quot;SHA-256&quot;),</span><br><span class="line">SHA384(&quot;SHA-384&quot;),</span><br><span class="line">SHA512(&quot;SHA-512&quot;),</span><br><span class="line">GOSTR3411(&quot;GOST3411&quot;),</span><br><span class="line">GOSTR34112012_256(&quot;GOST3411-2012-256&quot;),</span><br><span class="line">GOSTR34112012_512(&quot;GOST3411-2012-512&quot;);</span><br></pre></td></tr></table></figure>

<h4 id="HeartbeatMessageType-class"><a href="#HeartbeatMessageType-class" class="headerlink" title="HeartbeatMessageType.class"></a>HeartbeatMessageType.class</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum:</span><br><span class="line">HEARTBEAT_REQUEST((byte) 1),</span><br><span class="line">HEARTBEAT_RESPONSE((byte) 2);</span><br></pre></td></tr></table></figure>

<h4 id="HeartbeatByteLength-class"><a href="#HeartbeatByteLength-class" class="headerlink" title="HeartbeatByteLength.class"></a>HeartbeatByteLength.class</h4>]]></content>
      <tags>
        <tag>github project</tag>
      </tags>
  </entry>
  <entry>
    <title>Paper Reading: Scalable Scanning and Automatic Classification of TLS Padding Oracle Vulnerabilities</title>
    <url>/2021/04/24/Paper-Reading-Scalable-Scanning-and-Automatic-Classification-of-TLS-Padding-Oracle-Vulnerabilities/</url>
    <content><![CDATA[<h1 id="ã€ŒTLS-Padding-Oracleæ¼æ´çš„å¯æ‹“å±•æ‰«æå’Œè‡ªåŠ¨åˆ†ç±»ã€"><a href="#ã€ŒTLS-Padding-Oracleæ¼æ´çš„å¯æ‹“å±•æ‰«æå’Œè‡ªåŠ¨åˆ†ç±»ã€" class="headerlink" title="ã€ŒTLS Padding Oracleæ¼æ´çš„å¯æ‹“å±•æ‰«æå’Œè‡ªåŠ¨åˆ†ç±»ã€"></a>ã€ŒTLS Padding Oracleæ¼æ´çš„å¯æ‹“å±•æ‰«æå’Œè‡ªåŠ¨åˆ†ç±»ã€</h1><p>è¯¥è®ºæ–‡å‘è¡¨åœ¨ç¬¬28æ¬¡USSä¼šè®®ä¸Šï¼Œ<a href="https://www.youtube.com/results?search_query=Scalable+Scanning+and+Automatic+Classification+of+TLS+Padding+Oracle+Vulnerabilities">USSä¼šè®®æ¼”è®²è§†é¢‘</a>ï¼Œ<a href="https://www.youtube.com/results?search_query=Scalable+Scanning+and+Automatic+Classification+of+TLS+Padding+Oracle+Vulnerabilities">å›½é™…å¯†ç ç ”ç©¶åä¼šæ¼”è®²è§†é¢‘</a></p>
<p>è®ºæ–‡é¡¹ç›®ä¹Ÿå·²åœ¨Githubä¸Šå¼€æºï¼š<a href="https://github.com/tls-attacker/TLS-Padding-Oracles">TLS Padding Oracles</a></p>
<p>ç›¸å…³ï¼š<a href="https://pentesterlab.com/exercises/padding_oracle/course">PentesterLab: Padding Oracleæ”»å‡»å®æˆ˜</a></p>
<ul>
<li><strong>æ–‡ç« ç»“æ„è¯·çœ‹å³è¾¹çš„ç›®å½•</strong>ğŸ‘‰</li>
</ul>
<h1 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h1><p>TLSåè®®åœ¨ç°ä»£Internetä¸Šæä¾›åŠ å¯†ã€æ•°æ®å®Œæ•´æ€§å’Œèº«ä»½éªŒè¯ã€‚å°½ç®¡è¯¥åè®®å¾ˆé‡è¦ï¼Œä½†ç›®å‰éƒ¨ç½²çš„TLSç‰ˆæœ¬ä½¿ç”¨çš„æ˜¯è¿‡æ—¶çš„åŠ å¯†ç®—æ³•ï¼Œè¿™äº›ç®—æ³•å·²è¢«å„ç§æ”»å‡»æ”»ç ´ã€‚æ­¤ç±»æ”»å‡»çš„ä¸€ä¸ªçªå‡ºç±»åˆ«æ˜¯CBC Padding Oracleï¼ˆCBCå¡«å……é¢„ç¤ºï¼‰æ”»å‡»ã€‚è¿™äº›æ”»å‡»ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡è§‚å¯Ÿå–å†³äºCBCå¡«å……æœ‰æ•ˆæ€§çš„ä¸åŒæœåŠ¡å™¨è¡Œä¸ºæ¥è§£å¯†TLSé€šä¿¡æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬é¦–æ¬¡å¯¹ç°ä»£äº’è”ç½‘ä¸ŠTLSå®ç°ä¸­çš„CBC Padding Oracleè¿›è¡Œäº†å¤§è§„æ¨¡æ‰«æã€‚æˆ‘ä»¬çš„æ‰«ææ˜¾ç¤ºAlexaæ’åå‰ç™¾ä¸‡çš„ç½‘ç«™ä¸­æœ‰1.83%çš„ç½‘ç«™å­˜åœ¨æ¼æ´ï¼Œä¸”æ£€æµ‹åˆ°è¿‘100ä¸ªä¸åŒçš„æ¼æ´ã€‚æˆ‘ä»¬çš„æ‰«æä»ªèƒ½è§‚å¯Ÿåˆ°æœåŠ¡å™¨è¡Œä¸ºçš„ç»†å¾®å·®åˆ«ï¼Œä¾‹å¦‚ä½¿ç”¨ä¸åŒçš„TLS Alertæˆ–ä½¿ç”¨ä¸åŒçš„TCP Headeræ ‡å¿—è¿›è¡Œå“åº”ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§æ–°çš„æ‰«ææ–¹æ³•ï¼ŒåŒ…æ‹¬ä¸‰ä¸ªæ­¥éª¤ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€å¤§ç»„æ¢æ¢é’ˆï¼Œä»¥ç›¸å½“é«˜çš„æ‰«ææˆæœ¬æ¥æ£€æµ‹æ¼æ´ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨åˆæ­¥æ‰«æå‡å°‘äº†æ¢é’ˆçš„æ•°é‡ï¼Œä½¿å¾—è¿™æ ·ä¸€ç»„è¾ƒå°çš„æ¢é’ˆå…·æœ‰ç›¸åŒçš„æ£€æµ‹ç‡ï¼Œä½†è¶³å¤Ÿå°ï¼Œå¯ä»¥ç”¨äºå¤§è§„æ¨¡æ‰«æã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨å‡å°‘çš„æ¢é’ˆé›†åˆè¿›è¡Œå¤§è§„æ¨¡æ‰«æï¼Œå¹¶ç”¨ä¸€ç§æ–°çš„æ–¹æ³•ä½¿ç”¨å›¾å½¢ç»˜åˆ¶ç®—æ³•å¯¹æˆ‘ä»¬çš„å‘ç°è¿›è¡Œäº†èšç±»ã€‚</p>
<p>ä¸æ™®éçš„çœ‹æ³•ç›¸åï¼Œåˆ©ç”¨CBC Padding Oracleå¹¶ä¸ä¸€å®šéœ€è¦æ‰§è¡Œç²¾ç¡®çš„è®¡æ—¶æµ‹é‡ã€‚æˆ‘ä»¬æ£€æµ‹åˆ°åªéœ€è§‚å¯Ÿä¸åŒæœåŠ¡å™¨å“åº”çš„å†…å®¹å³å¯åˆ©ç”¨è¯¥æ¼æ´ã€‚è¿™äº›æ¼æ´åœ¨å®è·µä¸­æ„æˆçš„å¨èƒæ¯”ä¹‹å‰è®¾æƒ³çš„è¦å¤§å¾—å¤šã€‚</p>
<h1 id="ä¸€ã€ä»‹ç»"><a href="#ä¸€ã€ä»‹ç»" class="headerlink" title="ä¸€ã€ä»‹ç»"></a>ä¸€ã€ä»‹ç»</h1><p>åœ¨2002å¹´ï¼ŒVaudenayæå‡ºäº†ä¸€ç§æ”»å‡»ï¼Œè¯¥æ”»å‡»çš„ç›®æ ‡æ˜¯é€šè¿‡å¯†ç å—é“¾æ¥ï¼ˆCBCï¼‰æ“ä½œæ¨¡å¼åŠ å¯†çš„æ¶ˆæ¯[39]ã€‚è¯¥æ”»å‡»åˆ©ç”¨äº†CBCæ¨¡å¼çš„å¯å»¶å±•æ€§ï¼Œè¯¥æ¨¡å¼å…è®¸æ›´æ”¹å¯†æ–‡ï¼Œä»¥ä¾¿åœ¨ä¸äº†è§£åŠ å¯†å¯†é’¥çš„æƒ…å†µä¸‹ç¿»è½¬ç‰¹å®šçš„æ˜æ–‡ä½ã€‚æ”»å‡»éœ€è¦æœåŠ¡å™¨è§£å¯†æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®æ¶ˆæ¯çš„æœ‰æ•ˆæ€§ä»¥1æˆ–0å“åº”ã€‚è¿™ç§è¡Œä¸ºä»æœ¬è´¨ä¸Šä¸ºæ”»å‡»è€…æä¾›äº†ä¸€ä¸ªåŠ å¯†é¢„è¨€ï¼Œè¯¥é¢„è¨€å¯ç”¨äºå‘èµ·è‡ªé€‚åº”é€‰æ‹©å¯†æ–‡æ”»å‡»ã€‚æ”»å‡»è€…åˆ©ç”¨è¿™ç§è¡Œä¸ºé€šè¿‡æ‰§è¡Œè‡ªé€‚åº”æŸ¥è¯¢æ¥è§£å¯†æ¶ˆæ¯ã€‚Vaudenayå¼€å‘å‡ºäº†ä¸€ç§ç‰¹æ®Šå½¢å¼çš„æ˜“å—æ”»å‡»çš„è¡Œä¸ºï¼Œå…¶ä¸­çš„æ‰§è¡Œä¼šéªŒè¯CBCå¡«å……ç»“æ„å¹¶ç›¸åº”åœ°å“åº”1æˆ–0ã€‚</p>
<p>æ­¤ç±»æ”»å‡»è¢«ç§°ä¸ºpadding oracleæ”»å‡»ã€‚æ¼”ç¤ºäº†ä¸åŒå½¢å¼çš„padding oracleæ”»å‡»å¯ä»¥ç ´ååŠ å¯†ç¡¬ä»¶[6]ã€XMLåŠ å¯†[23]æˆ–è¯¸å¦‚Java Server Faces [33]å’ŒASP.NET Webåº”ç”¨ç¨‹åº[15]ä¹‹ç±»çš„WebæŠ€æœ¯ã€‚ Rizzoå’ŒDuongä½¿ç”¨padding oracleæ”»å‡»æ¥çªƒå–ç§˜å¯†å¹¶ä¼ªé€ èº«ä»½éªŒè¯ä»¤ç‰Œï¼Œä»è€Œè·å¾—å¯¹æ•æ„Ÿæ•°æ®çš„è®¿é—®æƒ[15]ã€‚åœ¨æ‰€æœ‰è¿™äº›å·¥ä½œä¸­ï¼Œæ”»å‡»è€…èƒ½å¤Ÿä½¿ç”¨ä¸€ä¸ªç›´æ¥çš„ä¾§ä¿¡é“ï¼ˆä¸åŒçš„é”™è¯¯æ¶ˆæ¯ï¼‰æ¥å®ä¾‹åŒ–padding oracleå¹¶è§£å¯†æœºå¯†æ•°æ®ã€‚</p>
<p>ä¼ è¾“å±‚å®‰å…¨ï¼ˆTLSï¼‰åœ¨MAC-then-Pad-then-Encryptæ–¹æ¡ˆä¸­é‡‡ç”¨äº†CBCæ¨¡å¼ï¼Œè¿™ä½¿å…¶å¾ˆå¯èƒ½å—åˆ°è¿™äº›æ”»å‡»ã€‚å®é™…ä¸Šï¼Œå·²ç»æœ‰äººä½¿ç”¨äº†ä¸åŒç±»å‹çš„CBC Padding Oracleæ¥ç ´åTLSçš„ä¿å¯†è¿æ¥[39ï¼Œ4ï¼Œ3ï¼Œ20]ã€‚æ‰€æœ‰è¿™äº›æ”»å‡»éƒ½è¦æ±‚æ”»å‡»è€…æ‰§è¡Œç²¾ç¡®çš„è®¡æ—¶æµ‹é‡ã€‚è¯¥è¦æ±‚æºäºTLSåè®®çš„å±æ€§ã€‚å»ºç«‹TLSè¿æ¥åï¼Œæ‰€æœ‰TLSé”™è¯¯æ¶ˆæ¯å‡ä»¥åŠ å¯†æ–¹å¼å‘é€ï¼Œå¹¶ä¸”é•¿åº¦ç›¸åŒã€‚å› æ­¤ï¼Œå³ä½¿æ”»å‡»è€…èƒ½å¤Ÿä½¿æœåŠ¡å™¨å‘é€ä¸åŒçš„é”™è¯¯æ¶ˆæ¯ï¼Œæ”»å‡»è€…é€šå¸¸ä¹Ÿæ— æ³•åœ¨ä¸åŒçš„åŠ å¯†å“åº”ä¹‹é—´è¿›è¡ŒåŒºåˆ†ã€‚</p>
<p>ç”±äºå¤§å¤šæ•°å…ˆå‰çš„åˆ†æä»…åŸºäºè®¡æ—¶ä¾§ä¿¡é“æ¥åˆ†æpadding oracleæ”»å‡»ï¼Œå› æ­¤ä»–ä»¬éœ€è¦åœ¨æœ¬åœ°ç¯å¢ƒä¸­æµ‹è¯•å®ç°ã€‚è¿™äº›è¯„ä¼°å‘ç°äº†è®¸å¤šæ–°æ¼æ´[4ã€3ã€20]ã€‚ä½†æ˜¯ï¼Œé’ˆå¯¹è¿™äº›æ¼æ´å®æ–½é€‚å½“çš„å¯¹ç­–éå¸¸å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå¹¶ä¸”éœ€è¦å¤æ‚çš„æ’å®šæ—¶é—´æ¥å®ç°ã€‚å®æ–½æ­¤ç±»å¯¹ç­–å¯èƒ½ä¼šå¼•å…¥æ–°çš„æ”»å‡»ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†ä¿®å¤Lucky 13 Padding Oracleï¼ŒOpenSSLå¯†ç åº“å¼•å…¥äº†ä¸€ä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­OpenSSLä»¥ä¸åŒçš„TLSè­¦æŠ¥æ¶ˆæ¯è¿›è¡Œå“åº”[37]ã€‚å› æ­¤ï¼Œåˆ†æå®éªŒå®¤ç¯å¢ƒä¸­çš„å®ç°éœ€è¦å¯¹ä¸åŒå®ç°çš„æ¯ä¸ªæ–°ç‰ˆæœ¬è¿›è¡Œè´¹åŠ›çš„æµ‹è¯•ã€‚è¿™æ˜¾ç„¶æ˜¯ä¸ç°å®çš„ï¼Œå› æ­¤è¿™ç§åˆ†ææ˜¯å¶å°”æ‰§è¡Œçš„ã€‚</p>
<p>è€ƒè™‘åˆ°æ’å®šæ—¶é—´TLSå¡«å……éªŒè¯çš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å…¶ä»–å®ç°ä¸­ä¹Ÿå¯èƒ½å¼•å…¥ç±»ä¼¼äºOpenSSL [37]å¼•å…¥çš„æ¼æ´ã€‚å› æ­¤ï¼Œè¿™é¡¹å·¥ä½œè„±ç¦»äº†ä¸Šé¢çš„å®éªŒå®¤åˆ†ææ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨å¤§è§„æ¨¡Internetæ‰«ææ¥è¯„ä¼°CBC Padding Oracleã€‚æˆ‘ä»¬å°è¯•å›ç­”ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼špadding oracleæ¼æ´çš„æ™®éç¨‹åº¦å¦‚ä½•ï¼Ÿè¿™äº›æ”»å‡»æ˜¯å¦åªèƒ½é€šè¿‡ä½¿ç”¨å®šæ—¶è¾…åŠ©ä¿¡é“æ¥åˆ©ç”¨ï¼Ÿ</p>
<ul>
<li><p><strong>è´¡çŒ®ï¼š</strong>åœ¨æˆ‘ä»¬çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§æ–°é¢–çš„æ‰«ææ–¹æ³•ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿå¤§è§„æ¨¡æ‰«æTLS CBC Padding Oracleã€‚ æˆ‘ä»¬ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥å‘ç°æ–°çš„Padding Oracleæ¼æ´å¹¶æ‰§è¡Œè´Ÿè´£ä»»çš„æŠ«éœ²ã€‚ æˆ‘ä»¬ç¡®å®šäº†è¿‘100ç§ä¸åŒçš„Padding Oracleã€‚ æˆ‘ä»¬è¡¨æ˜ï¼Œå…¶ä¸­çš„æŸäº›åŠŸèƒ½å¯ä»¥åœ¨æ²¡æœ‰ç»†å¾®æ—¶åºä¾§ä¿¡é“çš„æƒ…å†µä¸‹è¢«åˆ©ç”¨ï¼Œå› æ­¤ä¸æœ€è¿‘å‘ç°çš„Padding Oracleç›¸æ¯”ï¼Œåœ¨å®è·µä¸­æ„æˆäº†æ˜¾ç€æ›´å¤§çš„å¨èƒã€‚</p>
</li>
<li><p><strong>æ–°çš„å¤§è§„æ¨¡æ‰«ææ–¹æ³•ï¼š</strong>å¤§è§„æ¨¡æ‰«æpadding oracleæ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚è¿™ç§æ‰«æé€šè¿‡å‘é€ä¸åŒæ ¼å¼é”™è¯¯çš„è¾“å…¥å¹¶è§‚å¯ŸæœåŠ¡å™¨è¡Œä¸ºæ¥æ£€æµ‹æ¼æ´ã€‚å¦‚BÃ¶ckç­‰äººæ‰€ç¤º [9]ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™äº›è¾“å…¥ä»…åœ¨ä½¿ç”¨ç‰¹å®šçš„TLSç‰ˆæœ¬æˆ–å¯†ç å¥—ä»¶æ—¶è§¦å‘æ¼æ´ã€‚ä½¿ç”¨åè®®ç‰ˆæœ¬ã€å¯†ç å¥—ä»¶å’Œæ ¼å¼é”™è¯¯çš„è¾“å…¥çš„æ‰€æœ‰å¯èƒ½ç»„åˆè¿›è¡Œæ‰«ææ˜¯ä¸å¯è¡Œçš„ï¼Œå› ä¸ºè¿™å°†éœ€è¦ä¸æ¯ä¸ªæ‰«æä¸»æœºå»ºç«‹å¤§é‡è¿æ¥ã€‚æˆ‘ä»¬é€šè¿‡ä»”ç»†é€‰æ‹©ä¸€ç»„æ¢é’ˆå…‹æœäº†è¿™ä¸€é™åˆ¶ï¼Œä»è€Œå¯ä»¥è¿›è¡Œæœ‰æ•ˆçš„å¤§è§„æ¨¡æ‰«æã€‚æˆ‘ä»¬ç³»ç»Ÿåœ°åˆ†æäº†å…ˆå‰åœ¨æ–‡çŒ®[39ã€4ã€3ã€20ã€37ã€27ã€25ã€10ã€29ã€28]ä¸­æè¿°çš„padding oracleã€‚ç„¶åï¼Œæˆ‘ä»¬ä»”ç»†é€‰æ‹©äº†25ä¸ªè¡¨ç°å‡ºpadding oracleæ ¼å¼é”™è¯¯çš„è¾“å…¥ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºæ ¼å¼é”™è¯¯çš„è®°å½•ã€‚è¿™äº›TLSè®°å½•å±•ç¤ºäº†æœ‰æ•ˆå¡«å……å’Œæ— æ•ˆå¡«å……ä»¥åŠMACçš„ä¸åŒç»„åˆï¼Œå¹¶ä¸”æ˜¯ä½¿ç”¨TLS-Attackeræ¡†æ¶ç”Ÿæˆçš„[37]ã€‚å³ä½¿åªæœ‰25ä¸ªæ ¼å¼é”™è¯¯çš„è®°å½•ï¼Œä½¿ç”¨æ ¼å¼é”™è¯¯çš„è®°å½•ã€TLSç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶çš„å„ç§ç»„åˆè¿›è¡Œæ‰«æä¹Ÿæ˜¯ä¸åˆ‡å®é™…çš„ã€‚æˆ‘ä»¬å°†è¿™äº›ç»„åˆç§°ä¸ºæµ‹è¯•å‘é‡ã€‚æˆ‘ä»¬å¯¹å…·æœ‰æ‰€æœ‰æµ‹è¯•å‘é‡çš„50,000ä¸ªéšæœºTLSä¸»æœºè¿›è¡Œäº†åˆæ­¥æ‰«æã€‚ç„¶åï¼Œæˆ‘ä»¬å‡å°‘äº†æµ‹è¯•å‘é‡é›†ï¼Œä»¥ä½¿åœ¨åˆæ­¥æ‰«æä¸­å‘ç°çš„æ‰€æœ‰æ¼æ´ä»ç„¶ç”±å‡å°‘çš„å‘é‡é›†è§¦å‘ã€‚æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸‰å¤©å†…ä½¿ç”¨å‡å°‘çš„æµ‹è¯•å‘é‡é›†æ‰«æAlexaå‰100ä¸‡ä¸ªç½‘ç«™ã€‚ä¸[9]ç›¸ä¼¼ï¼Œæˆ‘ä»¬çš„æ‰«æå™¨ä¸ä»…åœ¨TLSå±‚è€Œä¸”åœ¨TCPå±‚è§‚å¯Ÿåˆ°ä¸åŒçš„æœåŠ¡å™¨å“åº”ã€‚æˆ‘ä»¬çš„ç»“æœè¡¨æ˜ï¼Œå¤§çº¦1.83ï¼…çš„TLSæœåŠ¡å™¨æ˜“å—CBC Padding Oracleæ”»å‡»ã€‚</p>
</li>
<li><p><strong>å°½å¯èƒ½å‡å°‘è¯¯æŠ¥ï¼š</strong>å½“ä¸»æœºé¦–æ¬¡æ˜¾ç¤ºæ˜“å—æ”»å‡»çš„è¡Œä¸ºæ—¶ï¼Œæˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œé‡æ–°æ‰«æä»¥ç¡®ä¿è¯¥è¡Œä¸ºä¸æ˜¯æ‰«æä¼ªåƒã€‚ å¦‚æœä¸»æœºåœ¨å¯¹æˆ‘ä»¬çš„æ¯ä¸ªæµ‹è¯•å‘é‡çš„ä¸‰ä¸ªç‹¬ç«‹æ‰«æä¸­å…·æœ‰ç›¸åŒçš„å“åº”ï¼Œåˆ™æˆ‘ä»¬ä»…è®¤ä¸ºå®ƒæ˜¯æ˜“å—æ”»å‡»çš„ã€‚ æ ¹æ®æ­¤æ ‡å‡†ï¼Œä¸å¤ªå¯èƒ½å°†ä¸»æœºé”™è¯¯åœ°æ ‡è®°ä¸ºæ˜“å—æ”»å‡»çš„ä¸»æœºã€‚ å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºæˆ‘ä»¬çš„è„†å¼±æ€§ç»Ÿè®¡æ•°æ®æ˜¯ä¿å®ˆçš„è¾ƒä½ä¼°è®¡å€¼ã€‚</p>
</li>
<li><p><strong>è¿‘100ä¸ªä¸åŒçš„padding oracleæ¼æ´ï¼š</strong>å¿…é¡»å°†æ£€æµ‹åˆ°çš„æ¼æ´è¿›è¡Œèšç±»ä»¥é€šçŸ¥ä¸åŒçš„ä¾›åº”å•†ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™æ˜¯æ‰‹åŠ¨å®Œæˆçš„[9]ã€‚ä¸ºäº†è‡ªåŠ¨å®ç°æ­¤ç›®çš„ï¼Œæˆ‘ä»¬é’ˆå¯¹è¾ƒå¤§çš„æµ‹è¯•å‘é‡é›†é‡æ–°æ‰«æäº†æ˜“å—æ”»å‡»çš„ä¸»æœºã€‚æˆ‘ä»¬å°†å®¿ä¸»å¯¹æ‰€æœ‰æµ‹è¯•å‘é‡çš„å“åº”é›†ç§°ä¸ºå®¿ä¸»çš„å“åº”å›¾ã€‚æ­¤å“åº”å›¾å®è´¨ä¸Šæ˜¯ä¸»æœºæ¼æ´çš„æŒ‡çº¹ã€‚ç„¶åï¼Œæˆ‘ä»¬æ ¹æ®æ‰«æçš„ä¸»æœºçš„å“åº”å›¾å¯¹å…¶è¿›è¡Œèšç±»ã€‚è¯¥è¿‡ç¨‹ç¡®å®šäº†93ä¸ªä¸åŒçš„å“åº”å›¾ï¼Œå³93ä¸ªä¸åŒçš„æ¼æ´ã€‚è¿™äº›æ¼æ´åŒ…æ‹¬ä¸åŒçš„è¡Œä¸ºï¼ŒèŒƒå›´ä»å…·æœ‰ä¸åŒTLSè­¦æŠ¥æ¶ˆæ¯çš„å…¸å‹padding oracle[39]åˆ°ç‰¹å®šæ— æ•ˆMACå­—èŠ‚è§¦å‘çš„TCPè¿æ¥è¶…æ—¶ï¼Œæˆ–åœ¨ä½¿ç”¨æ— æ•ˆå¡«å……å€¼æ—¶è§‚å¯Ÿåˆ°çš„å…³é—­è¿æ¥ã€‚æˆ‘ä»¬å°†ä¸åŒçš„å“åº”å›¾è§†ä¸ºä¸åŒçš„æ¼æ´ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯è®¡ç®—æ¼æ´çš„è‡ªç„¶æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ•è·äº†åœ¨ç›¸ä¼¼ä½†ä¸åŒçš„å®ç°ä¸­å‘ç”Ÿçš„ç›¸åŒæ¼æ´çš„æƒ…å†µã€‚è€ƒè™‘ä¸¤ä¸ªä¸»æœºå¯¹æ‰€æœ‰æµ‹è¯•å‘é‡çš„å“åº”ç›¸åŒã€‚è¿™äº›ä¸»æœºå¯èƒ½å…±äº«å®ç°çš„ç›¸åŒæˆ–éå¸¸ç›¸ä¼¼çš„éƒ¨åˆ†ï¼Œä»è€Œå¯¼è‡´æ¼æ´æ˜¾ç¤ºå…·æœ‰ç›¸åŒçš„å“åº”å›¾ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¸ä¸€å®šå…±äº«ç›¸åŒçš„ä»£ç ã€‚ä»–ä»¬å¯èƒ½ä½¿ç”¨åŒä¸€TLSåº“çš„ä¸åŒç‰ˆæœ¬ï¼Œæˆ–è€…ä½¿ç”¨å…·æœ‰å…±äº«ç»„ä»¶çš„ä¸¤ä¸ªä¸åŒçš„åº“ã€‚</p>
</li>
<li><p><strong>æ˜“å—æ”»å‡»ä¸»æœºçš„æœ‰æ•ˆç¾¤é›†ï¼š</strong>åœ¨æˆ‘ä»¬å‘å—å½±å“çš„å„æ–¹æœ‰è´£ä»»åœ°æŠ«éœ²æˆ‘ä»¬çš„å‘ç°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ ¹æ®è„†å¼±æ€§ä¸»æœºçš„å“åº”å›¾å¯¹å…¶è¿›è¡Œåˆ†ç»„ã€‚ ä¸ºäº†è¿›ä¸€æ­¥å®Œå–„æˆ‘ä»¬çš„åˆ†ç»„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§åŸºäºäºŒç»´åŠ›å¯¼å‘å›¾çš„å›¾å½¢FortAtlas2ç®—æ³•[21]ã€‚ è¯¥ç®—æ³•ä½¿æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºæ˜“å—æ”»å‡»çš„æœåŠ¡å™¨ä¸»æœºçš„å›¾è¡¨ï¼Œä»è€Œæœ‰æ•ˆåœ°å¤„ç†æˆ‘ä»¬è´Ÿè´£çš„æŠ«éœ²æµç¨‹ã€‚</p>
</li>
<li><p><strong>å¯ä»¥åˆ©ç”¨çš„æ–°æ¼æ´ï¼š</strong>ä¸ºäº†åˆ©ç”¨å¡«å……æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦åŒºåˆ†ä¸åŒçš„å“åº”ï¼Œä»¥åŒºåˆ†æ­£ç¡®å’Œä¸æ­£ç¡®çš„å¡«å……ã€‚ åœ¨TLSä¸­é€šå¸¸ä¸æ˜¯è¿™ç§æƒ…å†µï¼šå³ä½¿æœåŠ¡å™¨å‘é€ä¸¤ä¸ªä¸åŒçš„è­¦æŠ¥æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä¹Ÿä¼šè¢«åŠ å¯†ï¼Œå¹¶ä¸”æ”»å‡»è€…æ— æ³•è§‚å¯Ÿåˆ°å·®å¼‚ã€‚ å› æ­¤ï¼Œä»¥å‰çš„å¤§å¤šæ•°é’ˆå¯¹TLSçš„padding oracleæ”»å‡»éƒ½ä¾èµ–äºè®¡æ—¶åº¦é‡æ¥åŒºåˆ†ä¸åŒçš„é”™è¯¯æƒ…å†µ[4ã€3ã€20]ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬è¡¨æ˜ï¼Œè®¸å¤šTLSå®ç°éƒ½ä¼šæ˜¾ç¤ºå‡ºæ­£ç¡®å¡«å……å’Œé”™è¯¯å¡«å……ä¹‹é—´çš„æ˜æ˜¾å·®å¼‚ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¸€ç§é”™è¯¯æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šä¼˜é›…åœ°å…³é—­TCPè¿æ¥ï¼Œè€Œåœ¨å¦ä¸€ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šä¸ä¼˜é›…åœ°å…³é—­å®ƒã€‚ åŒæ ·ï¼ŒæŸäº›æœåŠ¡å™¨ä¼šæ ¹æ®ç‰¹å®šçš„å¡«å……é”™è¯¯å‘é€ä¸åŒæ•°é‡çš„è­¦æŠ¥æ¶ˆæ¯ï¼Œä¸¤ç§è¡Œä¸ºéƒ½å¾ˆå®¹æ˜“è§‚å¯Ÿåˆ°ã€‚</p>
</li>
<li><p><strong>è´Ÿè´£äººçš„æŠ«éœ²å’Œé“å¾·è€ƒé‡ï¼š</strong>ä¸å—å½±å“çš„ç½‘ç«™æ‰€æœ‰è€…åˆä½œï¼Œæˆ‘ä»¬ä»¥è´Ÿè´£ä»»çš„æ€åº¦å‘å‡ å®¶è„†å¼±çš„ä¾›åº”å•†æŠ«éœ²äº†æˆ‘ä»¬çš„å‘ç°ã€‚ æˆåŠŸæ”»å‡»çš„ç»“æœæ˜¯ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè§£å¯†åœ¨TLSè¿æ¥ä¸­é‡å¤ä¼ è¾“çš„ç§˜å¯†å€¼ã€‚ é€šè¿‡æ‰§è¡Œæ‰«æï¼Œæˆ‘ä»¬æ— æ³•é‡å»ºæœåŠ¡å™¨ç§é’¥æˆ–å…¶ä»–æœºå¯†æ•°æ®ã€‚ æˆ‘ä»¬ä½¿ç”¨ä¼ªæ•°æ®æ‰§è¡Œæ‰«æï¼Œä»æœªå°è¯•è§£å¯†çœŸå®ç”¨æˆ·æµé‡ã€‚ æˆ‘ä»¬ä»¥è´Ÿè´£ä»»çš„æ–¹å¼å‘ä»¥ä¸‹ä¾›åº”å•†å’Œå—å½±å“çš„å„æ–¹æŠ«éœ²äº†æˆ‘ä»¬çš„å‘ç°ï¼šIBMï¼ŒAmazonï¼ŒSlackï¼ŒCiscoï¼ŒCitrixï¼ŒOracleï¼ŒHerokuï¼ŒNetflixï¼ŒSonicwallï¼ŒVenmoå’ŒVineã€‚</p>
</li>
</ul>
<h1 id="äºŒã€èƒŒæ™¯"><a href="#äºŒã€èƒŒæ™¯" class="headerlink" title="äºŒã€èƒŒæ™¯"></a>äºŒã€èƒŒæ™¯</h1><p>TLSåè®®åœ¨ç°ä»£Internetä¸Šæä¾›äº†æœºå¯†æ€§ã€å®Œæ•´æ€§å’Œè®¤è¯æ€§ã€‚è¯¥åè®®çš„æœ€æ–°ç‰ˆæœ¬æ˜¯TLS 1.3 [31]ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œæ­¤ç‰ˆæœ¬æ­£åœ¨é€æ­¥ä½¿ç”¨ã€‚åœ¨å®Œå…¨éƒ¨ç½²TLS 1.3ä¹‹å‰ï¼Œè¢«å¹¿æ³›ä½¿ç”¨çš„æœ€æ–°ç‰ˆæœ¬æ˜¯TLS 1.2 [14]ã€‚ç°ä»£çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šå¸¸è¿˜æ”¯æŒä¸¤ä¸ªä»¥å‰çš„ç‰ˆæœ¬ï¼Œå³TLS 1.0å’Œ1.1 [12ï¼Œ13]ã€‚åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä»…è®¨è®º1.0è‡³1.2ç‰ˆæœ¬ï¼Œè¿™äº›ç‰ˆæœ¬ä»Šå¤©å·²æ™®éä½¿ç”¨å¹¶å…·æœ‰ç›¸ä¼¼çš„ç»“æ„ã€‚ TLSåè®®åŒ…å«ä¸¤ä¸ªé˜¶æ®µã€‚åœ¨ç§°ä¸ºæ¡æ‰‹çš„ç¬¬ä¸€é˜¶æ®µï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€‰æ‹©å°†ç”¨äºä¼šè¯çš„å¯†ç ç®—æ³•å¹¶å»ºç«‹ä¼šè¯å¯†é’¥ã€‚åœ¨ç¬¬äºŒé˜¶æ®µï¼Œå¯¹ç­‰æ–¹å¯ä»¥å®‰å…¨åœ°å‘é€å’Œæ¥æ”¶åº”ç”¨ç¨‹åºæ•°æ®ï¼Œè¿™äº›æ•°æ®ä½¿ç”¨ä¸Šä¸€é˜¶æ®µä¸­å»ºç«‹çš„å¯†é’¥å’Œç®—æ³•è¿›è¡ŒåŠ å¯†å’Œèº«ä»½éªŒè¯ã€‚å¯†ç ç®—æ³•çš„ä¸Šè¿°é€‰æ‹©ç§°ä¸ºTLSå¯†ç å¥—ä»¶[14]ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå¯†ç å¥—ä»¶æ˜¯é’ˆå¯¹æ‰€æœ‰å¿…éœ€çš„åŠ å¯†ä»»åŠ¡çš„å…·ä½“ç®—æ³•é€‰æ‹©ã€‚å¯†ç å¥—ä»¶æ˜¯é€šè¿‡å°†å®ƒä»¬å¯¹è¿™äº›ç®—æ³•çš„é€‰æ‹©è¿›è¡Œä¸²è”æ¥å‘½åçš„ã€‚ä¾‹å¦‚ï¼Œå¯†ç å¥—ä»¶TLS_RSA_WITH_AES_128_CBC_SHAä½¿ç”¨RSAå…¬é’¥åŠ å¯†ä»¥ä¾¿åœ¨ç¬¬ä¸€é˜¶æ®µå»ºç«‹å…±äº«ä¼šè¯å¯†é’¥ï¼Œå¹¶ä¸”è¿˜ä½¿ç”¨å…·æœ‰128ä½å¯†é’¥å’ŒåŸºäºSHA-1çš„HMACçš„å¯¹ç§°AES-CBCåŠ å¯†ï¼Œä»¥ä¾¿åœ¨ç¬¬äºŒé˜¶æ®µåŠ å¯†å’Œè®¤è¯æ•°æ®ã€‚</p>
<h2 id="TLSæ¡æ‰‹åè®®"><a href="#TLSæ¡æ‰‹åè®®" class="headerlink" title="TLSæ¡æ‰‹åè®®"></a>TLSæ¡æ‰‹åè®®</h2><p>å®¢æˆ·ç«¯ä½¿ç”¨ClientHelloæ¶ˆæ¯å‘èµ·TLSæ¡æ‰‹ã€‚æ­¤æ¶ˆæ¯é€šå‘Šå®¢æˆ·ç«¯æ”¯æŒçš„TLSç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ã€‚ç„¶åï¼ŒæœåŠ¡å™¨ä½¿ç”¨æŒ‡å®šæ‰€é€‰å¯†ç å¥—ä»¶çš„ServerHelloæ¶ˆæ¯è¿›è¡Œå“åº”ã€‚å®ƒè¿˜åœ¨è¯ä¹¦æ¶ˆæ¯ä¸­å‘é€å…¶è¯ä¹¦ï¼Œå¹¶é€šè¿‡ServerHelloDoneæ¶ˆæ¯æŒ‡ç¤ºä¼ è¾“ç»“æŸã€‚ç„¶åï¼Œå®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªç§°ä¸ºé¢„ä¸»å¯†ç çš„ç§˜å¯†å€¼ï¼Œåœ¨æœåŠ¡å™¨çš„RSAå¯†é’¥ä¸‹å¯¹å…¶è¿›è¡ŒåŠ å¯†ï¼Œå¹¶åœ¨ClientKeyExchangeæ¶ˆæ¯ä¸­å‘é€åŠ å¯†çš„å¯†æ–‡ã€‚åœ¨å…±äº«äº†é¢„ä¸»ç§˜å¯†çš„çŸ¥è¯†ä¹‹åï¼ŒåŒæ–¹ç°åœ¨åŸºäºé¢„ä¸»ç§˜å¯†æ¨å¯¼è¦åœ¨ä¼šè¯ä¸­ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†å’ŒMACå¯†é’¥ã€‚æœ€åï¼ŒåŒæ–¹éƒ½å‘é€ChangeCipherSpecå’ŒFinishæ¶ˆæ¯ã€‚ChangeCipherSpecæ¶ˆæ¯é€šçŸ¥æ¥æ”¶æ–¹åç»­æ¶ˆæ¯å°†æ ¹æ®ä¼šè¯å¯†é’¥å¹¶ä½¿ç”¨å¯†ç å¥—ä»¶ä¸­æŒ‡å®šçš„å¯¹ç§°åŠ å¯†å’ŒHMACç®—æ³•è¿›è¡ŒåŠ å¯†å’ŒéªŒè¯ã€‚å®Œæˆçš„æ¶ˆæ¯åŒ…å«åŸºäºä»é¢„ä¸»ç§˜å¯†æ´¾ç”Ÿçš„å¯†é’¥å¯¹æ‰€æœ‰å…ˆå‰æ¡æ‰‹æ¶ˆæ¯è®¡ç®—çš„HMACã€‚ç”±äºæ­¤æ¶ˆæ¯æ˜¯åœ¨ChangeCipherSpecæ¶ˆæ¯ä¹‹åå‘é€çš„ï¼Œå› æ­¤å®ƒæ˜¯ä¼šè¯ä¸­ä½¿ç”¨å¯¹ç§°åŠ å¯†å’ŒMACè¿›è¡ŒåŠ å¯†å’ŒéªŒè¯çš„ç¬¬ä¸€æ¡æ¶ˆæ¯ã€‚å¦‚æœå®Œæˆçš„æ¶ˆæ¯åœ¨ä¸¤ç«¯éƒ½æ­£ç¡®è§£å¯†å’ŒéªŒè¯ï¼Œåˆ™åŒæ–¹ç°åœ¨éƒ½å¯ä»¥å®‰å…¨åœ°äº¤æ¢åº”ç”¨ç¨‹åºæ•°æ®ã€‚</p>
<h2 id="CBCåˆ†ç»„å¯†ç é“¾æ¥æ¨¡å¼"><a href="#CBCåˆ†ç»„å¯†ç é“¾æ¥æ¨¡å¼" class="headerlink" title="CBCåˆ†ç»„å¯†ç é“¾æ¥æ¨¡å¼"></a>CBCåˆ†ç»„å¯†ç é“¾æ¥æ¨¡å¼</h2><p>TLSä¸­å¯èƒ½çš„åŠ å¯†ç®—æ³•æœ‰å¾ˆå¤šï¼Œä½†æœ¬æ–‡ä¸»è¦ç ”ç©¶çš„æ˜¯CBCåŠ å¯†æ¨¡å¼ã€‚åœ¨CBCæ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªæ˜æ–‡å—åœ¨è¢«å—å¯†ç åŠ å¯†ä¹‹å‰ä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚å½¢å¼ä¸Šï¼Œå¦‚æœæˆ‘ä»¬ç”¨Piè¡¨ç¤ºæ˜æ–‡å—ï¼ˆi=0ï¼Œâ€¦ï¼‰ï¼Œå¯†æ–‡å—ç”¨Ciè¡¨ç¤ºï¼Œå¹¶ä¸”ç”¨å¯†é’¥kä¸‹çš„å—å¯†ç åŠ å¯†ä¸ºEnck()ï¼Œåˆ™Ci=Enck(PiâŠ•C(iâˆ’1))ï¼Œ(i=1ï¼Œâ€¦)ã€‚é™¤äº†ç¬¬ä¸€ä¸ªå—ä¹‹å¤–çš„æ‰€æœ‰å—éƒ½æ˜¯å¦‚æ­¤ï¼Œåœ¨ç¬¬ä¸€ä¸ªå—ä¸­æ²¡æœ‰å…ˆå‰çš„å¯†æ–‡å—ï¼Œç›¸åï¼Œè¯¥å—åœ¨åŠ å¯†ä¹‹å‰ä¸åˆå§‹åŒ–å‘é‡(IV)è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼šC0=Enck(P0âŠ•IV)ã€‚</p>
<ul>
<li><strong>CBCæ¨¡å¼çš„å»¶å±•æ€§ï¼š</strong>CBCæ¨¡å¼å…è®¸æ”»å‡»è€…åœ¨ä¸çŸ¥é“å¯¹ç§°å¯†é’¥çš„æƒ…å†µä¸‹æ‰§è¡Œæœ‰æ„ä¹‰çš„æ˜æ–‡ä¿®æ”¹ã€‚å…·ä½“åœ°è¯´ï¼Œå‡è®¾æ”»å‡»è€…çŸ¥é“åŸå§‹æ˜æ–‡Piçš„æŸä¸ªå—ï¼Œå¹¶ä¸”æƒ³è¦æ›´æ”¹å¯†æ–‡ï¼Œä½¿å¾—å—iæ”¹ä¸ºè§£å¯†ä¸ºPiâ€™ã€‚æ”»å‡»è€…å¯ä»¥å°†å…ˆå‰çš„å¯†æ–‡å—C(iâˆ’1)æ›´æ”¹ä¸ºC(iâˆ’1)=C(iâˆ’1)â€™âŠ•PiâŠ•Piâ€™ã€‚è¿™æ˜¯ä»¥ç ´åå‰ä¸€ä¸ªå—ä¸ºä»£ä»·çš„ï¼Œè¯¥å—ç°åœ¨è¢«è§£å¯†ä¸ºæ”»å‡»è€…é€šå¸¸æ— æ³•é¢„æµ‹çš„å€¼ã€‚æ­¤å¤–ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ä½¿ç”¨æ­¤æŠ€æœ¯æ—¶æ›´æ”¹å—çš„é¡ºåºã€‚å¦‚æœæ”»å‡»è€…çŸ¥é“æ˜æ–‡å—Piå¹¶ç”¨Ciæ›¿æ¢å¯†æ–‡å—Cjï¼Œåˆ™å—jç°åœ¨å°†è§£å¯†ä¸ºPjâ€™=PiâŠ•C(iâˆ’1)âŠ•C(jâˆ’1)ã€‚CBCæ¨¡å¼çš„è¿™ç§â€œå»¶å±•æ€§â€ç‰¹æ€§å·²ç»è¢«ç”¨äºè®¸å¤šå¯†ç æ”»å‡»ï¼Œä¹Ÿæ˜¯æœ¬æ–‡ä»‹ç»çš„æ”»å‡»çš„åŸºçŸ³ã€‚</li>
</ul>
<h2 id="TLSè®°å½•å±‚"><a href="#TLSè®°å½•å±‚" class="headerlink" title="TLSè®°å½•å±‚"></a>TLSè®°å½•å±‚</h2><p>TLSè®°å½•å±‚å°è£…åè®®æ¶ˆæ¯ã€‚æœ¬è´¨ä¸Šï¼Œè®°å½•å±‚ç”¨åŒ…å«æ¶ˆæ¯é•¿åº¦ã€æ¶ˆæ¯ç±»å‹å’Œåè®®ç‰ˆæœ¬çš„æŠ¥å¤´åŒ…è£…åè®®æ¶ˆæ¯ã€‚ä¸€æ—¦äº¤æ¢äº†ChangeCipherSpecæ¶ˆæ¯ï¼Œåç»­çš„TLSè®°å½•å°†å°è£…åŠ å¯†çš„æ¶ˆæ¯ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ä½¿ç”¨CBCæ“ä½œæ¨¡å¼çš„å¯†ç å¥—ä»¶ã€‚è¿™äº›å¯†ç å¥—ä»¶ä½¿ç”¨æ¶ˆæ¯éªŒè¯ç (MAC)æ¥ä¿æŠ¤TLSè®°å½•çš„çœŸå®æ€§ï¼Œå¹¶åœ¨CBCæ¨¡å¼ä¸‹ä½¿ç”¨å—å¯†ç (ä¾‹å¦‚ï¼ŒAESæˆ–3DES)åŠ å¯†åº”ç”¨ç¨‹åºæ•°æ®ã€‚TLSè§„èŒƒè§„å®šäº†MAC-Then-Pad-Then-Encryptæœºåˆ¶[14]ã€‚åŠ å¯†å™¨é¦–å…ˆè®¡ç®—æ˜æ–‡ä¸Šçš„MACï¼Œå°†MACè¿æ¥åˆ°æ˜æ–‡ï¼Œå¡«å……æ¶ˆæ¯ä»¥ä½¿å…¶é•¿åº¦æ˜¯å—é•¿åº¦çš„å€æ•°ï¼Œæœ€ååœ¨CBCæ¨¡å¼ä¸‹ä½¿ç”¨åˆ†ç»„å¯†ç åŠ å¯†MACå’Œå¡«å……çš„æ˜æ–‡ã€‚</p>
<p>TLSæŒ‡å®šå¡«å……å­—èŠ‚çš„ç²¾ç¡®å€¼ï¼Œå¡«å……æ˜æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚æŒ‡å®šä½¿ç”¨å¤šå°‘ä¸ªå¡«å……å­—èŠ‚ï¼Œä¸åŒ…æ‹¬æœ€åä¸€ä¸ªå­—èŠ‚ã€‚å…¶ä½™å¡«å……å­—èŠ‚çš„å€¼ä¸æœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼ç›¸åŒã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨4ä¸ªå¡«å……å­—èŠ‚(åŒ…æ‹¬æœ€åä¸€ä¸ªå­—èŠ‚)ï¼Œåˆ™æ‰€æœ‰4ä¸ªå­—èŠ‚çš„å€¼å°†ä¸º0x03ã€‚</p>
<p>ä¸ºäº†æ¼”ç¤ºæ•´ä¸ªè¿‡ç¨‹ï¼Œå¦‚æœåŠ å¯†å™¨ä½¿ç”¨TLS_RSA_WITH_AES_128_CBC_SHAå¯†ç å¥—ä»¶åŠ å¯†5ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä»–å°†ä½¿ç”¨HMAC-SHA(å…¶è¾“å‡ºä¸º20å­—èŠ‚é•¿ï¼Œå›ºå®šé•¿åº¦è¾“å‡º)å’ŒAES-CBCã€‚å¯¹åŸå§‹æ˜æ–‡åº”ç”¨HMAC-SHAåï¼Œè¿æ¥é•¿åº¦ä¸º25å­—èŠ‚ï¼Œé€‚åˆä¸¤ä¸ªAES 16å­—èŠ‚å—ï¼ˆAESæ˜¯åˆ†16å­—èŠ‚å—åŠ å¯†ï¼Œä¹Ÿå³128bitä½å—åŠ å¯†ï¼‰ã€‚åŠ å¯†å™¨é€šå¸¸ä¼šé€‰æ‹©æœ€å°å¯è¡Œå¡«å……é‡ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º7å­—èŠ‚ã€‚ç¬¬ä¸€ä¸ªå—åŒ…å«æ•°æ®å’Œå‰11ä¸ªHMACå­—èŠ‚ã€‚ç¬¬äºŒä¸ªå—åŒ…å«å‰©ä½™çš„9ä¸ªHMACå­—èŠ‚å’Œ7ä¸ªå­—èŠ‚çš„å¡«å……0x06ï¼Œè§å›¾1ã€‚è¯·æ³¨æ„ï¼ŒåŠ å¯†å™¨è¿˜å¯ä»¥é€‰æ‹©è¾ƒé•¿çš„å¡«å……ï¼Œå¹¶é™„åŠ 23ã€39ã€â€¦æˆ–247ä¸ªå¡«å……å­—èŠ‚(åŒæ—¶ç›¸åº”åœ°è®¾ç½®å¡«å……å­—èŠ‚çš„å€¼)ã€‚</p>
<p><img src="/images/USS-2020-paper/Figure-1.jpg" alt="Figure-1ï¼šå½“ä½¿ç”¨AES-CBCå’ŒHMAC-SHAå¤„ç†5ä¸ªæ˜æ–‡å­—èŠ‚æ—¶ï¼ŒåŠ å¯†å™¨éœ€è¦é™„åŠ 20ä¸ªå­—èŠ‚çš„HMAC-SHAè¾“å‡ºå’Œ7ä¸ªå­—èŠ‚çš„å¡«å……"></p>
<h1 id="ä¸‰ã€Padding-Oracleæ¼æ´çš„å†å²"><a href="#ä¸‰ã€Padding-Oracleæ¼æ´çš„å†å²" class="headerlink" title="ä¸‰ã€Padding Oracleæ¼æ´çš„å†å²"></a>ä¸‰ã€Padding Oracleæ¼æ´çš„å†å²</h1><p>SSLv3å’ŒTLSä¸­çš„ä¸»è¦è®¾è®¡å¤±è´¥ä¹‹ä¸€æ˜¯CBCå¯†ç å¥—ä»¶ä¸­çš„MAC-then-Pad-then-Encryptæ–¹æ¡ˆè§„èŒƒã€‚ è¯¥æ–¹æ¡ˆè´Ÿè´£å¯¹TLSå®ç°çš„ä¸€ç³»åˆ—æ”»å‡»ï¼Œè¿™äº›æ”»å‡»ç§°ä¸ºpadding oracleæ”»å‡»ã€‚ å³ä½¿åœ¨TLSè§„èŒƒ[14ï¼Œç¬¬6.2.3.2èŠ‚]ä¸­æ˜ç¡®æ€»ç»“äº†è¿™äº›å¯¹ç­–ï¼Œä½†å…¶æ­£ç¡®å®æ–½ä»å…·æœ‰æŒ‘æˆ˜æ€§ã€‚</p>
<h2 id="Vaudenayå¼çš„Padding-Oraclesæ”»å‡»"><a href="#Vaudenayå¼çš„Padding-Oraclesæ”»å‡»" class="headerlink" title="Vaudenayå¼çš„Padding Oraclesæ”»å‡»"></a>Vaudenayå¼çš„Padding Oraclesæ”»å‡»</h2><p>2002å¹´ï¼ŒVaudenayè¯æ˜äº†MAC-Then-Pad-Then-Encryptæ–¹æ¡ˆåœ¨å®‰å…¨åè®®ä¸­å¼•å…¥äº†æ½œåœ¨çš„æ¼æ´ï¼Œå…¶å½¢å¼å°±æ˜¯æ‰€è°“çš„padding oracle[39]ã€‚åˆ©ç”¨è¿™äº›æ¼æ´çš„æ”»å‡»åŸºäºCBCæ“ä½œæ¨¡å¼çš„å»¶å±•æ€§ã€‚æˆ‘ä»¬å…³æ³¨çš„æ˜¯TLSçš„æ¡ˆä¾‹ã€‚</p>
<p>ä½¿ç”¨CBCæ¨¡å¼æ—¶ï¼Œè¯·è€ƒè™‘TLSè®°å½•å±‚ã€‚è§£å¯†åï¼Œè§£å¯†æ–¹éœ€è¦éªŒè¯å¡«å……å­—èŠ‚å’ŒMACå­—èŠ‚ã€‚å®æ–½è¿™ä¸¤ä¸ªæ£€æŸ¥çš„è‡ªç„¶æ–¹æ³•æ˜¯é¦–å…ˆéªŒè¯å¡«å……å­—èŠ‚ï¼Œå¦‚æœå®ƒä»¬éªŒè¯æ­£ç¡®ï¼Œåˆ™éªŒè¯MACå­—èŠ‚ã€‚å¦‚æœå¡«å……å­—èŠ‚æ— æ•ˆï¼Œå®ç°è‡ªç„¶ä¼šå‘å‡ºé”™è¯¯æ¶ˆæ¯ï¼Œè€Œä¸æ£€æŸ¥MACå­—èŠ‚ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå¡«å……å­—èŠ‚æœ‰æ•ˆä½†MACæ— æ•ˆï¼Œåˆ™è‡ªç„¶ä¼šå‘å‡º(å¯èƒ½ä¸åŒçš„)é”™è¯¯æ¶ˆæ¯ã€‚</p>
<p>å‡è®¾è§£å¯†å™¨åœ¨è¿™äº›æƒ…å†µä¸‹ç¡®å®å‘å‡ºä¸¤ä¸ªä¸åŒçš„é”™è¯¯æ¶ˆæ¯ã€‚æ”»å‡»è€…å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼è§£å¯†ä»»ä½•æ¶ˆæ¯å—PIçš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚ä»–å°†æœ€åä¸€ä¸ªå¯†æ–‡å—è®¾ç½®ä¸ºCiï¼Œå¹¶ç”¨0åˆ°255ä¹‹é—´çš„å€¼æ›¿æ¢å‰ä¸€ä¸ªå—C(iâˆ’1)çš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚å¦‚æœæœ€åä¸€ä¸ªæ˜æ–‡å­—èŠ‚æ˜¯0x00ï¼Œåˆ™å¡«å……å°†æ˜¯æœ‰æ•ˆçš„(å…¶ä»–å½¢å¼çš„æœ‰æ•ˆå¡«å……çš„å¯èƒ½æ€§è¦å°å¾—å¤š)ã€‚å½“å¡«å……å­—èŠ‚è¢«æ­£ç¡®éªŒè¯æ—¶ï¼Œæ”»å‡»è€…é€šè¿‡è§‚å¯Ÿè§£å¯†å™¨å‘å‡ºâ€œæ— æ•ˆMACâ€é”™è¯¯è€Œä¸æ˜¯â€œæ— æ•ˆå¡«å……â€é”™è¯¯æ¥æ£€æµ‹åˆ°è¿™ä¸€ç‚¹ã€‚æ”»å‡»è€…åœ¨å‘è§£å¯†å™¨å‘é€æœ€å¤š255ä¸ªå¯†æ–‡ä¹‹åè·çŸ¥Piçš„æœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼ã€‚</p>
<p>åˆ©ç”¨ä»–å¯¹æœ€åä¸€ä¸ªæ˜æ–‡å­—èŠ‚çš„äº†è§£ï¼Œæ”»å‡»è€…å¯ä»¥ç»§ç»­è§£å¯†Piçš„å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚ã€‚é€šè¿‡è¿™æ ·åšï¼Œä»–çš„ç›®æ ‡æ˜¯åˆ›å»ºé•¿åº¦ä¸º2çš„æœ‰æ•ˆå¡«å……ã€‚æ›´å¹¿æ³›åœ°è¯´ï¼Œä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿­ä»£åœ°è§£å¯†Piä¸­çš„æ¯ä¸ªå­—èŠ‚ã€‚æˆ‘ä»¬çœç•¥äº†å¯¹å…¶ä½™æ”»å‡»çš„æ­£å¼æè¿°ï¼Œè¯·è¯»è€…å‚è€ƒ[39]ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œä¸Šè¿°æ”»å‡»ä¾èµ–äºåŒºåˆ†è§£å¯†ä¸ºæœ‰æ•ˆå’Œæ— æ•ˆå¡«å……çš„å¯†æ–‡çš„èƒ½åŠ›ã€‚å› æ­¤ï¼Œå¯¹äºTLSå®ç°æ¥è¯´ï¼Œé€šè¿‡ç¡®ä¿å®ƒä»¬å§‹ç»ˆå‘å‡ºç›¸åŒçš„é”™è¯¯æ¶ˆæ¯æ¥é˜²æ­¢è¿™ç§æ”»å‡»ä¼¼ä¹å¾®ä¸è¶³é“ã€‚äº‹å®ä¸Šï¼ŒVaudenayå¹¶ä¸çŸ¥é“æ”»å‡»è€…å¯ä»¥åœ¨TLSä¸Šä¸‹æ–‡ä¸­ç›´æ¥åŒºåˆ†è¿™ä¸¤ç§æƒ…å†µã€‚åŸå› æ˜¯ï¼Œå³ä½¿TLSé”™è¯¯æ¶ˆæ¯ä¸åŒï¼Œä¹Ÿä¸å¯èƒ½åŒºåˆ†å®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”¨TLSä¼šè¯å¯†é’¥åŠ å¯†çš„ã€‚è¿™æ˜¯æˆ‘ä»¬åœ¨å·¥ä½œä¸­åº”å¯¹çš„æŒ‘æˆ˜ä¹‹ä¸€ã€‚</p>
<h2 id="BEASTæ”»å‡»æ¨¡å‹"><a href="#BEASTæ”»å‡»æ¨¡å‹" class="headerlink" title="BEASTæ”»å‡»æ¨¡å‹"></a>BEASTæ”»å‡»æ¨¡å‹</h2><p>Vaudenayçš„è®ºæ–‡ä¸­ç•™ä¸‹äº†ä¸€ä¸ªæ‚¬è€Œæœªå†³çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å¦‚ä½•åˆ©ç”¨ä»–æ‰€è¯´çš„â€œçˆ†ç‚¸æ€§å…ˆçŸ¥â€â€”â€”ä¸€ç§åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è¿”å›å¦å®šç­”æ¡ˆä¹‹å‰æ‰èƒ½ä½¿ç”¨çš„å…ˆçŸ¥ã€‚è¿™æ¨¡æ‹Ÿäº†è¿™æ ·çš„é—®é¢˜ï¼šä¸€æ—¦æ¶ˆæ¯æ²¡æœ‰æ­£ç¡®è§£å¯†ï¼ŒTLSå®ç°å°±ä¼šä¸­æ­¢ä¼šè¯ã€‚å› æ­¤ï¼Œä¸€æ—¦å‡ºç°ç¬¬ä¸€ä¸ªè§£å¯†é”™è¯¯ï¼Œä¾èµ–äºTLSä¼šè¯ä¸­æ›´æ”¹æ¶ˆæ¯çš„æ”»å‡»è€…å°†æ— æ³•ç»§ç»­æ”»å‡»ã€‚</p>
<p>Canvelç­‰äººä½¿ç”¨äº†ä¸€ç§æ¨¡å‹ï¼Œå…¶ä¸­å®¢æˆ·ç«¯é‡å¤è¿æ¥åˆ°æœåŠ¡å™¨[11]ï¼Œè§‚å¯Ÿåˆ°è¿™æ˜¯ç”±äºå½“æ—¶ç”µå­é‚®ä»¶å®¢æˆ·ç«¯çš„è½®è¯¢è¡Œä¸ºè€Œå‘ç”Ÿçš„ï¼Œå¹¶æ³„éœ²äº†è®¤è¯å¯†ç ã€‚BEASTæ”»å‡»[34]æœ¬è´¨ä¸Šä½¿ç”¨äº†ç›¸åŒçš„æ¨¡å‹ï¼Œä½†æ›´ä¾èµ–äºç°ä»£ç½‘ç»œæµè§ˆå™¨çš„è¡Œä¸ºã€‚åœ¨æœ€ç®€å•çš„BEASTæ¨¡å‹ä¸­ï¼Œå—å®³è€…è¢«éª—è®¿é—®ç”±æ”»å‡»è€…æ§åˆ¶çš„æ¶æ„ç½‘ç«™ã€‚è¯¥ç½‘ç«™åŒ…å«ä½¿å—å®³è€…æµè§ˆå™¨é‡å¤è¿æ¥åˆ°å—å®³è€…ç½‘ç«™çš„Javascriptã€‚ç„¶åï¼Œæ¯ä¸ªç½‘ç«™è¯·æ±‚éƒ½åŒ…å«ç”¨æˆ·èº«ä»½éªŒè¯Cookieï¼Œè¯¥Cookieç”±æµè§ˆå™¨è‡ªåŠ¨å‘é€ã€‚æ­¤è¡Œä¸ºå…è®¸æ”»å‡»è€…å¼ºåˆ¶å—å®³è€…é‡å¤å‘æœåŠ¡å™¨å‘é€åŠ å¯†å€¼ã€‚</p>
<p>æˆ‘ä»¬çš„æ”»å‡»å°±æ˜¯åœ¨è¿™ç§æ¨¡å¼ä¸‹è¿›è¡Œçš„ã€‚æˆ‘ä»¬å‡è®¾æ”»å‡»è€…å¯ä»¥å¯¼è‡´å—å®³è€…å®¢æˆ·ç«¯é‡å¤è¿æ¥åˆ°å—å®³è€…æœåŠ¡å™¨ï¼ŒåŒæ—¶é‡æ–°ä¼ è¾“ç›¸åŒçš„æ•æ„Ÿä¿¡æ¯ã€‚æˆ‘ä»¬è¿˜å‡è®¾æ”»å‡»è€…æ˜¯ä¸­é—´äºº(MITM)ï¼Œå¯ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ›´æ”¹æ¶ˆæ¯ã€‚è¿™ç§æ¨¡å¼ç°åœ¨å·²ç»æˆä¸ºç°ä»£æ”»å‡»çš„æ ‡å‡†æ–‡çŒ®ã€‚</p>
<h2 id="POODLEæ”»å‡»"><a href="#POODLEæ”»å‡»" class="headerlink" title="POODLEæ”»å‡»"></a>POODLEæ”»å‡»</h2><p>TLSçš„å‰èº«SSLv3ä½¿ç”¨ç±»ä¼¼çš„å…ˆMACåPadå†åŠ å¯†çš„æ–¹æ¡ˆã€‚ä½†æ˜¯ï¼Œä¸TLSä¸åŒçš„æ˜¯ï¼ŒSSLv3ä¸­å¡«å……å­—èŠ‚çš„å€¼æœªæŒ‡å®šã€‚æ˜æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå­˜åœ¨å¤šå°‘å¡«å……å­—èŠ‚ï¼Œä½†å…¶ä½™å¡«å……å­—èŠ‚å¯ä»¥å–ä»»ä½•å€¼ã€‚</p>
<p>è€ƒè™‘ä¸€æ¡å…·æœ‰16ä¸ªå¡«å……å­—èŠ‚çš„å®Œæ•´å—çš„æ¶ˆæ¯ã€‚æ˜æ–‡å—çš„æœ€åä¸€ä¸ªå­—èŠ‚ä¸º0x0Fï¼Œå‰15ä¸ªå­—èŠ‚å¯ä»¥å–ä»»ä½•å€¼ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨3.1èŠ‚ä¸­æè¿°çš„æŠ€æœ¯ï¼ˆVaudenayæ”»å‡»ï¼‰ï¼Œç”¨æœ€åä¸€ä¸ªå­—èŠ‚è§£å¯†ä¸º0x0Fçš„ä»»ä½•å—æ›¿æ¢æœ€åä¸€ä¸ªå—ï¼Œå¹¶è·å¾—æœ‰æ•ˆå¡«å……çš„æ¶ˆæ¯ã€‚SSLv3çš„è¿™ä¸€ç‰¹æ€§å¯¼è‡´äº†ç§°ä¸ºâ€œPOODLEâ€çš„æ¯ç­æ€§æ”»å‡»ã€‚æœ‰å…³æ”»å‡»çš„å®Œæ•´æè¿°ï¼Œè¯·å‚è§[27]ã€‚</p>
<p>å°½ç®¡POODLEä¾èµ–äºSSLv3ä¸­æœªæŒ‡å®šçš„å¡«å……å­—èŠ‚ï¼Œä½†ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå®ƒä¹Ÿä¼šå½±å“TLSå®ç°ã€‚æœ¬è´¨ä¸Šï¼Œä¸ä¼šå¼ºè¿«ç²—å¿ƒçš„TLSå¼€å‘äººå‘˜åœ¨è§£å¯†åéªŒè¯(æŒ‡å®šçš„)å¡«å……å­—èŠ‚ï¼›å³ä½¿æ ¹æœ¬ä¸æ£€æŸ¥å¡«å……å­—èŠ‚ï¼ŒTLSå®ç°ä¹Ÿå¯ä»¥å¾ˆå¥½åœ°äº’æ“ä½œã€‚äº‹å®ä¸Šï¼Œå¼€å‘äººå‘˜æ›´å®¹æ˜“åœ¨TLSå®ç°ä¸­é‡ç”¨å¤„ç†SSLv3å¡«å……çš„ç›¸åŒä»£ç ã€‚è¿™å¯¼è‡´äº†POODLEæ”»å‡»çš„ä¸€ç§å˜ä½“ï¼Œå½±å“äº†TLSçš„å®æ–½[25]ã€‚å³ä½¿åœ¨è¿™ä¸¤ä¸ªå¤‡å—ç©ç›®çš„å‘ç°ä¹‹åï¼ŒPOODLEçš„å˜ç§ä»åœ¨ä¸æ–­æ¶Œç°[10ï¼Œ29ï¼Œ28]ã€‚è¿™äº›å·¥ä½œæ£€æµ‹åˆ°äº†ä¸åŒçš„TLSè®°å½•å¤„ç†æ¼æ´ï¼›ä¸€äº›TLSå®ç°åªéªŒè¯äº†ç¬¬ä¸€ä¸ªMACå­—èŠ‚ï¼Œå…¶ä»–å®ç°è·³è¿‡äº†å¯¹ç‰¹å®šå¡«å……å­—èŠ‚çš„éªŒè¯ã€‚</p>
<h2 id="Lucky13å’Œå…¶ä»–æ—¶é—´ä¾§ä¿¡é“æ”»å‡»"><a href="#Lucky13å’Œå…¶ä»–æ—¶é—´ä¾§ä¿¡é“æ”»å‡»" class="headerlink" title="Lucky13å’Œå…¶ä»–æ—¶é—´ä¾§ä¿¡é“æ”»å‡»"></a>Lucky13å’Œå…¶ä»–æ—¶é—´ä¾§ä¿¡é“æ”»å‡»</h2><p>2013å¹´ï¼Œé˜¿å°”æ³•ç™»(AlFardan)å’Œå¸•ç‰¹æ£®(Paterson)[4]ä½¿ç”¨ç±»ä¼¼çš„æŠ€æœ¯æ‰“ç ´äº†TLSçš„æœºå¯†ï¼Œå¹¶å°†ä»–ä»¬çš„æ”»å‡»å‘½åä¸ºâ€œå¹¸è¿13å·â€(Lucky 13)ã€‚è¯¥æ”»å‡»ä¾èµ–äºä¸€ä¸ªé‡è¦çš„è§‚å¯Ÿç»“æœï¼šåœ¨å¤„ç†ä¸åŒé•¿åº¦çš„è¾“å…¥æ—¶ï¼Œå¸¸è§çš„HMACå‡½æ•°éœ€è¦ä¸åŒçš„å¤„ç†æ—¶é—´ã€‚é€šè¿‡æ‰§è¡Œå·§å¦™çš„å¡«å……å­—èŠ‚æ“ä½œï¼Œæ”»å‡»è€…å¯ä»¥å¼ºåˆ¶æœåŠ¡å™¨å¯¹ä¸åŒé•¿åº¦çš„æ˜æ–‡æ‰§è¡ŒHMACè®¡ç®—ã€‚è¿™æ˜¯å› ä¸ºå¡«å……é•¿åº¦å†³å®šäº†ç”¨ä½œHMACå‡½æ•°è¾“å…¥çš„æ•°æ®é‡ã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥æµ‹é‡ä¸åŒçš„å¤„ç†æ—¶é—´å¹¶äº†è§£æœ‰å…³å¡«å……å­—èŠ‚çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å»ºè®®è¯»è€…å‚è€ƒ[4]ä»¥è·å–å®Œæ•´çš„æ”»å‡»æè¿°ã€‚</p>
<p>Lucky 13çš„ä¿®å¤æ˜¯å°†TLSå®ç°ä¸­çš„MACéªŒè¯ç æ›´æ”¹ä¸ºæ’å®šæ—¶é—´ï¼Œè€Œä¸è€ƒè™‘å¤„ç†çš„æ˜æ–‡å—çš„æ•°é‡ã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œä½†ç¼–å†™å’Œç»´æŠ¤è¿™æ ·çš„ä»£ç æ˜¯å›°éš¾çš„ï¼Œå³ä½¿å¯¹ä¸“å®¶æ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤ã€‚2016å¹´ï¼ŒSomorovskyåœ¨OpenSSLçš„è¡¥ä¸ä»£ç ä¸­å‘ç°äº†ä¸€ä¸ªæ¼æ´[37]ã€‚è¯¥æ¼æ´å¼•å…¥äº†ä¸€ä¸ªç±»ä¼¼çš„ã€ç”šè‡³æ›´ä¸¥é‡çš„æ¼æ´ï¼Œä½¿å¾—æ”»å‡»è€…èƒ½å¤ŸåŒºåˆ†ä¸¤æ¡è­¦æŠ¥æ¶ˆæ¯ã€‚å¦‚æœè§£å¯†çš„æ¶ˆæ¯ä»…åŒ…å«ä¸¤ä¸ªæˆ–æ›´å¤šæœ‰æ•ˆå¡«å……å—ï¼Œåˆ™å¯ä»¥è§¦å‘ä¸åŒçš„æ¶ˆæ¯ã€‚</p>
<p>äºšé©¬é€Šçš„s2n TLSåº“å‘å¸ƒäº2015å¹´[24]ï¼Œä¹Ÿå°±æ˜¯Lucky 13æ”»å‡»äº‹ä»¶å‘å¸ƒä¹‹åã€‚s2nçš„å¼€å‘è€…æ„è¯†åˆ°äº†Lucky 13ï¼Œå¹¶å¼•å…¥äº†ç‰¹å®šçš„å¯¹ç­–ï¼Œä¼¼ä¹ä½¿ä»£ç ä¿æŒæ’å®šæ—¶é—´ï¼Œä»è€Œé¢„é˜²äº†æ”»å‡»ã€‚ä»–ä»¬è¿˜å¼•å…¥äº†éšæœºè®¡æ—¶å»¶è¿Ÿï¼Œä»¥ä¾¿åœ¨æ„å¤–æƒ…å†µä¸‹ä»£ç è¢«è¯æ˜æ˜¯æ˜“å—æ”»å‡»çš„ï¼Œä»è€Œä½¿æ”»å‡»å˜å¾—æ›´åŠ å›°éš¾ã€‚å°½ç®¡åšäº†è¿™äº›åŠªåŠ›ï¼Œs2nä»ç„¶å®¹æ˜“å—åˆ°Lucky 13[3ï¼Œ35]å˜ç§çš„æ”»å‡»ã€‚å°½ç®¡ä»£ç å·²ç»è¿‡æ­£å¼éªŒè¯ï¼Œä½†è¿˜æ˜¯å‘ç°äº†æ‰€æœ‰æ¼æ´ã€‚</p>
<h2 id="Bleichenbacheræ”»å‡»åŠå…¶å˜ç§"><a href="#Bleichenbacheræ”»å‡»åŠå…¶å˜ç§" class="headerlink" title="Bleichenbacheræ”»å‡»åŠå…¶å˜ç§"></a>Bleichenbacheræ”»å‡»åŠå…¶å˜ç§</h2><p>Bleichenbacherçš„æ”»å‡»[8]ä¹Ÿæ˜¯ä¸€ç§padding oracleæ”»å‡»ã€‚å®ƒé’ˆå¯¹çš„ä¸æ˜¯å¯¹ç§°åŠ å¯†ï¼Œè€Œæ˜¯RSAåŠ å¯†ä¸­ä½¿ç”¨çš„å¡«å……æ–¹æ¡ˆï¼Œç§°ä¸ºPKCS#1v1.5ã€‚å®ƒè¿˜ç±»ä¼¼åœ°åˆ©ç”¨RSAåŠ å¯†çš„å¯å»¶å±•æ€§å±æ€§ï¼Œå¹¶ä¾èµ–äºè§£å¯†å™¨(å³æœåŠ¡å™¨)åœ¨æ— æ•ˆå¡«å……æ˜æ–‡çš„æƒ…å†µä¸‹å‘å‡ºé”™è¯¯æ¶ˆæ¯ã€‚æ ‡å‡†å¯¹ç­–ç±»ä¼¼äºCBC Padding Oracleï¼›å½“åœ¨RSAè§£å¯†ä¸­é‡åˆ°é”™è¯¯çŠ¶æ€æ—¶ï¼ŒæœåŠ¡å™¨çš„è¡Œä¸ºä¸èƒ½æœ‰ä»»ä½•ä¸åŒã€‚è¿™ä¸€ååˆ¶æªæ–½å·²æˆä¸ºTLSæ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>ç„¶è€Œï¼Œæ­£ç¡®å®æ–½å¯¹ç­–æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ã€‚BÃ¶ckç­‰äººå·²æ‰«ææ˜“å—Bleichenbacheræ”»å‡»çš„æ˜“å—æ”»å‡»çš„TLSæœåŠ¡å™¨[9]ã€‚ä»–ä»¬å‘ç°Facebookå’ŒPaypalç­‰çŸ¥åç½‘ç«™ä½¿ç”¨çš„æœåŠ¡å™¨å­˜åœ¨æ¼æ´ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå®ƒä»¬çš„æ¼æ´å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸åŒçš„TLSåè®®æµæˆ–åˆ©ç”¨TCPè¿æ¥çŠ¶æ€(TCPé‡ç½®æˆ–è¶…æ—¶)è§¦å‘ã€‚ä¸CBC Padding Oracleä¸€æ ·ï¼ŒBleichenbacherçš„æ”»å‡»æ˜¾ç¤ºå‡ºç±»ä¼¼çš„æ”»å‡»å˜ç§åºåˆ—ï¼Œæ¯éš”å‡ å¹´å°±ä¼šåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­è¢«å‘ç°[26ï¼Œ22ï¼Œ6]ã€‚</p>
<h1 id="å››ã€æ‰«æä¸è¯„ä¼°çš„æ–¹æ³•è®º"><a href="#å››ã€æ‰«æä¸è¯„ä¼°çš„æ–¹æ³•è®º" class="headerlink" title="å››ã€æ‰«æä¸è¯„ä¼°çš„æ–¹æ³•è®º"></a>å››ã€æ‰«æä¸è¯„ä¼°çš„æ–¹æ³•è®º</h1><p>æˆ‘ä»¬ç ”ç©¶çš„æœ€ç»ˆç›®æ ‡æ˜¯ä¼°è®¡padding oracleæ¼æ´çš„æ•°é‡å’Œå½±å“ï¼Œå¹¶å°†æˆ‘ä»¬çš„å‘ç°æŠ¥å‘Šç»™è´Ÿè´£çš„ä¾›åº”å•†ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬åˆ†ä¸‰æ­¥è¿›è¡Œï¼šæˆ‘ä»¬é¦–å…ˆ<strong>å®šä¹‰</strong>ä¸€ä¸ªæµ‹è¯•å‘é‡åˆ—è¡¨ï¼Œè¿™äº›å‘é‡å¯èƒ½è§¦å‘å¯è§‚å¯Ÿåˆ°çš„å·®å¼‚ï¼Œä»è€Œå¯¼è‡´Padding Oracleã€‚ ç„¶åï¼Œæˆ‘ä»¬å‡å°‘è¯¥æµ‹è¯•å‘é‡åˆ—è¡¨ï¼Œå¹¶è¿›è¡Œå¤§è§„æ¨¡æ‰«æã€‚ æœ€åï¼Œæˆ‘ä»¬åˆ†æå‘ç°çš„æ¼æ´å’Œè´Ÿè´£ä»»çš„ä¾›åº”å•†ã€‚</p>
<h2 id="æµ‹è¯•å‘é‡ç”Ÿæˆ"><a href="#æµ‹è¯•å‘é‡ç”Ÿæˆ" class="headerlink" title="æµ‹è¯•å‘é‡ç”Ÿæˆ"></a>æµ‹è¯•å‘é‡ç”Ÿæˆ</h2><p>ä¸ºäº†åœ¨å®ç°ä¸­æ£€æµ‹Padding Oracleï¼Œæˆ‘ä»¬è¿æ¥å¹¶å‘é€å„ç§æ ¼å¼é”™è¯¯çš„è®°å½•ã€‚è¿™äº›è®°å½•åŒ…å«æœ‰å…³Paddingã€MACå’ŒApp Dataçš„ä¸åŒç¼ºé™·ã€‚ç„¶åï¼Œæˆ‘ä»¬è§‚å¯ŸTLSå±‚æˆ–æ›´ä½å±‚çš„å“åº”æ˜¯å¦å­˜åœ¨ä»»ä½•å·®å¼‚ã€‚å¯¹ä¸¤ä¸ªæ ¼å¼é”™è¯¯çš„è®°å½•ä½œå‡ºä¸åŒå“åº”çš„å®ç°å¯èƒ½å®¹æ˜“å—åˆ°æ”»å‡»ã€‚ä½¿ç”¨æ‰€æœ‰å¯èƒ½çš„æ ¼å¼é”™è¯¯çš„è®°å½•è¿›è¡Œæµ‹è¯•æ˜¯ä¸å¯è¡Œçš„ã€‚ä¾‹å¦‚ï¼Œæ˜“å—æ”»å‡»çš„å®ç°å¯ä»¥æ­£ç¡®åœ°æ£€æŸ¥æ‰€æœ‰å¡«å……å­—èŠ‚ï¼Œé™¤éå¡«å……å­—èŠ‚æ­£å¥½æ˜¯16å­—èŠ‚é•¿ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥å®ç°ä¸æ£€æŸ¥å¡«å……ä¸­çš„ç‰¹å®šä½ã€‚</p>
<p>ç”±äºå¯èƒ½æœ‰å¤šè¾¾256ä¸ªå¡«å……å­—èŠ‚ï¼Œæ‰€ä»¥æµ‹è¯•æ‰€æœ‰å¯èƒ½çš„å¡«å……é•¿åº¦çš„æ¯ä¸ªä½çš„æ­£ç¡®æœ‰æ•ˆæ€§å°†éœ€è¦ç”¨263,168ä¸ªä¸åŒçš„è®°å½•è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è®°å½•éœ€è¦ç”¨ä¸åŒçš„å¯†ç å¥—ä»¶æˆ–åè®®ç‰ˆæœ¬è¿›è¡Œæµ‹è¯•ï¼Œè¿™ä½¿å¾—è¿™æ ·çš„ç»¼åˆæµ‹è¯•æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä»”ç»†æŒ‘é€‰äº†ä¸€ç»„ç•¸å½¢è®°å½•ï¼ˆå…³é”®æ–¹æ¡ˆï¼‰ï¼Œè¿™äº›è®°å½•æ˜¯ç”±å…ˆå‰çš„ç ”ç©¶æ¨åŠ¨çš„ã€‚</p>
<p>æˆ‘ä»¬æ‰¿è®¤ï¼Œè¿™ç§é€‰æ‹©æ ¼å¼é”™è¯¯è®°å½•é›†çš„æ–¹å¼æ„å‘³ç€æˆ‘ä»¬åªèƒ½æ£€æµ‹åˆ°ä¸å·²çŸ¥æ¼æ´ç›¸ä¼¼çš„æ¼æ´ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•æ€§ä»·æ¯”é«˜ï¼Œéå¸¸é€‚åˆå¤§è§„æ¨¡æ‰«æã€‚ç”±äºåœ¨å¤§è§„æ¨¡æ‰«ææœŸé—´åªèƒ½å°†æœ‰é™æ•°é‡çš„æ¶ˆæ¯å‘é€åˆ°å„ä¸ªæœåŠ¡å™¨ï¼Œå› æ­¤æµ‹è¯•å‘é‡ç”Ÿæˆçš„è‡ªåŠ¨æ–¹æ³•(å¦‚æ¨¡ç³Š)é€šå¸¸æ˜¯ä¸å¯è¡Œçš„ã€‚</p>
<h3 id="æ ¼å¼é”™è¯¯è®°å½•"><a href="#æ ¼å¼é”™è¯¯è®°å½•" class="headerlink" title="æ ¼å¼é”™è¯¯è®°å½•"></a>æ ¼å¼é”™è¯¯è®°å½•</h3><p>æˆ‘ä»¬çš„æ ¼å¼é”™è¯¯çš„è®°å½•éƒ½æœ‰80ä¸ªå­—èŠ‚é•¿ã€‚é•¿åº¦ç›¸ç­‰å¯ç¡®ä¿å“åº”å·®å¼‚å¾ˆå¯èƒ½æ˜¯ç”±å¡«å……Oracleæ¼æ´å¼•èµ·çš„ï¼Œè€Œä¸æ˜¯ç”±ä¸åŒè®°å½•é•¿åº¦è§¦å‘çš„è¯¯æŠ¥ã€‚å¼‚å¸¸çš„è®°å½•é•¿åº¦å¯èƒ½ä¼šå¯¼è‡´ä¸è§£å¯†æ— å…³çš„é”™è¯¯ï¼›ä¾‹å¦‚ï¼Œå¦‚æœåŠ å¯†çš„TLSè®°å½•å°äºMACé•¿åº¦ï¼ˆ20å­—èŠ‚ï¼Œå³TLSè®°å½•é•¿åº¦å°äº20å­—èŠ‚ï¼‰ï¼Œåˆ™æœ€æ–°çš„OpenSSLç‰ˆæœ¬ä¼šå“åº”ä¸åŒçš„é”™è¯¯æ¶ˆæ¯ã€‚æˆ‘ä»¬å†³å®šä½¿ç”¨80ä¸ªå­—èŠ‚æ¥ä¸ºHMACè¾“å‡ºï¼ˆè¾“å‡ºä¸º20å­—èŠ‚ï¼‰åŠ ä¸Šä¸¤ä¸ªå®Œæ•´çš„å¡«å……å—æä¾›è¶³å¤Ÿçš„ç©ºé—´ã€‚è¿™å…è®¸æˆ‘ä»¬æ„é€ å—SHA-384ä¿æŠ¤çš„è®°å½•ï¼Œå…¶è¾“å‡ºé•¿åº¦ä¸º48å­—èŠ‚ã€‚ï¼ˆSHA-384çš„è¾“å‡ºä¸º48å­—èŠ‚ï¼‰</p>
<p>æˆ‘ä»¬åœ¨ä¸‹é¢çš„æ®µè½ä¸­æ€»ç»“äº†æˆ‘ä»¬çš„25æ¡æ ¼å¼é”™è¯¯è®°å½•ã€‚æœ‰å…³TLS_RSA_WITH_AES_128_CBC_SHAæƒ…å†µä¸‹è¿™äº›é”™è¯¯è®°å½•çš„æ‘˜è¦ï¼Œå¦è¯·å‚è§è¡¨1ã€‚</p>
<p><img src="/images/USS-2020-paper/Table-1.jpg" alt="Table-1ï¼šä¸ºTLS_RSA_WITH_AES_128_CBC_SHAæ„å»ºçš„æ ¼å¼é”™è¯¯è®°å½•çš„æ‘˜è¦ã€‚è¿™äº›åˆ—åˆ†åˆ«è¡¨ç¤ºMACå’Œå¡«å……å­—èŠ‚çš„é•¿åº¦ã€ä½ç½®å’Œä¿®æ”¹ã€‚âŠ•è¡¨ç¤ºå¯¹åˆ—è¡¨ä½ç½®ä¸­çš„åˆ—è¡¨å€¼è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚DELè¡¨ç¤ºåˆ é™¤åˆ—å‡ºä½ç½®ä¸­çš„ä¸€ä¸ªå­—èŠ‚ã€‚"></p>
<ul>
<li><p><strong>ç¿»è½¬çš„MACä½ï¼š</strong>æˆ‘ä»¬ä»åŒ…å«åº”ç”¨ç¨‹åºæ•°æ®ã€MACå’Œå››ä¸ªå¡«å……å­—èŠ‚çš„æœ‰æ•ˆè®°å½•å¼€å§‹ã€‚ï¼ˆåŸå§‹TLSè®°å½•ï¼‰ç„¶åï¼Œæˆ‘ä»¬æ ¹æ®è¯¥è®°å½•åˆ›å»ºâ€œä¸‰æ¡â€æ ¼å¼é”™è¯¯çš„è®°å½•ï¼šï¼ˆä¿®æ”¹åŸå§‹TLSè®°å½•å¾—åˆ°çš„3æ¡æ–°çš„æœ‰é”™è¯¯çš„TLSè®°å½•ï¼‰</p>
<ol>
<li><p>ä¸€æ¡æ˜¯é€šè¿‡ç¿»è½¬ç¬¬ä¸€ä¸ªMACå­—èŠ‚ä¸­çš„æœ€é«˜æœ‰æ•ˆä½ï¼Œ</p>
</li>
<li><p>ä¸€æ¡æ˜¯é€šè¿‡ç¿»è½¬MACå­—èŠ‚ä¸­é—´çš„ä¸­é—´ä½ï¼Œ</p>
</li>
<li><p>å¦ä¸€æ¡æ˜¯é€šè¿‡ç¿»è½¬æœ€åä¸€ä¸ªMACå­—èŠ‚çš„æœ€ä½æœ‰æ•ˆä½ã€‚</p>
</li>
</ol>
<p>æˆ‘ä»¬é€‰æ‹©è¿™äº›æ ¼å¼é”™è¯¯çš„è®°å½•æ¥æ£€æµ‹é‚£äº›æœªå®Œå…¨æ£€æŸ¥MACçš„å®ç°ã€‚æœ€è¿‘çš„OpenSSLæ¼æ´[1]ï¼Œå…¶ä¸­OpenSSLåªæ£€æŸ¥æŸäº›å¹³å°ä¸Šæ¯ä¸ªå­—èŠ‚çš„æœ€ä½æœ‰æ•ˆä½ï¼Œä»¥åŠæœªå®ŒæˆMACéªŒè¯å¯¼è‡´çš„è¿›ä¸€æ­¥æ¼æ´[29ï¼Œ28]ï¼Œå¯¼è‡´äº†ç‰¹å®šçš„ä½ç¿»è½¬ä½ç½®ã€‚</p>
</li>
<li><p><strong>ç¼ºå°‘ä¸€ä¸ªMACå­—èŠ‚ï¼š</strong>æˆ‘ä»¬ä»åŒ…å«ç©ºåº”ç”¨ç¨‹åºæ•°æ®ä½†å…·æœ‰æœ‰æ•ˆMACå’Œå¡«å……çš„æœ‰æ•ˆè®°å½•å¼€å§‹ã€‚ï¼ˆåŸå§‹è®°å½•ï¼‰ç„¶åï¼Œæˆ‘ä»¬ä¿®æ”¹å®ƒä»¥åˆ›å»ºä¸¤ä¸ªæ ¼å¼é”™è¯¯çš„è®°å½•ï¼šï¼ˆç”±åŸå§‹è®°å½•ä¿®æ”¹åçš„2ä¸ªé”™è¯¯è®°å½•ï¼‰</p>
<ol>
<li><p>ä¸€ä¸ªåˆ é™¤ç¬¬ä¸€ä¸ªMACå­—èŠ‚ï¼Œ</p>
</li>
<li><p>å¦ä¸€ä¸ªåˆ é™¤æœ€åä¸€ä¸ªMACå­—èŠ‚ã€‚</p>
</li>
</ol>
<p>ç„¶åï¼Œæˆ‘ä»¬åœ¨ä¸¤æ¡æ¶ˆæ¯ä¸­æ·»åŠ å¦ä¸€ä¸ªå¡«å……å­—èŠ‚ã€‚è¿™äº›æ ¼å¼é”™è¯¯çš„è®°å½•è¿˜å¯èƒ½è§¦å‘ç”±ä¸å®Œæ•´çš„MACéªŒè¯å¼•èµ·çš„æ¼æ´ï¼Œå¹¶ç”±[28]é—´æ¥æ¿€å‘ã€‚</p>
</li>
<li><p><strong>ç¼ºå°‘MACå­—èŠ‚éƒ¨åˆ†ï¼š</strong>å—[37]çš„å¯å‘ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªæ ¼å¼é”™è¯¯çš„è®°å½•ï¼Œå®ƒä»¬åªåŒ…å«å¡«å……ï¼Œè€Œæ ¹æœ¬ä¸åŒ…å«MACï¼šï¼ˆç”±åŸå§‹è®°å½•ä¿®æ”¹åçš„åˆ°çš„é”™è¯¯è®°å½•ï¼‰</p>
<ol>
<li><p>ä¸€ä¸ªæä¾›äº†æ°å¥½80å­—èŠ‚çš„æœ‰æ•ˆå¡«å……(0x4F)ï¼Œ</p>
</li>
<li><p>å¦ä¸€ä¸ªæä¾›äº†å€¼ä¸º0xFF80å­—èŠ‚çš„ä¸å®Œæ•´å¡«å……ã€‚</p>
</li>
</ol>
<p>è¿™ä¸ªé”™è¯¯è®°å½•ä¸ä»…ç¼ºå°‘MACï¼Œè€Œä¸”è¿˜åŒ…å«æ— æ•ˆçš„å¡«å……ï¼ˆå› ä¸ºå¦‚æœæœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼æ˜¯0xFFï¼Œåˆ™åº”è¯¥æœ‰256ä¸ªå¡«å……å­—èŠ‚ï¼‰</p>
</li>
<li><p><strong>ç»„åˆæœ‰æ•ˆå’Œæ— æ•ˆçš„MACå’Œå¡«å……ï¼š</strong>æœ€åä¸€ç»„æ ¼å¼é”™è¯¯çš„è®°å½•åŒ…å«ä¸‰ç§ç±»å‹çš„æœ‰æ•ˆå’Œæ— æ•ˆMACå’Œå¡«å……çš„ç»„åˆçš„æ¶ˆæ¯ï¼š</p>
<ol>
<li><p>æœ‰æ•ˆMACå’Œæ— æ•ˆå¡«å……ï¼ˆæœ‰3ä¸ªå­ç±»å‹ï¼‰</p>
</li>
<li><p>æ— æ•ˆMACå’Œæ— æ•ˆå¡«å……ï¼ˆæœ‰3ä¸ªå­ç±»å‹ï¼‰</p>
</li>
<li><p>æ— æ•ˆMACå’Œæœ‰æ•ˆå¡«å……ï¼ˆæœ‰3ä¸ªå­ç±»å‹ï¼‰</p>
</li>
</ol>
<p>å¯¹äºè¿™ä¸‰ç§ç±»å‹ä¸­çš„æ¯ä¸€ç§ï¼Œæˆ‘ä»¬éƒ½åˆ›å»ºäº†ä¸‰ä¸ªå­ç±»å‹ï¼Œå…·ä½“å–å†³äºæˆ‘ä»¬ç¿»è½¬çš„ä½ä½ç½®ï¼›</p>
<p>3ä¸ªå­ç±»å‹ï¼šæˆ‘ä»¬åˆ†åˆ«ç¿»è½¬ç¬¬ä¸€ä¸ªã€ä¸­é—´æˆ–ç¬¬16ä¸ªå­—èŠ‚ä¸­çš„æœ€é«˜æœ‰æ•ˆä½ã€ä¸­é—´ä½æˆ–æœ€ä½æœ‰æ•ˆä½ã€‚å¯¹äºè¿™ä¹ä¸ªå­ç±»å‹ä¸­çš„æ¯ä¸€ä¸ªï¼Œæˆ‘ä»¬åˆ†åˆ«åˆ›å»ºä¸€ä¸ªåŒ…å«åº”ç”¨ç¨‹åºæ•°æ®çš„ç‰ˆæœ¬å’Œä¸€ä¸ªä¸åŒ…å«åº”ç”¨ç¨‹åºæ•°æ®çš„ç‰ˆæœ¬ã€‚å…¶ä¸­é€‰æ‹©åº”ç”¨ç¨‹åºæ•°æ®çš„é•¿åº¦ï¼Œä½¿å¾—å¡«å……å­—èŠ‚åŒ…å«åœ¨ä¸€ä¸ªçº¯æ–‡æœ¬å—å†…ï¼Œè€Œæ²¡æœ‰åº”ç”¨ç¨‹åºæ•°æ®çš„æ ¼å¼é”™è¯¯çš„è®°å½•åŒ…å«å¤šäºä¸€ä¸ªå¡«å……å—ã€‚è¿™æ—¨åœ¨æ£€æµ‹åªæ£€æŸ¥æœ€åä¸€å—å¡«å……å­—èŠ‚çš„å®ç°ã€‚</p>
</li>
</ul>
<h3 id="å°†æ ¼å¼é”™è¯¯çš„è®°å½•ä¸åè®®ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ç»„åˆ"><a href="#å°†æ ¼å¼é”™è¯¯çš„è®°å½•ä¸åè®®ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ç»„åˆ" class="headerlink" title="å°†æ ¼å¼é”™è¯¯çš„è®°å½•ä¸åè®®ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ç»„åˆ"></a>å°†æ ¼å¼é”™è¯¯çš„è®°å½•ä¸åè®®ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ç»„åˆ</h3><p>æˆ‘ä»¬å°†æ¯ä¸ªæ ¼å¼é”™è¯¯çš„è®°å½•ä¸å‡ ä¸ªTLSåè®®ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ä¸€èµ·ä½¿ç”¨ã€‚å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ¯è¯­æµ‹è¯•å‘é‡æ¥æŒ‡ä»£æ ¼å¼é”™è¯¯çš„è®°å½•ã€åè®®ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶çš„ç»„åˆã€‚æ­£å¦‚æˆ‘ä»¬ç¨åæ‰€å±•ç¤ºçš„ï¼Œä½¿ç”¨ä¸åŒçš„åè®®ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶æµ‹è¯•æ¯ä¸ªæ ¼å¼é”™è¯¯çš„è®°å½•æ˜¯å¿…è¦çš„ï¼›æŸäº›æ¼æ´åªæœ‰åœ¨è¿™ç§ç‰¹å®šç»„åˆä¸‹æ‰ä¼šè¢«è§¦å‘ã€‚ä¹ä¸€çœ‹ï¼Œè¿™æ˜¯ä»¤äººæƒŠè®¶çš„ï¼Œä½†è¿™å®é™…ä¸Šéµå¾ªäº†[9]çš„å‘ç°ã€‚æˆ‘ä»¬æ¨æµ‹ï¼Œæ ¹æ®åå•†çš„ç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ï¼Œå®ç°å¯èƒ½ä½¿ç”¨å®Œå…¨ä¸åŒçš„ä»£ç æ ˆï¼Œè€ŒæŸäº›æ¼æ´åªå­˜åœ¨äºè¿™äº›ä»£ç æ ˆçš„ä¸€ä¸ªå­é›†ä¸­ã€‚</p>
<h2 id="ç»éªŒæ£€éªŒå‘é‡è§„çº¦"><a href="#ç»éªŒæ£€éªŒå‘é‡è§„çº¦" class="headerlink" title="ç»éªŒæ£€éªŒå‘é‡è§„çº¦"></a>ç»éªŒæ£€éªŒå‘é‡è§„çº¦</h2><p>æ ¹æ®æœåŠ¡å™¨çš„é…ç½®ï¼Œä¸Šé¢çš„æµ‹è¯•å‘é‡é›†åˆç›¸å½“å¤§ã€‚</p>
<p>1.ä¸ºä»€ä¹ˆé›†åˆå¤§ï¼šå‡è®¾ä¸€å°æ”¯æŒTLS 1.0å’ŒTLS 1.1çš„æœåŠ¡å™¨å…·æœ‰10ä¸ªCBCå¯†ç å¥—ä»¶ï¼Œé‚£ä¹ˆå°†æœ‰10Â·2Â·25=500ä¸ªæµ‹è¯•å‘é‡ã€‚ï¼ˆè¯·æ³¨æ„ï¼Œæ¯ä¸ªæµ‹è¯•å‘é‡éƒ½éœ€è¦å»ºç«‹æ–°çš„TLSè¿æ¥å¹¶æ‰§è¡Œæ˜‚è´µçš„æ¡æ‰‹ï¼‰</p>
<p>2.ä¸è¶³ä¹‹å¤„ï¼šå¦‚æ­¤å¤§é‡çš„æµ‹è¯•å‘é‡ä¸å…è®¸æˆ‘ä»¬æ‰§è¡Œå¤§è§„æ¨¡æ‰«æã€‚å¦ä¸€æ–¹é¢ï¼Œåˆ é™¤æµ‹è¯•å‘é‡å¯èƒ½ä¼šå¯¼è‡´æ¼æŠ¥å’Œæ¼æ‰æ¼æ´ã€‚ï¼ˆæ‰€ä»¥ä¸èƒ½è½»æ˜“åˆ é™¤æµ‹è¯•å‘é‡ï¼‰</p>
<p>3.è§£å†³åŠæ³•ï¼šï¼ˆæ–°æ–¹æ³•ï¼‰ä¸ºäº†åœ¨ä¸é™ä½æ£€æµ‹ç‡çš„å‰æä¸‹å‡å°‘æµ‹è¯•å‘é‡çš„æ•°é‡ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç»éªŒæµ‹è¯•å‘é‡çº¦ç®€æ–¹æ³•ã€‚</p>
<p>4.å®éªŒè¿‡ç¨‹ï¼šï¼ˆæ‰«æâ€”&gt;åˆ†æâ€”&gt;ç­›é€‰åˆ›å»ºï¼‰æˆ‘ä»¬æŠ½æ ·äº†50,000å°éšæœºä¸»æœºï¼Œå®ƒä»¬åœ¨ç«¯å£443ä¸Šå“åº”ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸Šè¿°25æ¡æ ¼å¼é”™è¯¯çš„è®°å½•ä»¥åŠæ‰€æœ‰æ”¯æŒçš„å¯†ç å¥—ä»¶å’ŒTLSç‰ˆæœ¬ç»„åˆå¯¹è¿™äº›ä¸»æœºæ‰§è¡Œå®Œå…¨æ‰«æã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ææˆ‘ä»¬çš„æµ‹è¯•å‘é‡ç»„åˆï¼Œå¹¶åˆ›å»ºæ£€æµ‹æ‰€æœ‰å¡«å……Oracleæ¼æ´çš„æœ€å°æµ‹è¯•å‘é‡é›†ã€‚è¿™äº›ç»éªŒæ­¥éª¤ç¡®ä¿äº†ï¼ˆä¸Šè¿°å®éªŒå’Œæ–¹æ³•çš„ä¼˜ç‚¹ï¼‰ï¼š</p>
<p>  1)æˆ‘ä»¬ä¸ä¼šé—æ¼æ¼æ´çš„æ¦‚ç‡å¾ˆé«˜</p>
<p>  2)æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çº¦ç®€é›†è¿›è¡Œå¤§è§„æ¨¡åˆ†æã€‚</p>
<h2 id="ç¾¤é›†æ¼æ´"><a href="#ç¾¤é›†æ¼æ´" class="headerlink" title="ç¾¤é›†æ¼æ´"></a>ç¾¤é›†æ¼æ´</h2><p>ä¸€æ—¦æˆ‘ä»¬å‡å°‘äº†æµ‹è¯•å‘é‡çš„æ•°é‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œå®Œå…¨æ‰«æã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨Interneté¡¶çº§åˆ—è¡¨ä¹‹ä¸€ï¼Œè¯¥åˆ—è¡¨é€šå¸¸åŒ…å«æœ€æ–°æœåŠ¡å™¨å®ç°çš„è‰¯å¥½æ··åˆã€‚åœ¨äº’è”ç½‘é¡¶çº§åˆ—è¡¨ä¸­ï¼ŒAlexa Top 100ä¸‡æ•°æ®é›†åŒ…å«å“åº”TLSè¿æ¥çš„ä¸»æœºæ•°é‡æœ€å¤š(çº¦75%)ï¼Œå»ºè®®ç”¨äºTLSæ‰«æ[36]ã€‚</p>
<p>åœ¨ä½¿ç”¨ç²¾ç®€å‘é‡é›†æ‰§è¡ŒTLSæ‰«æåï¼Œæˆ‘ä»¬åˆ›å»ºäº†æ˜“å—æ”»å‡»ä¸»æœºçš„åˆ—è¡¨ã€‚æˆ‘ä»¬ä½¿ç”¨å®Œæ•´çš„æµ‹è¯•è½½ä½“åˆ—è¡¨é‡æ–°æ‰«æè¿™äº›ä¸»æœºã€‚å…¶ä¸­ï¼šå¯¹äºæ¯å°ä¸»æœºï¼Œæˆ‘ä»¬éƒ½å­˜å‚¨å…¶å“åº”æ˜ å°„ã€‚å“åº”å›¾æè¿°äº†å“åº”æˆ‘ä»¬çš„æµ‹è¯•å‘é‡æ—¶çš„å®Œæ•´ä¸»æœºè¡Œä¸ºã€‚å“åº”æ˜ å°„ç”±å¯†ç å¥—ä»¶æŒ‡çº¹ç»„æˆã€‚å¯†ç å¥—ä»¶æŒ‡çº¹æè¿°ç‰¹å®šå¯†ç å¥—ä»¶å’ŒTLSç‰ˆæœ¬çš„æœåŠ¡å™¨å“åº”è¡Œä¸ºã€‚</p>
<p>æˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡ä¹‹ä¸€æ˜¯é€šçŸ¥æ˜“å—æ”»å‡»çš„ä¾›åº”å•†ã€‚ä¸ºæ­¤ï¼Œæœ‰å¿…è¦ä½¿ç”¨ç”Ÿæˆçš„å“åº”æ˜ å°„å¯¹æ˜“å—æ”»å‡»çš„ä¸»æœºè¿›è¡Œåˆ†ç»„ï¼Œå¹¶è”ç³»å…¶ç®¡ç†å‘˜ä»¥æ‰¾å‡ºæ˜“å—æ”»å‡»çš„å®æ–½ç‰ˆæœ¬ã€‚BÃ¶ckç­‰äººæ‰‹åŠ¨æ‰§è¡Œæ­¤æ­¥éª¤ï¼Œå¹¶èƒ½å¤Ÿä¸æœ€é‡è¦çš„ä¾›åº”å•†æ¥æ´½[9]ã€‚ç„¶è€Œï¼Œè¿™æ ·çš„æ–¹æ³•è´¹æ—¶è´¹åŠ›ä¸”å®¹æ˜“å‡ºé”™ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è‡ªåŠ¨å¯¹æ˜“å—æ”»å‡»çš„å®ç°è¿›è¡Œåˆ†ç»„ã€‚</p>
<p>å°½ç®¡åœ¨ç»™å®šæ‰€æœ‰å“åº”æ˜ å°„çš„æƒ…å†µä¸‹ï¼Œå¯¹æ˜“å—æ”»å‡»çš„ä¸»æœºè¿›è¡Œåˆ†ç»„ä¼¼ä¹å¾ˆå®¹æ˜“ï¼Œä½†å³ä½¿å®ƒä»¬ä½¿ç”¨ç›¸åŒçš„æ˜“å—æ”»å‡»çš„å®ç°ç‰ˆæœ¬ï¼Œå“åº”æ˜ å°„ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚è¿è¡Œç›¸åŒå®ç°çš„TLSæœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„é…ç½®ï¼Œä»è€Œå¯ç”¨ä¸åŒçš„å¯†ç å¥—ä»¶å’ŒTLSç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨Aå¯èƒ½å®¹æ˜“å—åˆ°å¡«å……Oracleçš„æ”»å‡»ï¼Œå¹¶ä¸”åªå¯ç”¨äº†ä¸€ä¸ªTLSå¯†ç å¥—ä»¶ï¼šTLS_RSA_WITH_AES_128_CBC_SHA256ã€‚æœåŠ¡å™¨Bä½¿ç”¨ç›¸åŒçš„å¯†ç å¥—ä»¶æŒ‡çº¹æ˜“å—æ”»å‡»ã€‚ä½†æ˜¯ï¼ŒæœåŠ¡å™¨Bä¹Ÿè¢«é…ç½®ä¸ºä½¿ç”¨ä¸å®¹æ˜“å—åˆ°æ”»å‡»çš„é™„åŠ å¯†ç å¥—ä»¶ã€‚è¿™ä¸¤å°æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„å®ç°è¿˜æ˜¯ç›¸ä¼¼çš„å®ç°ï¼Ÿä¸ºäº†ä¼°è®¡è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ç§åŸºäºäºŒç»´åŠ›æœ‰å‘å›¾ç»˜åˆ¶ç®—æ³•çš„æ–°æ–¹æ³•[21]ã€‚è¿™äº›ç®—æ³•åœ¨å¹³é¢ä¸ŠåµŒå…¥ä¸€ä¸ªèŠ‚ç‚¹ç½‘ç»œï¼Œå…è®¸åœ¨ç©ºé—´ä¸Šè§£é‡Šè¯¥ç½‘ç»œã€‚ä»–ä»¬é€šè¿‡åˆ›å»ºä¸€ä¸ªåŒ…å«å°½å¯èƒ½å°‘çš„äº¤å‰è¾¹çš„äºŒç»´å›¾æ¥å®ç°è¿™ä¸€ç‚¹ã€‚åœ¨æˆ‘ä»¬çš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ForceAtlas2ç®—æ³•[21]ï¼šForceAtlas2æ¨¡æ‹Ÿç‰©ç†ç³»ç»Ÿä»¥ä½¿ç½‘ç»œç©ºé—´åŒ–ã€‚èŠ‚ç‚¹åƒå¸¦ç”µç²’å­ä¸€æ ·ç›¸äº’é‡å¤è„‰å†²ï¼Œè€Œè¾¹ç¼˜åˆ™åƒå¼¹ç°§ä¸€æ ·å¸å¼•å®ƒä»¬çš„èŠ‚ç‚¹ã€‚è¿™äº›åŠ›é‡åˆ›é€ äº†ä¸€ç§æ±‡èšåˆ°å¹³è¡¡çŠ¶æ€çš„è¿åŠ¨ã€‚è¿™ä¸€æœ€ç»ˆé…ç½®é¢„è®¡å°†æœ‰åŠ©äºå¯¹æ•°æ®çš„è§£é‡Š[21]ã€‚</p>
<p>æˆ‘ä»¬å°†æ‰«æç»“æœè¡¨ç¤ºä¸ºå¦‚ä¸‹ï¼šå›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€å°ä¸»æœºã€‚å¦‚æœæ¯å¯¹ä¸»æœºçš„å“åº”æ˜ å°„ä¸åŒ…æ‹¬åŒä¸€å¯†ç å¥—ä»¶çš„ä¸åŒå¯†ç å¥—ä»¶æŒ‡çº¹ï¼Œåˆ™æ¯å¯¹ä¸»æœºç”±ä¸€æ¡è¾¹è¿æ¥ã€‚</p>
<p>è¿™ç§æ–¹æ³•åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸Šè¿è¡Œè‰¯å¥½ï¼Œè¡¨ç°å‡ºç±»ä¼¼æ¼æ´çš„æœåŠ¡å™¨è¢«ç´§å¯†åœ°åˆ†ç»„åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬é€šè¿‡æ ¹æ®èŠ‚ç‚¹çš„åº¦(å³å®ƒä»¬çš„è¾¹æ•°)ç»™èŠ‚ç‚¹ç€è‰²æ¥æ‰©å……å›¾ã€‚ç”±æ­¤äº§ç”Ÿçš„å¯è§†åŒ–è¡Œä¸ºå…è®¸è¯†åˆ«ç±»ä¼¼çš„å®ç°ã€‚æˆ‘ä»¬åœ¨ç¬¬å…«èŠ‚ï¼ˆFindingï¼‰ç»™å‡ºäº†å…·ä½“çš„ç»“æœã€‚</p>
<h1 id="äº”ã€å¤§è§„æ¨¡TLSæ‰«æ"><a href="#äº”ã€å¤§è§„æ¨¡TLSæ‰«æ" class="headerlink" title="äº”ã€å¤§è§„æ¨¡TLSæ‰«æ"></a>äº”ã€å¤§è§„æ¨¡TLSæ‰«æ</h1><p>æˆ‘ä»¬ä½¿ç”¨TLS- Attacker [37]å¼€å‘äº†Padding Oracleæµ‹è¯•å‘é‡ï¼ŒTLS- Attacker [37]æ˜¯å¯¹TLSå®ç°è¿›è¡Œç³»ç»Ÿåˆ†æçš„æ¡†æ¶ã€‚ TLS-Attackeræ”¯æŒåˆ›å»ºæ¶æ„TLSå·¥ä½œæµå’Œæ¶ˆæ¯æ ¼å¼é”™è¯¯ã€‚TLS-Attackerä¹‹å‰çš„å±€é™ï¼šTLS-Attackerå·²è¢«ç”¨äºæ£€æµ‹Padding Oracleæ”»å‡»ï¼Œä½†ä»…é’ˆå¯¹å®éªŒå®¤æ¡ä»¶ä¸‹çš„ç‰¹å®šå®ç°ï¼Œè€Œä¸æ˜¯å¤§è§„æ¨¡çš„ã€‚æˆ‘ä»¬åˆ›å»ºä¼˜åŒ–çš„æµ‹è¯•å‘é‡é›†çš„æ–¹æ³•ä»¥å‰æœªåŒ…å«åœ¨æ­¤æ¡†æ¶ä¸­ã€‚</p>
<h2 id="TLSæœå¯»å™¨"><a href="#TLSæœå¯»å™¨" class="headerlink" title="TLSæœå¯»å™¨"></a>TLSæœå¯»å™¨</h2><p>ä¸ºäº†æ‰«æå¤§é‡çš„ä¸»æœºï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªå¹¶è¡Œæ‰«æå¤šå°æœåŠ¡å™¨å¹¶å°†æ‰«æç»“æœå†™å…¥æ•°æ®åº“çš„æ¡†æ¶ã€‚è¿™å…è®¸æˆ‘ä»¬é€šè¿‡ä½¿ç”¨å¤šå°æœºå™¨æ¥å¹¶è¡Œæ‰«æã€‚è¯¥æ•°æ®åº“æä¾›äº†æ‰«ææ•°æ®çš„æŸ¥è¯¢æ¥å£ï¼Œè¿™ä½¿å¾—å¯¹å¤§å‹ç»“æœæ•°æ®é›†çš„åˆ†æå˜å¾—æ›´å®¹æ˜“ã€‚æˆ‘ä»¬ç§°æˆ‘ä»¬çš„æ¡†æ¶ä¸ºTLS-Crawlerã€‚</p>
<p>TLS-Crawleråˆ†ä¸ºä¸€ä¸ªæ§åˆ¶å™¨å®ä¾‹ï¼ˆDirectorå®ä¾‹ï¼‰å’Œå¯èƒ½çš„å¤šä¸ªå·¥ä½œå®ä¾‹ï¼ˆWorkerå®ä¾‹ï¼‰ã€‚</p>
<ol>
<li><p>å·¥ä½œå®ä¾‹ï¼ˆWorkerå®ä¾‹ï¼‰ï¼šWorkerå®ä¾‹é€ä¸ªæ‰§è¡Œå®é™…çš„TLSä¸»æœºæ‰«æã€‚æ¯ä¸ªWorkerå®ä¾‹éƒ½å®ç°äº†ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè¯¥æ± è·¨å¯ç”¨çº¿ç¨‹åˆ†é…æ‰«æå·¥ä½œã€‚ç„¶åï¼Œè¯¥å®ä¾‹å°†ç»“æœæ†ç»‘åœ¨ä¸€èµ·ï¼Œå¹¶åè°ƒå¹¶è¡ŒåŒ–çš„æ•°æ®åº“è®¿é—®ã€‚</p>
</li>
<li><p>æ§åˆ¶å™¨å®ä¾‹ï¼ˆDirectorå®ä¾‹ï¼‰ï¼šæ§åˆ¶å™¨å®ä¾‹åè°ƒå·¥ä½œå®ä¾‹ã€‚Directorå®ä¾‹åŒ…å«ä¸€ä¸ªåè°ƒæä¾›ç¨‹åºï¼Œè´Ÿè´£åè°ƒå’Œåˆ†é…å·¥ä½œäººå‘˜ä¹‹é—´çš„æ‰«æä»»åŠ¡ã€‚ä½¿ç”¨æŒä¹…æ€§æä¾›ç¨‹åºå°†ç»“æœæŒä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚æˆ‘ä»¬ä½¿ç”¨MongoDBä½œä¸ºæŒä¹…åŒ–æä¾›è€…ï¼Œå¹¶é€šè¿‡Redisé˜Ÿåˆ—ç¼–æ’å®ä¾‹ã€‚</p>
</li>
</ol>
<p>å›¾2å¯è§†åŒ–äº†TLS-Crawleræ¶æ„ã€‚</p>
<p><img src="/images/USS-2020-paper/Figure-2.jpg" alt="Figure-2ï¼šæˆ‘ä»¬çš„TLSæ‰«æåŸºç¡€è®¾æ–½åŸºäºç”¨äºæ•°æ®æŒä¹…æ€§çš„æˆç†Ÿç»„ä»¶å’Œç”¨äºæ‰§è¡ŒTLSè¯„ä¼°çš„TLS-Attackerã€‚"></p>
<h2 id="æ‰§è¡ŒTLSæ‰«æ"><a href="#æ‰§è¡ŒTLSæ‰«æ" class="headerlink" title="æ‰§è¡ŒTLSæ‰«æ"></a>æ‰§è¡ŒTLSæ‰«æ</h2><p>åœ¨ä½¿ç”¨æµ‹è¯•å‘é‡æ‰«ææ¯å°ä¸»æœºä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šæ‰§è¡Œç®€çŸ­æ‰«æï¼Œä»¥äº†è§£ä¸»æœºæ”¯æŒçš„CBCå¯†ç å¥—ä»¶å’ŒTLSåè®®ç‰ˆæœ¬ã€‚æˆ‘ä»¬å°†å¯¼å‡ºå’ŒåŒ¿åå¯†ç å¥—ä»¶æ’é™¤åœ¨è¿™äº›æµ‹è¯•ä¹‹å¤–ï¼Œå› ä¸ºå®ƒä»¬å·²ç»è¢«MITMï¼ˆä¸­é—´äººæ”»å‡»ï¼‰æ”»å‡»è€…è½»æ˜“ç ´è§£ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨é’ˆå¯¹æ¯ä¸ªCBCå¯†ç å¥—ä»¶åŠå…¶æ”¯æŒçš„åè®®ç‰ˆæœ¬çš„ä¸€ç»„æµ‹è¯•å‘é‡æ¥æ‰§è¡Œæ‰«æã€‚</p>
<p>ä»¥å‰çš„å¤§è§„æ¨¡TLSæ‰«æä¸»è¦é›†ä¸­åœ¨TLSæ¡æ‰‹ä¸­çš„æ¼æ´[9ï¼Œ2]ã€è¯ä¹¦[19]ï¼Œæˆ–è€…åœ¨TLSæ¡æ‰‹æˆåŠŸä¹‹å‰å¯èƒ½è§¦å‘çš„æ¼æ´[17]ã€‚è¿™äº›ä»¥å‰çš„æ‰«æåªéœ€è¦æˆåŠŸæ¡æ‰‹ä¸€æ¬¡ï¼Œé€šå¸¸ä½¿ç”¨é€šå¸¸æ”¯æŒçš„å¯†ç å¥—ä»¶ã€‚ç›¸åï¼Œä¸ºäº†æµ‹è¯•Padding Oracleæ¼æ´ï¼Œæœ‰å¿…è¦å¯¹æ¯ä¸ªæµ‹è¯•çš„å¯†ç å¥—ä»¶æ‰§è¡Œå®Œæ•´çš„TLSæ¡æ‰‹ã€‚è¿™ä¸€ç‚¹ç”±äºTLSå®ç°è¡¨ç°å‡ºå®¹å¿[7]è€Œå˜å¾—å¤æ‚ï¼Œè¿™å¯èƒ½ä¼šé˜»æ­¢æœåŠ¡å™¨å®ŒæˆTLSæ¡æ‰‹ï¼Œç”šè‡³ä¸èƒ½å“åº”åˆå§‹çš„ClientHelloæ¶ˆæ¯ã€‚æˆ‘ä»¬è¯•å›¾å°†è¿™äº›å®¹å¿åº¦å¯¹æ‰«æçš„å½±å“é™åˆ°æœ€ä½ï¼Œä½†20%çš„æœåŠ¡å™¨è¡¨ç°å‡ºè¶³å¤Ÿçš„å®¹å¿åº¦ï¼Œä»¥è‡³äºæˆ‘ä»¬æ— æ³•æœ‰æ•ˆåœ°æ‰«æå®ƒä»¬ã€‚</p>
<p>å³ä½¿å®Œæˆäº†TLSæ¡æ‰‹ï¼Œä¹Ÿä¸èƒ½ä¿è¯æˆ‘ä»¬å¯ä»¥æœ‰æ•ˆåœ°æ‰«æä¸»æœºã€‚ä¾‹å¦‚ï¼Œåœ¨æŸäº›æµ‹è¯•ä¸­ï¼Œç›®æ ‡ä¸»æœºä¼šæš‚æ—¶åœæ­¢å“åº”å‡ ç§’é’Ÿã€‚è¿™å¾ˆå¯èƒ½æ˜¯å› ä¸ºä½œä¸ºæ‹’ç»æœåŠ¡é˜²å¾¡çš„ä¸€éƒ¨åˆ†ï¼ŒæœåŠ¡å™¨å´©æºƒæˆ–é˜»æ­¢äº†æˆ‘ä»¬çš„è¯·æ±‚ã€‚ä¸ºäº†é¿å…æ­¤ç±»æ‰«æçš„æ¼æŠ¥ï¼Œæˆ‘ä»¬å¹¶è¡Œæ‰«æå¤šå°ä¸»æœº(æœ€å¤š2000å°)ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰ä¸»æœºè¢«æˆ‘ä»¬çš„è¯·æ±‚è¶…è½½ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨æ‰«æå…·æœ‰ä¸¤ä¸ªå¯†ç å¥—ä»¶/ç‰ˆæœ¬å¯¹çš„ä¸»æœºä¹‹é—´è‡³å°‘ç­‰å¾…10ç§’ï¼Œè¿›ä¸€æ­¥é™åˆ¶äº†æ‰«æçš„ä¸»æœºä¸Šçš„è´Ÿè½½ã€‚</p>
<p>æ‰§è¡Œè¿™äº›æ‰«ææ—¶ï¼Œé€‰æ‹©é€‚å½“çš„è¶…æ—¶éå¸¸é‡è¦ã€‚å¦‚æœè¶…æ—¶æ—¶é—´å¤ªçŸ­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå› ä¸ºæœåŠ¡å™¨è´Ÿè½½è¿‡é«˜è€Œé”™è¿‡å“åº”ã€‚ç›¸åï¼Œè¾ƒé«˜çš„è¶…æ—¶å€¼ä¼šé™ä½æ‰«ææ€§èƒ½ã€‚è®¾ç½®è¾ƒé«˜çš„è¶…æ—¶å€¼è¿˜æ„å‘³ç€æˆ‘ä»¬ä¸å†åŒºåˆ†ç«‹å³å…³é—­è¿æ¥çš„æœåŠ¡å™¨å’Œéœ€è¦æ˜æ˜¾æ—¶é—´æ¥æ¢å¤å’Œå…³é—­è¿æ¥çš„æœåŠ¡å™¨ã€‚æ­¤å¤–ï¼ŒæœåŠ¡å™¨çš„ç­”æ¡ˆå¯èƒ½è·¨è¶Šå¤šä¸ªTCPæ•°æ®åŒ…ï¼Œå› æ­¤æ²¡æœ‰ç®€å•çš„æ–¹æ³•æ¥ç¡®å®šæ‰«æä»ªåœ¨ä»»ä½•æ—¶é—´ç‚¹éƒ½æ”¶åˆ°äº†æœåŠ¡å™¨çš„å®Œæ•´ç­”æ¡ˆã€‚(æŸäº›å“åº”ä¸åŒ…æ‹¬TCP RSTæˆ–FINæ•°æ®åŒ…ã€‚)ã€‚æˆ‘ä»¬æ ¹æ®ç»éªŒç¡®å®šï¼Œä¸€ç§’çš„è¶…æ—¶åœ¨å®è·µä¸­æ•ˆæœå¾ˆå¥½ï¼Œå¹¶ä¸”åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¿è¯äº†æœåŠ¡å™¨ç¡®å®æœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥å¤„ç†æˆ‘ä»¬çš„è®°å½•å’Œå“åº”ã€‚ç„¶è€Œï¼Œå³ä½¿åœ¨ä½¿ç”¨æ­¤è¶…æ—¶å€¼æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°æœåŠ¡å™¨ç”±äºé«˜è´Ÿè½½æˆ–å„ç§é”™è¯¯è€Œåšå‡ºä¸ç¡®å®šçš„å“åº”ã€‚</p>
<p>ä¸ºäº†è§£å†³ä¸ç¡®å®šæ€§å“åº”ï¼Œæˆ‘ä»¬é‡æ–°æ‰«æäº†æ¯ä¸ªå¯ç–‘æ¼æ´ï¼Œä»¥é¿å…è¯¯æŠ¥ã€‚åªæœ‰å½“ä¸€å°æœåŠ¡å™¨åœ¨ä¸‰æ¬¡å•ç‹¬çš„æ‰«æä¸­å¯¹æˆ‘ä»¬çš„æ¯ä¸ªæµ‹è¯•å‘é‡åšå‡ºç›¸åŒçš„å“åº”æ—¶ï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºå®ƒæ˜¯æ˜“å—æ”»å‡»çš„ã€‚</p>
<h1 id="å…­ã€è¯„ä¼°"><a href="#å…­ã€è¯„ä¼°" class="headerlink" title="å…­ã€è¯„ä¼°"></a>å…­ã€è¯„ä¼°</h1><p>å¯¹äºæ‰«æï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€å°å…·æœ‰2ä¸ªXeon E5-2683v5 CPUï¼ˆæ€»å…±64ä¸ªå†…æ ¸ï¼‰å’Œ48 GB RAMçš„è®¡ç®—æœºã€‚ æ‰«æå¹³å‡ä½¿ç”¨5Mbit / sçš„ä¸Šæ¸¸æ•°æ®å’Œ15Mbit / sçš„ä¸‹æ¸¸æ•°æ®ã€‚</p>
<h2 id="å¯¹æ‰€æœ‰æ ¼å¼é”™è¯¯çš„è®°å½•è¿›è¡Œé¢„æ‰«æ"><a href="#å¯¹æ‰€æœ‰æ ¼å¼é”™è¯¯çš„è®°å½•è¿›è¡Œé¢„æ‰«æ" class="headerlink" title="å¯¹æ‰€æœ‰æ ¼å¼é”™è¯¯çš„è®°å½•è¿›è¡Œé¢„æ‰«æ"></a>å¯¹æ‰€æœ‰æ ¼å¼é”™è¯¯çš„è®°å½•è¿›è¡Œé¢„æ‰«æ</h2><p>æˆ‘ä»¬å¯¹50,000å°éšæœºTLSä¸»æœºæ‰§è¡Œäº†åˆæ­¥æ‰«æï¼Œæ—¨åœ¨å‡å°‘æ ¼å¼é”™è¯¯çš„è®°å½•é›†ã€‚æ‰«æå‘ç”Ÿåœ¨2018å¹´10æœˆï¼Œéœ€è¦ä¸‰å¤©æ—¶é—´ã€‚ç»“æœè¯å®ï¼Œå¯†é’¥äº¤æ¢ç®—æ³•å’Œåè®®ç‰ˆæœ¬çš„é€‰æ‹©ç¡®å®ä¼šå½±å“ç»™å®šä¸»æœºæ˜¯å¦å­˜åœ¨CBC Padding Oracleæ¼æ´ã€‚ç„¶åï¼Œæˆ‘ä»¬å‡å°‘äº†è¿™ç»„ç•¸å½¢è®°å½•ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆç¡®å®šäº†æ‰€æœ‰æ˜“å—æ”»å‡»çš„ä¸»æœºï¼Œå³åœ¨æ‰«æå…¨éƒ¨æ ¼å¼é”™è¯¯çš„è®°å½•æ—¶å°†è¢«è¯†åˆ«çš„ä¸»æœºã€‚ç„¶åï¼Œæˆ‘ä»¬æ£€æŸ¥äº†å¤§å°ä¸æ–­å¢åŠ çš„é”™è¯¯è®°å½•çš„å­é›†ï¼Œå¹¶é’ˆå¯¹æ¯ä¸ªå­é›†æ£€æŸ¥äº†ä»…ä½¿ç”¨è¯¥é”™è¯¯è®°å½•å­é›†æ‰«ææ—¶å¯ä»¥è¯†åˆ«çš„ä¸»æœºæ•°é‡ã€‚å½“å››æ¡é”™è¯¯è®°å½•çš„å­é›†è¯†åˆ«å‡ºæ‰€æœ‰æ˜“å—æ”»å‡»çš„ä¸»æœºæ—¶ï¼Œæ­¤è¿‡ç¨‹åœæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½¿ç”¨å®Œæ•´çš„æ ¼å¼é”™è¯¯è®°å½•é›†æ‰«ææ—¶ï¼Œå°†æ ‡è¯†çš„æ‰€æœ‰ä¸»æœºä¹Ÿå°†åœ¨ä½¿ç”¨å‡å°‘çš„æ ¼å¼é”™è¯¯è®°å½•é›†æ‰«ææ—¶è¢«æ ‡è¯†ã€‚æ­¤ç¼©å‡é›†åˆåŒ…æ‹¬ä»¥ä¸‹æ ¼å¼é”™è¯¯çš„è®°å½•(æ‰€æœ‰è¿™äº›è®°å½•çš„é•¿åº¦å‡ä¸º80å­—èŠ‚)ï¼š</p>
<ol>
<li><p>ç¼ºå°‘MACå’Œæ­£ç¡®å¡«å……çš„è®°å½•(å€¼ä¸º0x4F)ã€‚</p>
</li>
<li><p>ç¼ºå°‘MACä¸”å¡«å……é”™è¯¯çš„è®°å½•(å€¼ä¸º0xFF)ã€‚</p>
</li>
<li><p>æ— ç”³è¯·æ•°æ®ã€å¡«å……æ— æ•ˆã€MACæœ‰æ•ˆçš„ç©ºè®°å½•ã€‚ç¿»è½¬ç¬¬ä¸€å¡«å……å­—èŠ‚ä¸­çš„æœ€é«˜ä½ã€‚</p>
</li>
<li><p>æ²¡æœ‰åº”ç”¨æ•°æ®çš„ç©ºè®°å½•ï¼Œå¡«å……æœ‰æ•ˆï¼ŒMACæ— æ•ˆã€‚ç¬¬ä¸€ä¸ªMACå­—èŠ‚ä¸­çš„æœ€ä½ä½è¢«ç¿»è½¬ã€‚</p>
</li>
</ol>
<p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä»ç„¶ä½¿ç”¨æ‰€æœ‰æ”¯æŒçš„å¯†ç å¥—ä»¶å’ŒTLSåè®®ç‰ˆæœ¬æµ‹è¯•æ¯å°TLSä¸»æœºã€‚</p>
<ul>
<li><strong>æ ¼å¼é”™è¯¯çš„è®°å½•é›†ç¼©å‡æ˜¯å¦æœ‰æŸï¼Ÿ</strong>ç¼©å°çš„æ ¼å¼é”™è¯¯è®°å½•é›†åœ¨åˆæ­¥æ‰«æçš„æ ·æœ¬æ•°æ®ä¸Šæ£€æµ‹ç”±è¾ƒå¤§çš„åŸå§‹æ ¼å¼é”™è¯¯è®°å½•é›†æ£€æµ‹åˆ°çš„æ‰€æœ‰æ¼æ´ã€‚è‡ªç„¶ä¼šè¯¢é—®æ˜¯å¦å­˜åœ¨æ˜“å—åŸå§‹é›†åˆä¸­çš„é”™è¯¯è®°å½•æ”»å‡»çš„ä¸»æœºï¼Œä½†ä¸å­˜åœ¨æ˜“å—ç²¾ç®€é›†åˆä¸­çš„é”™è¯¯è®°å½•æ”»å‡»çš„ä¸»æœºã€‚åœ¨æ ·æœ¬æ•°æ®ä¸­æ˜¾ç„¶æ²¡æœ‰è¿™æ ·çš„ä¸»æœºï¼Œä½†æ˜¯åœ¨æ ·æœ¬ä¹‹å¤–å¯èƒ½æœ‰è¿™æ ·çš„ä¸»æœºã€‚å¦‚æœInternetä¸Šæœ‰å¤§é‡è¿™æ ·çš„ä¸»æœºï¼Œåˆ™é”™è¯¯è®°å½•å‡å°‘è¿‡ç¨‹å°†æ˜¯æœ‰æŸå¤±çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ä½¿ç”¨è¾ƒå°‘çš„é”™è¯¯è®°å½•ï¼Œæˆ‘ä»¬åœ¨å®Œæ•´æ‰«æä¸­æ£€æµ‹åˆ°çš„æ¼æ´è¾ƒå°‘ã€‚æ­£å¦‚æˆ‘ä»¬ç°åœ¨è§£é‡Šçš„é‚£æ ·ï¼Œè¿™ç§æ‰«æä¸ç²¾ç¡®åº¦çš„æ¥æºå¯èƒ½è¶³å¤Ÿå°ï¼Œä¸ä¼šå¯¹æˆ‘ä»¬çš„ç»“æœäº§ç”Ÿå®è´¨æ€§å½±å“ã€‚æ¢å¥è¯è¯´ï¼Œå‡å°‘çš„æ ¼å¼é”™è¯¯è®°å½•é›†å¯èƒ½ä¼šæ£€æµ‹åˆ°ç”±æ•´ä¸ªæ ¼å¼é”™è¯¯è®°å½•é›†è§¦å‘çš„å¤§å¤šæ•°æ¼æ´ï¼Œè€Œä¸ä»…ä»…æ˜¯æ ·æœ¬æ•°æ®ã€‚</li>
</ul>
<p>å®é™…ä¸Šï¼Œè®©pè¡¨ç¤ºåœ¨æ‰€æœ‰è®²TLSçš„ä¸»æœºä¸­ï¼Œæ˜“å—æ¥è‡ªå…¨éƒ¨é”™è¯¯è®°å½•é›†åˆä¸­çš„ä¸€ä¸ªé”™è¯¯è®°å½•çš„å½±å“çš„ä¸»æœºçš„ç™¾åˆ†æ¯”ï¼Œè€Œä¸æ˜¯æ˜“å—æ¥è‡ªç²¾ç®€é›†åˆçš„ä»»ä½•é”™è¯¯è®°å½•çš„å½±å“çš„ç™¾åˆ†æ¯”ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œpæè¿°äº†ç¼©å‡é—æ¼çš„ä¸»æœºç™¾åˆ†æ¯”ï¼›æˆ‘ä»¬ç°åœ¨å°†æ˜¾ç¤ºå®ƒç›¸å½“å°ã€‚åœ¨ç”¨äºåˆæ­¥æ‰«æçš„N=50000å°ä¸»æœºçš„éšæœºæ ·æœ¬ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰é‡åˆ°ä»»ä½•æ­¤ç±»ä¸»æœºã€‚<br>ä¸ºäº†è®¡ç®—99%çš„ç½®ä¿¡åŒºé—´ï¼Œæˆ‘ä»¬éœ€è¦(1âˆ’p)^N=0.01.ã€‚æ±‚è§£pï¼Œæˆ‘ä»¬å¾—åˆ°p=0.0092%ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä»¥99%çš„æŠŠæ¡ç¡®å®šï¼Œç”±äºé”™è¯¯è®°å½•å‡å°‘ï¼Œæˆ‘ä»¬çš„æ‰«ææœ€å¤šä¼šé—æ¼0.0092%çš„å…¶ä»–æ˜“å—æ”»å‡»çš„ä¸»æœºã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿è¯»è€…ï¼Œæˆ‘ä»¬å¯¹ä»¥ä¸Šå†…å®¹è¿›è¡Œäº†ç›´è§‚çš„è§£é‡Šã€‚æ ¹æ®ä¸Šé¢çš„è®¡ç®—ï¼Œæˆ‘ä»¬ä¼°è®¡ç”±äºä½¿ç”¨å‡å°‘çš„æ ¼å¼é”™è¯¯è®°å½•é›†è¿›è¡Œæ‰«æè€Œæ¼æ‰çš„Internetä¸Šæ˜“å—æ”»å‡»ä¸»æœºçš„ç™¾åˆ†æ¯”ä¸º0.0092%ã€‚Censys[16]ä¼°è®¡ï¼Œæˆªè‡³2019å¹´2æœˆï¼Œå¤§çº¦æœ‰4240ä¸‡å°ä¸»æœºåœ¨ç«¯å£443ä¸Šä¸ºTLSæä¾›æœåŠ¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼°è®¡å‡å°‘æœ€å¤šä¼šä¸¢å¤±42400000å°Â·0.0092%=3,900å°ä¸»æœºã€‚ç›´è§‚åœ°è®²ï¼Œâ€œ99%å¯ä¿¡åŒºé—´â€è¿™ä¸ªæœ¯è¯­çš„æ„æ€æ˜¯è¿™ä¸ªä¼°è®¡é”™è¯¯çš„å¯èƒ½æ€§å¤§çº¦æ˜¯1%ï¼Œå³äº’è”ç½‘ä¸Šæœ‰è¶…è¿‡3900ä¸ªè¿™æ ·çš„ä¸»æœºã€‚</p>
<h2 id="Alexa-Top-100ä¸‡æ‰«æ"><a href="#Alexa-Top-100ä¸‡æ‰«æ" class="headerlink" title="Alexa Top 100ä¸‡æ‰«æ"></a>Alexa Top 100ä¸‡æ‰«æ</h2><p>æˆ‘ä»¬ä½¿ç”¨å‡å°‘çš„ç•¸å½¢è®°å½•é›†æ‰«æAlexa TOPç™¾ä¸‡ç½‘ç«™ã€‚åœ¨æ’åé å‰çš„åˆ—è¡¨ä¸­ï¼ŒAlexa Top 100ä¸‡æä¾›æ”¯æŒTLSçš„ä¸»æœºç™¾åˆ†æ¯”æœ€é«˜[36]ï¼Œå› æ­¤é€‚åˆå¤§è§„æ¨¡TLSæ‰«æã€‚è¯¥åˆ—è¡¨å¯èƒ½åŒ…æ‹¬å¤§å¤šæ•°å¤‡å—ç©ç›®çš„TLSå®ç°ã€‚</p>
<p>æ‰«æå¤§çº¦éœ€è¦72å°æ—¶ã€‚åœ¨æœ€åˆçš„100ä¸‡å°ä¸»æœºä¸­ï¼Œ785,295å°ä¸»æœºåœ¨ç«¯å£443ä¸Šå“åº”ã€‚æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨CBCå¯†ç å¥—ä»¶ä¸627,493å°ä¸»æœºè¿›è¡ŒTLSæ¡æ‰‹ã€‚æˆ‘ä»¬å°†æ‰€æœ‰å…¶ä»–ä¸œé“ä¸»æ’é™¤åœ¨è¯„ä¼°ä¹‹å¤–ã€‚æˆ‘ä»¬å‘ç°æ€»å…±æœ‰18,257å°Alexa Top Millionä¸»æœº(1.83%)å®¹æ˜“å—åˆ°Padding Oracleæ”»å‡»ã€‚</p>
<p>è¿™äº›æ•°æ®æ”¯æŒæˆ‘ä»¬çš„çŒœæƒ³ï¼Œå³åœ¨å…·æœ‰ä¸€ä¸ªåè®®ç‰ˆæœ¬çš„å¯†ç å¥—ä»¶ä¸Šå®ç°å¯èƒ½æ˜“å—æ”»å‡»ï¼Œè€Œåœ¨å…·æœ‰ä¸åŒåè®®ç‰ˆæœ¬çš„åŒä¸€å¯†ç å¥—ä»¶ä¸Šä¸å—æ”»å‡»ã€‚å…±æœ‰649å°æœåŠ¡å™¨ä»…åœ¨TLS 1.0æˆ–TLS 1.1/1.2ä¸­æ˜“å—æ”»å‡»ï¼Œå°½ç®¡å…¶ä»–ç‰ˆæœ¬æ”¯æŒæ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶ã€‚åŒæ ·ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåå•†çš„å¯†é’¥äº¤æ¢ç®—æ³•ä¼šå½±å“å®ç°æ˜¯å¦æ˜¾ç¤ºCBCæ¼æ´ã€‚601ä¸»æœºåœ¨ä¸€ä¸ªå¯†ç å¥—ä»¶ä¸Šæ˜“å—æ”»å‡»ï¼Œä½†åœ¨ä½¿ç”¨ä¸åŒå¯†é’¥äº¤æ¢ç®—æ³•ä½†ä½¿ç”¨ç›¸åŒå¯¹ç§°å¯†ç å’ŒHMACå‡½æ•°çš„å¦ä¸€ä¸ªå¯†ç å¥—ä»¶ä¸Šä¸å—æ”»å‡»ã€‚å…±æœ‰3247å°ä¸»æœºåœ¨å®ƒä»¬æ”¯æŒçš„æ‰€æœ‰CBCå¯†ç å¥—ä»¶ä¸Šæ˜“å—æ”»å‡»ã€‚</p>
<p>è¯†åˆ«å‡ºæ˜“å—æ”»å‡»çš„ä¸»æœºåï¼Œæˆ‘ä»¬ä½¿ç”¨å…¨å¥—æµ‹è¯•å‘é‡é‡æ–°æ‰«æå®ƒä»¬ï¼Œä»¥è·å¾—å®ƒä»¬çš„å®Œæ•´å“åº”å›¾ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œè¦å°†ä¸»æœºæ ‡è®°ä¸ºæ˜“å—æ”»å‡»çš„ä¸»æœºï¼Œæˆ‘ä»¬è¦æ±‚å“åº”æ˜ å°„åœ¨ä¸‰æ¬¡ä¸åŒæ‰«æä¸­ä¿æŒä¸€è‡´ã€‚</p>
<h2 id="æˆ‘ä»¬èšç±»æ–¹æ³•çš„ç»“æœ"><a href="#æˆ‘ä»¬èšç±»æ–¹æ³•çš„ç»“æœ" class="headerlink" title="æˆ‘ä»¬èšç±»æ–¹æ³•çš„ç»“æœ"></a>æˆ‘ä»¬èšç±»æ–¹æ³•çš„ç»“æœ</h2><p>æ‰‹åŠ¨åˆ†ææ¯å°æ˜“å—æ”»å‡»çš„ä¸»æœºæ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†æ˜“å—æ”»å‡»çš„ä¸»æœºèšé›†åœ¨ä¸€èµ·ï¼Œä»¥ä¾¿æ˜¾ç¤ºç›¸åŒå¯†ç å¥—ä»¶æŒ‡çº¹çš„ä¸»æœºèšé›†åœ¨ä¸€èµ·ã€‚è¿™æœ€å¤§é™åº¦åœ°å‡å°‘äº†ç¡®å®šå¯¹æ¯ä¸ªæ˜“å—æ”»å‡»çš„è¡Œä¸ºè´Ÿè´£çš„ä¾›åº”å•†(æˆ–å¤šä¸ªä¾›åº”å•†)æ‰€éœ€çš„æ‰‹åŠ¨å·¥ä½œã€‚æˆ‘ä»¬é‡ç”³ï¼Œæ­£å¦‚ç¬¬4.3èŠ‚æ‰€è§£é‡Šçš„é‚£æ ·ï¼Œè¿™ç§é›†ç¾¤ä¸æ˜¯å¾®ä¸è¶³é“çš„ã€‚</p>
<p>æˆ‘ä»¬è¯†åˆ«äº†93ä¸ªä¸åŒçš„å¯†ç å¥—ä»¶æŒ‡çº¹ã€‚è¡¨2æ€»ç»“äº†40ç§æœ€å¸¸è§çš„å¯†ç å¥—ä»¶æŒ‡çº¹ã€‚<br>ä»¥ç¬¬ä¸€è¡Œä¸ºä¾‹ï¼Œ7297å°ä¸»æœºä»¥BAD_RECORD_MACå’ŒCLOSE_NOTIFY TLSè­¦æŠ¥å“åº”ï¼Œå¹¶ä½¿æ ¼å¼é”™è¯¯çš„è®°å½•11å’Œ12çš„è¿æ¥è¶…æ—¶ã€‚å¯¹äºæ‰€æœ‰å…¶ä»–æ ¼å¼é”™è¯¯çš„è®°å½•ï¼Œè¿™äº›ä¸»æœºå…³é—­äº†TCPè¿æ¥ã€‚åœ¨å‘é€ç›¸åŒçš„TLSè­¦æŠ¥ä¹‹åã€‚</p>
<p>æˆ‘ä»¬è¿˜ç¡®å®šäº†å››ç»„è¡¨ç°å‡ºä¸OpenSSL[37]ä¸­çš„CVE-2016-2107æ¼æ´ç±»ä¼¼çš„è¡Œä¸º(è¡¨2ä¸­çš„å¯†ç å¥—ä»¶æŒ‡çº¹#41ã€#75ã€#14å’Œ#54)ã€‚å®ƒä»¬ä»¥RECORD_OVERFLOW TLSè­¦æŠ¥å“åº”æ ¼å¼é”™è¯¯çš„è®°å½•6å’Œ7(å‚è§è¡¨1)ã€‚å¯¹äºæ‰€æœ‰å…¶ä»–æ ¼å¼é”™è¯¯çš„è®°å½•ï¼Œå®ƒä»¬ä»¥BAD_RECORD_MACå“åº”ã€‚è¿™äº›å¯èƒ½æ˜¯æœªæ‰“è¡¥ä¸çš„OpenSSLå®ç°ï¼Œæˆ–è€…æ˜¯è¿è¡Œè¾ƒæ—§OpenSSLç‰ˆæœ¬çš„å®‰å…¨è®¾å¤‡ã€‚</p>
<p><img src="/images/USS-2020-paper/Table-2.jpg" alt="Table-2"></p>
<p><img src="/images/USS-2020-paper/Table-2-exp.jpg" alt="Table-2ä¸­çš„ç¬¦å·è§£é‡Š"></p>
<p>å¯¹äºåŒä¸€ä¸»æœºä¸Šæ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶ï¼Œå¯†ç å¥—ä»¶æŒ‡çº¹åŸºæœ¬ä¸€è‡´ã€‚åœ¨è¡¨ç°å‡ºè‡³å°‘ä¸€ä¸ªæ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶çš„ä¸»æœºä¸­ï¼Œ99.6%çš„ä¸»æœºåœ¨æ‰€æœ‰æ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶ä¸Šå…·æœ‰ç›¸åŒçš„å¯†ç å¥—ä»¶æŒ‡çº¹ã€‚æˆ‘ä»¬åˆ é™¤äº†å‰©ä½™0.4%çš„ä¸»æœºä»¥ç®€åŒ–ç¾¤é›†ã€‚ç„¶è€Œï¼Œåœ¨æ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶ä¸Šå…±äº«ç›¸åŒå¯†ç å¥—ä»¶æŒ‡çº¹çš„ä¸»æœºä¸ä¸€å®šå…±äº«ç›¸åŒçš„å®ç°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸¤å°ä¸»æœºAå’ŒBéƒ½æœ‰ä¸¤ä¸ªå—ä¸»æœº1å’Œ2æ”¯æŒçš„å¯†ç å¥—ä»¶ã€‚Aåœ¨å…·æœ‰å¯†ç å¥—ä»¶æŒ‡çº¹Xçš„å¯†ç å¥—ä»¶1ä¸Šæ˜“å—æ”»å‡»ï¼Œä½†åœ¨å¯†ç å¥—ä»¶2ä¸Šä¸æ˜“å—æ”»å‡»ã€‚Båœ¨å¯†ç å¥—ä»¶1ä¸Šä¸æ˜“å—æ”»å‡»ï¼Œä½†åœ¨å…·æœ‰ç›¸åŒå¯†ç å¥—ä»¶æŒ‡çº¹Xçš„å¯†ç å¥—ä»¶2ä¸Šæ˜“å—æ”»å‡»ã€‚è¿™ç§å·®å¼‚è¡¨æ˜ä¸»æœºä¸å…±äº«ç›¸åŒçš„å®ç°ï¼Œå› ä¸ºæˆ‘ä»¬æœŸæœ›å…±äº«å®ç°å…·æœ‰ä¸€è‡´çš„æ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶é›†ã€‚(æˆ‘ä»¬æ‰¿è®¤ï¼Œå°½ç®¡å…±äº«ç›¸åŒçš„å®ç°ï¼Œä½†ç”±äºé…ç½®æ ‡å¿—ä¸åŒï¼Œä¸»æœºå¯èƒ½è¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºï¼Œä½†æˆ‘ä»¬è®¤ä¸ºè¿™ä¸å¤ªå¯èƒ½)ã€‚</p>
<p>æˆ‘ä»¬å°†ä¸Šè¿°æƒ…å†µ(åœ¨å…¶ä¸€èˆ¬å½¢å¼ä¸­)è¡¨ç¤ºä¸ºâ€œçŸ›ç›¾å“åº”å›¾â€ï¼›ä¸¤ä¸ªä¸»æœºåœ¨æ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶ä¸Šè¡¨ç°å‡ºç›¸åŒçš„å¯†ç å¥—ä»¶æŒ‡çº¹ï¼Œä½†æ˜¯å­˜åœ¨ä¸¤ä¸ªä¸»æœºéƒ½æ”¯æŒçš„å¯†ç å¥—ä»¶ï¼Œä½¿å¾—ä¸€å°ä¸»æœºåœ¨è¯¥å¯†ç å¥—ä»¶ä¸Šæ˜“å—æ”»å‡»ï¼Œè€Œå¦ä¸€å°ä¸»æœºåˆ™ä¸å—æ”»å‡»ã€‚æˆ‘ä»¬å°†è¡¥å……æ€§æƒ…å†µç§°ä¸ºâ€œå…¼å®¹å“åº”å›¾â€ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨å›¾ç®—æ³•è¿›ä¸€æ­¥æ‹†åˆ†ä¸»æœºç»„ã€‚å¯¹äºå…·æœ‰ç›¸åŒå¯†ç å¥—ä»¶æŒ‡çº¹çš„æ¯ç»„ä¸»æœºï¼Œæˆ‘ä»¬æ„é€ ä¸€ä¸ªå›¾ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªä¸»æœºã€‚å½“ä¸”ä»…å½“ä¸¤å°ä¸»æœºçš„å“åº”å›¾å…¼å®¹æ—¶ï¼Œæˆ‘ä»¬æ‰ä¼šåœ¨è¿™ä¸¤å°ä¸»æœºä¹‹é—´ç”»ä¸€æ¡è¾¹ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨Gephiè½¯ä»¶ä¸­å®ç°çš„ForceAtlas2ç®—æ³•å°†å›¾å½¢åµŒå…¥åˆ°äºŒç»´å¹³é¢ä¸­ã€‚ForceAtlas2ç®—æ³•å°†é€šè¿‡è¾¹è¿æ¥çš„èŠ‚ç‚¹èšé›†åœ¨ä¸€èµ·ï¼Œå› æ­¤å…·æœ‰å…¼å®¹å“åº”å›¾çš„èŠ‚ç‚¹è¢«èšé›†åœ¨ä¸€èµ·ã€‚è¡Œä¸ºç›¸åŒçš„é…ç½®ç›¸åŒçš„æœåŠ¡å™¨å°†è¿æ¥åˆ°ç›¸åŒçš„èŠ‚ç‚¹ï¼Œå› æ­¤å°†å…·æœ‰ç›¸åŒçš„ç­‰çº§ã€‚ç”±äºè¿™äº›æœåŠ¡å™¨è¿æ¥åˆ°ç›¸åŒçš„èŠ‚ç‚¹ï¼ŒForceAtlas2å°†ä½¿å®ƒä»¬å½¼æ­¤é è¿‘ã€‚é€šè¿‡æ ¹æ®èŠ‚ç‚¹çš„åº¦æ•°å¯¹èŠ‚ç‚¹è¿›è¡Œç€è‰²ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨å›¾ä¸­æ‰‹åŠ¨å‘ç°é…ç½®ç›¸ä¼¼ä¸”è¡Œä¸ºç›¸åŒçš„å®ç°ã€‚ç„¶åï¼Œå¯ä»¥æ£€æŸ¥è¿™äº›å­ç»„æ˜¯å¦æœ‰å€™é€‰å¯¹è±¡ï¼Œä»¥ä¾¿è¿›è¡Œæ‰‹åŠ¨åˆ†æå’Œè´Ÿè´£ä»»çš„æŠ«éœ²ã€‚</p>
<ul>
<li><strong>ä¸€ä¸ªæ¼æ´ç»„çš„ç¤ºä¾‹ï¼š</strong>å›¾3æä¾›äº†è¿™ç§å¯è§†åŒ–çš„ä¸€ä¸ªç¤ºä¾‹ã€‚è¯¥å›¾æ¸…æ¥šåœ°æ˜¾ç¤ºäº†ä¸¤ä¸ªä¸åŒçš„å­ç»„ï¼Œå®ƒä»¬ä¸å…±äº«è¾¹ç¼˜(è¿™æ„å‘³ç€å®ƒä»¬çš„å“åº”å›¾æ˜¯ç›¸äº’çŸ›ç›¾çš„ï¼Œå®ƒä»¬å¯èƒ½ä¸å…±äº«ç›¸åŒçš„å®ç°)ã€‚ç»¿è‰²æ˜¾ç¤ºçš„ä¸»æœºåœ¨TLS_RSA_WITH_AES_128_CBC_SHAå’ŒTLS_DHE_RSA_WITH_3DES_EDE_CBC_SHAä¸Šæ˜“å—æ”»å‡»ï¼Œè€Œç²‰è‰²æ˜¾ç¤ºçš„æœåŠ¡å™¨ä»…æ˜“å—TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHAçš„æ”»å‡»ï¼Œè€Œåœ¨TLS_RSA_WITH_AES_128_CBC_SHAä¸Šä¸æ˜“å—æ”»å‡»ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå›¾å½¢ä¸­é—´çš„ä¸»æœº(å¤§éƒ¨åˆ†ä¸ºé’è‰²)ä¸æ”¯æŒTLS_RSA_WITH_AES_128_CBC_SHA(å®ƒä»¬åœ¨TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHAä¸Šæ˜“å—æ”»å‡»)ã€‚ä»–ä»¬å¯ä»¥ä¸ç»¿è‰²æˆ–ç²‰è‰²ç»„å…±äº«å…¶å®ç°ï¼Œå› æ­¤ä¸è¿™ä¸¤ä¸ªç»„çš„æˆå‘˜å…±äº«è¾¹ç¼˜ã€‚çº¢è‰²çš„ä¸»æœºä¸ç²‰è‰²çš„ä¸»æœºéå¸¸ç›¸ä¼¼ï¼Œä½†ä¸è“è‰²çš„ä¸»æœºæ²¡æœ‰ç›¸åŒçš„è¾¹ç¼˜ã€‚è¿™æ„å‘³ç€è¦ä¹ˆå­˜åœ¨ç¬¬ä¸‰ç»„ï¼Œè¦ä¹ˆé’è‰²ç»„å®é™…ä¸Šå±äºç»¿è‰²ç»„ï¼Œè€Œçº¢è‰²ç»„å±äºç²‰çº¢è‰²ç»„ã€‚å•ä¸ªèŠ‚ç‚¹å¾ˆå¯èƒ½æ˜¯è¾ƒå¤§ç»„çš„å®ç°ä¹‹ä¸€çš„ç½•è§é…ç½®ã€‚æˆ‘ä»¬è¿›è¡Œäº†DNSæŸ¥è¯¢ï¼Œç¡®å®šè¿™ä¸¤ä¸ªç»„éƒ½æ˜¯ç”±æ·å…‹ä¸€å®¶æ‰˜ç®¡å…¬å¸è¿è¥çš„ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è”ç³»æ¯ä¸ªç»„ä¸­çš„å…¶ä»–çŸ¥åç½‘ç«™ï¼Œè¯¢é—®ä»–ä»¬ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆTLSå®ç°ã€‚</li>
</ul>
<p><img src="/images/USS-2020-paper/Figure-3.jpg" alt="Figure-3ï¼šè¡¨2ä¸­çš„ç»„#23çš„å¯è§†åŒ–ã€‚"></p>
<ul>
<li><strong>å“åº”å›¾çš„ç»†åˆ†ï¼š</strong>å›¾4ç›´è§‚åœ°æ˜¾ç¤ºäº†å„ç§å¯†ç å¥—ä»¶æŒ‡çº¹çš„æµè¡Œæƒ…å†µã€‚å¤§å¤šæ•°æ˜“å—æ”»å‡»çš„ä¸»æœºéƒ½æ˜¯ç”±å‡ ä¸ªéå¸¸å¸¸è§çš„æ¼æ´é€ æˆçš„ã€‚Amazon/OpenSSLå’ŒCitrixä¸­æ–°å‘ç°çš„æ¼æ´å æ‰€æœ‰æ˜“å—æ”»å‡»ä¸»æœºçš„ä¸€åŠå¤šä¸€ç‚¹ã€‚å®ƒä»¬è¢«åˆ—ä¸º#15å’Œ#84ï¼Œå¹¶åœ¨ç¬¬8.2èŠ‚ä¸­è¿›è¡Œäº†æ›´è¯¦ç»†çš„æè¿°ã€‚æ­¤å¤–ï¼Œå“åº”å›¾#41å’Œ#75å¯èƒ½æºè‡ªåŸºäºæœªæ‰“è¡¥ä¸çš„OpenSSLç‰ˆæœ¬çš„å®ç°ï¼Œçº¦å æ˜“å—æ”»å‡»ä¸»æœºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚åœ¨ä¸Šè¿°Czechæ‰˜ç®¡å…¬å¸ä¸­å¯ä»¥æ‰¾åˆ°å“åº”å›¾#23ã€‚</li>
</ul>
<p><img src="/images/USS-2020-paper/Figure-4.jpg" alt="Figure-4ï¼šå¯†ç å¥—ä»¶æŒ‡çº¹æµè¡Œç¨‹åº¦çš„å¯è§†åŒ–ã€‚å¤§å¤šæ•°æ˜“å—æ”»å‡»çš„ä¸»æœºéƒ½æ˜¯ç”±å°‘æ•°å‡ ä¸ªæ™®éå­˜åœ¨çš„æ¼æ´é€ æˆçš„ã€‚åœ¨ä¸Šè¿°å¯†ç å¥—ä»¶æŒ‡çº¹ä¸­ï¼Œ#84å’Œ#15æ˜¯å¯åˆ©ç”¨çš„ã€‚åœ¨ç¬¬8.2èŠ‚ä¸­å¯¹å®ƒä»¬è¿›è¡Œäº†æ›´è¯¦ç»†çš„æè¿°ã€‚"></p>
<h1 id="ä¸ƒã€ç°å®å¯åˆ©ç”¨çš„-Padding-Oracleæ¼æ´"><a href="#ä¸ƒã€ç°å®å¯åˆ©ç”¨çš„-Padding-Oracleæ¼æ´" class="headerlink" title="ä¸ƒã€ç°å®å¯åˆ©ç”¨çš„ Padding Oracleæ¼æ´"></a>ä¸ƒã€ç°å®å¯åˆ©ç”¨çš„ Padding Oracleæ¼æ´</h1><p>å¹¶éæ‰€æœ‰æˆ‘ä»¬ç¡®å®šçš„Oracleéƒ½èƒ½å¯ç”¨æœ‰æ•ˆçš„è§£å¯†æ”»å‡»ã€‚ æœ¬èŠ‚çš„å…¶ä½™éƒ¨åˆ†å°†æ›´è¯¦ç»†åœ°è¯´æ˜å¼€å‘ã€‚ æˆ‘ä»¬å‘ç°çš„Padding OracleåŸºäºç›´æ¥æ¶ˆæ¯ä¾§ä¿¡é“ï¼Œå³åŸºäºTLSå®ç°ï¼Œå…¶ä¸­ä¸¤ä¸ªé”™è¯¯çŠ¶æ€è§¦å‘æ¥è‡ªTLSæœåŠ¡å™¨çš„ä¸åŒé”™è¯¯å“åº”ã€‚ å®ƒä»¬å¯ä»¥åœ¨BEASTæ”»å‡»è€…æ¨¡å‹ä¸­è¢«åˆ©ç”¨ï¼ŒBEASTæ”»å‡»è€…æ¨¡å‹åŸºäºä¸¤ä¸ªå‡è®¾ï¼šï¼ˆaï¼‰å—å®³è€…å®¢æˆ·ç«¯åœ¨æ”»å‡»è€…çš„æ§åˆ¶ä¸‹è®¿é—®ç½‘ç«™ï¼Œè¯¥ç½‘ç«™è§¦å‘å¯¹å—å®³è€…æœåŠ¡å™¨çš„HTTPSè¯·æ±‚ï¼Œå¹¶ä¸”ï¼ˆbï¼‰æ”»å‡»è€…æ˜¯MitMï¼Œå¹¶ä¸”å¯ä»¥ è§‚å¯Ÿä¼šè¯å¹¶ä¿®æ”¹ä¼ è¾“çš„å¯†æ–‡ã€‚ é™¤äº†è¿™äº›æ ‡å‡†å‡è®¾å¤–ï¼Œå¦‚æœä¸€ä¸ªçƒæ»¡è¶³ä¸¤ä¸ªé™„åŠ è¦æ±‚ï¼šï¼ˆR1ï¼‰å¯è§‚å¯Ÿæ€§å’Œï¼ˆR2ï¼‰å®Œç¾çš„å¡«å……åŒºåˆ†æ€§ã€‚</p>
<p><img src="/images/USS-2020-paper/Figure-5.jpg" alt="Figure-5ï¼šåœ¨BEASTåœºæ™¯ä¸­åˆ©ç”¨å¯è§‚å¯Ÿåˆ°çš„åŸºäºé”™è¯¯çš„Padding Oracleã€‚å‘é€çš„TLSè­¦æŠ¥æ•°é‡ä¸åŒå¯¼è‡´å¯†æ–‡æ€»é•¿åº¦ä¸åŒã€‚"></p>
<h2 id="ï¼ˆR1ï¼‰å¯è§‚å¯Ÿæ€§"><a href="#ï¼ˆR1ï¼‰å¯è§‚å¯Ÿæ€§" class="headerlink" title="ï¼ˆR1ï¼‰å¯è§‚å¯Ÿæ€§"></a>ï¼ˆR1ï¼‰å¯è§‚å¯Ÿæ€§</h2><p>ä¸è®¡æ—¶ä¾§ä¿¡é“ä¸åŒï¼Œåœ¨TLSçš„æƒ…å†µä¸‹ï¼Œå¾ˆå°‘å…³æ³¨ç›´æ¥æ¶ˆæ¯ä¾§ä¿¡é“ï¼Œè€Œä¸”é€šå¸¸çš„æ™ºæ…§ä¼¼ä¹å‡è®¾æ”»å‡»è€…çœ‹ä¸åˆ°å®ƒä»¬ã€‚å®é™…ä¸Šï¼Œå¯¹äºåœ¨æ‰€æœ‰é”™è¯¯æƒ…å†µä¸‹éƒ½å‘é€å•ä¸ªè­¦æŠ¥çš„å®ç°æ¥è¯´ï¼Œæƒ…å†µç¡®å®å¦‚æ­¤ï¼Œè¡Œä¸ºæ˜¯ç›¸åŒçš„ï¼Œå¯èƒ½åªæ˜¯è­¦æŠ¥æ¶ˆæ¯çš„å†…å®¹ä¸åŒã€‚å› ä¸ºè­¦æŠ¥æ¶ˆæ¯æ˜¯åŠ å¯†çš„ï¼Œæ‰€ä»¥æ”»å‡»è€…æ— æ³•åˆ©ç”¨æ­¤ç±»è¡Œä¸ºæ¥åˆ›å»ºæ—è·¯ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ç¡®å®šäº†è®¸å¤šå®ç°ç¡®å®åœ¨è¡Œä¸ºä¸Šè¡¨ç°å‡ºæ˜æ˜¾å·®å¼‚çš„æƒ…å†µã€‚è¿™äº›å¯è§‚å¯Ÿåˆ°çš„å·®å¼‚å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li><strong>TCPå±‚ï¼š</strong>æˆ‘ä»¬å‘ç°TCPå±‚ä¸­çš„å®ç°æ³„éœ²äº†æœ‰å…³å¡«å……æœ‰æ•ˆæ€§çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨Amazonçš„ä¾‹å­ä¸­ï¼Œå¤§å¤šæ•°å¸¦æœ‰æ— æ•ˆå¡«å……çš„æµ‹è¯•å‘é‡éƒ½ä¼šå¯¼è‡´æœåŠ¡å™¨ç«‹å³å…³é—­TCPè¿æ¥ã€‚ä½†æ˜¯ï¼Œç²¾å¿ƒè®¾è®¡çš„ç‰¹å®šæµ‹è¯•å‘é‡å¯¼è‡´æœåŠ¡å™¨åœ¨ä¿æŒTCPè¿æ¥æ‰“å¼€çš„åŒæ—¶ä¸­æ­¢TLSä¼šè¯ã€‚</li>
<li><strong>TLSè®°å½•æ•°ï¼š</strong>æˆ‘ä»¬è§‚å¯Ÿåˆ°TLSæœåŠ¡å™¨æ ¹æ®å¡«å……æœ‰æ•ˆæ€§ä½¿ç”¨ä¸åŒæ•°é‡çš„è®°å½•è¿›è¡Œå“åº”ã€‚è™½ç„¶æ”»å‡»è€…æ— æ³•è§£å¯†è¿™äº›è®°å½•ï¼Œä½†ä»–èƒ½å¤Ÿè§‚å¯Ÿåˆ°å¯†æ–‡çš„æ€»é•¿åº¦ã€‚ä¾‹å¦‚ï¼Œåœ¨æœ‰æ•ˆå¡«å……çš„æƒ…å†µä¸‹ï¼Œæ¥è‡ªç»„23(å‚è§è¡¨2)çš„æœåŠ¡å™¨ä»¥ä¸€ä¸ªTLSè­¦æŠ¥å“åº”ï¼Œè€Œå¯¹äºæ— æ•ˆçš„å¡«å……ï¼Œå®ƒä»¬ä»¥ä¸¤ä¸ªTLSè­¦æŠ¥å“åº”ã€‚</li>
</ul>
<p>å‡è®¾æ”»å‡»è€…Aå¯ä»¥æ ¹æ®æœ€åä¸€ä¸ªå¡«å……å­—èŠ‚çš„æœ‰æ•ˆæ€§åŒºåˆ†VALID_PADDINGå’ŒINVALID_PADDINGä¸¤ç§æƒ…å†µ(å‚è§å›¾6)ã€‚æ”»å‡»è€…æŒ‰å¦‚ä¸‹æ–¹å¼è§£å¯†HTTPSä¼šè¯Cookieï¼š</p>
<ol>
<li>Aå¼•è¯±å—å®³è€…å®¢æˆ·ç«¯åŠ è½½ä»–æ§åˆ¶çš„ç½‘é¡µã€‚æ­¤ç½‘é¡µåŒ…å«å‘å—æ”»å‡»æœåŠ¡å™¨å‘é€HTTPSè¯·æ±‚çš„JavaScriptä»£ç ï¼Œå¸¦æœ‰Aé€‰æ‹©çš„URLã€‚</li>
<li>Aè§‚å¯Ÿç¬¬ä¸€æ¬¡TLSæ¡æ‰‹ï¼Œå¹¶ç¡®å®šåå•†çš„å¯†ç å¥—ä»¶æ˜¯å¦æ˜“å—å¡«å……é¢„è¨€æ”»å‡»ã€‚<br>å¦‚æœæ²¡æœ‰ï¼Œä»–å°±æ”¾å¼ƒã€‚</li>
<li>å¦‚æœä½¿ç”¨äº†æ˜“å—æ”»å‡»çš„å¯†ç å¥—ä»¶ï¼Œåˆ™AæŒ‡ç¤ºå®¢æˆ·ç«¯å‘é€å¦ä¸€ä¸ªHTTPSè¯·æ±‚ï¼Œä¿®æ”¹URLï¼Œä½¿å¾—ä¼šè¯cookieçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¯†ç å—Ciä¸­çš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚</li>
<li>ä½œä¸ºMITMï¼ŒAæˆªå–å¯†æ–‡(C1ï¼Œâ€¦ï¼ŒCiï¼Œâ€¦ï¼ŒCn)å¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œä½¿å¾—Ciæˆä¸ºæœ€åçš„å¯†æ–‡å—ï¼Œä¾‹å¦‚é€šè¿‡ç”¨Ciæ›¿æ¢Cnã€‚</li>
<li>æœ€åä¸€ä¸ªå—çš„è§£å¯†æ˜¯ä¼ªéšæœºå˜æ¢ï¼Œå› æ­¤å¡«å……å¯èƒ½æ˜¯æ— æ•ˆçš„ï¼Œä»è€Œè§¦å‘å¯è§‚å¯Ÿåˆ°çš„INVALID_PADDINGé”™è¯¯äº‹ä»¶ã€‚</li>
<li>åœ¨256ä¸ªè¯·æ±‚ä¸­ï¼Œçº¦æœ‰1ä¸ªè¯·æ±‚çš„å¡«å……å°†éšæœºæœ‰æ•ˆã€‚å½“å¡«å……æœ‰æ•ˆæ—¶ï¼Œå®ƒæœ€æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚çš„é•¿åº¦ï¼Œå¦‚å›¾6æ‰€ç¤ºã€‚å‰é¢çš„å­—èŠ‚å°†è¢«TLSæœåŠ¡å™¨è§£æä¸ºMACæ•°æ®ï¼Œå¹¶ä¸”å°†ä»¥å‹å€’æ€§çš„æ¦‚ç‡æ— æ•ˆã€‚åœ¨æœ¬ä¾‹ä¸­ï¼ŒAè§‚å¯Ÿåˆ°VALID_PADDINGé”™è¯¯äº‹ä»¶ï¼Œå¹¶å°†HTTPSä¼šè¯Cookieçš„ç¬¬ä¸€ä¸ªå­—ç¬¦è®¡ç®—ä¸ºC(nâˆ’1)[âˆ’1]âŠ•C(iâˆ’1)[âˆ’1]ï¼Œå…¶ä¸­[âˆ’1]è¿ç®—ç¬¦è¡¨ç¤ºè·å–å—çš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚</li>
<li>ç„¶åï¼ŒAå‡†å¤‡å¦ä¸€ä¸ªHTTPS URLï¼Œå…¶ä¸­ä¼šè¯cookieçš„ç¬¬äºŒä¸ªå­—ç¬¦è¢«ç§»ä½åˆ°Ciçš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”å†æ¬¡ä»æ­¥éª¤3å¼€å§‹ã€‚</li>
</ol>
<p><img src="/images/USS-2020-paper/Figure-6.jpg" alt="Figure-6ï¼šæˆ‘ä»¬çš„æ”»å‡»ä¾èµ–äºä¸€ä¸ªæ˜“å—æ”»å‡»çš„æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ ¹æ®æœ€åä¸€ä¸ªå¡«å……å­—èŠ‚çš„æœ‰æ•ˆæ€§æä¾›ä¸åŒçš„å“åº”ã€‚"></p>
<h2 id="ï¼ˆR2ï¼‰å®Œç¾å¡«å……åŒºåˆ†æ€§"><a href="#ï¼ˆR2ï¼‰å®Œç¾å¡«å……åŒºåˆ†æ€§" class="headerlink" title="ï¼ˆR2ï¼‰å®Œç¾å¡«å……åŒºåˆ†æ€§"></a>ï¼ˆR2ï¼‰å®Œç¾å¡«å……åŒºåˆ†æ€§</h2><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ä¸€ä¸ªç®€å•çš„Oracleï¼Œå®ƒå…è®¸æ ¹æ®æœ€åä¸€ä¸ªå¡«å……å­—èŠ‚çš„æœ‰æ•ˆæ€§åŒºåˆ†VALIDATE_PADDINGå’ŒINVALID_PADDINGã€‚ç„¶è€Œï¼Œå³ä½¿åœ¨æä¾›ä¸åŒçš„å“åº”æ—¶ï¼Œå®ç°ä¹Ÿä¸ä¸€å®šå…¬å¼€è¿™æ ·ç®€å•çš„Oracleã€‚ä¾‹å¦‚ï¼Œè¾ƒæ—©çš„OpenSSLç‰ˆæœ¬ä»…åœ¨åŒ…å«è‡³å°‘ä¸¤ä¸ªå®Œæ•´æœ‰æ•ˆå¡«å……å—çš„ç©ºè®°å½•çš„ç‰¹å®šæƒ…å†µä¸‹æ‰ä»¥ä¸åŒçš„è­¦æŠ¥æ¶ˆæ¯å“åº”[37]ã€‚æˆ‘ä»¬å‘ç°äº†ä»…å¯¹åŒ…å«å‡ ä¸ªæœ‰æ•ˆå¡«å……æˆ–MACå­—èŠ‚çš„å¯†æ–‡ä½œå‡ºä¸åŒå“åº”çš„æ˜“å—æ”»å‡»çš„å®ç°ã€‚è¿™æ ·çš„æ¼æ´ä¸å¤ªå¯èƒ½è¢«åˆ©ç”¨ï¼Œå› ä¸ºä½¿ç”¨ä¸Šé¢çš„ç®—æ³•ï¼Œæ”»å‡»è€…éœ€è¦æ‰§è¡Œ256ä¸ªä»¥ä¸Šçš„OracleæŸ¥è¯¢æ‰èƒ½è§£å¯†æ¯ä¸ªå­—èŠ‚ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨Cookieå€¼åé¢ç›´æ¥æ’å…¥ä»–é€‰æ‹©çš„å­—èŠ‚æ¥å…‹æœæ­¤é™åˆ¶ã€‚ç”±äºCBCçš„å»¶å±•æ€§ï¼Œåªèƒ½æ’å…¥ä¸€ä¸ªè¿ç»­é€‰æ‹©çš„æ•°æ®å—ã€‚å› æ­¤ï¼Œå¦‚æœé€‰æ‹©çš„å¡«å……å­—èŠ‚æ•°å°äºå—å¤§å°ï¼Œåˆ™CBCå…è®¸åˆ›å»ºå®é™…åˆ©ç”¨æ¼æ´ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„å½±å“è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬é‡‡å–äº†ä¿å®ˆçš„æ–¹å¼ã€‚è¦å°†æ˜“å—æ”»å‡»çš„å®ç°è§†ä¸ºå¯åˆ©ç”¨çš„ï¼Œæˆ‘ä»¬è¦æ±‚å®ƒä»¥VALID_PADDINGå“åº”æœ€å¤šå…·æœ‰ä¸€å—æœ‰æ•ˆå¡«å……çš„å¯†æ–‡ã€‚æˆ‘ä»¬ç§°è¿™æ ·çš„Oracleä¸º<em>strong</em>ç§°å…¶ä»–Oracleä¸º<em>weak</em>ã€‚é™¤äº†è¿™ä¸¤ä¸ªOracleä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è€ƒè™‘ä¸æ­£ç¡®éªŒè¯å®Œæ•´çš„CBCå¡«å……è€ŒåªéªŒè¯MACçš„Oracleã€‚æˆ‘ä»¬ç§°è¿™æ ·çš„Oracleä¸ºPOODLE Oracleã€‚è¿™äº›Oracleä¹Ÿå¯ä»¥é€šè¿‡åº”ç”¨ç±»ä¼¼POODLEçš„æ”»å‡»æ¥æ”»å‡»ã€‚</p>
<p>è¡¨2ä¸­çš„åˆ—R2æ ‡è¯†äº†Oracleå¼ºåº¦ã€‚ä¾‹å¦‚ï¼Œå…·æœ‰ç¬¬äºŒæµè¡Œçš„å¯†ç å¥—ä»¶æŒ‡çº¹(#41)çš„æœåŠ¡å™¨ä½¿ç”¨RECORD_OVERFLOWå“åº”è¡¨1ä¸­æ ¼å¼é”™è¯¯çš„è®°å½•#6å’Œ#7ã€‚åœ¨æ‰€æœ‰å…¶ä»–æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å‘é€BAD_RECORD_MACè­¦æŠ¥ã€‚æˆ‘ä»¬è®¤ä¸ºè¯¥ç»„æ˜¯è–„å¼±çš„ï¼Œå› ä¸ºæ”»å‡»è€…éœ€è¦å‘é€ä¸€ä¸ªä»¥ä¸Šçš„æœ‰æ•ˆå¡«å……å—æ¥è§¦å‘å…·æœ‰é”™è¯¯è®°å½•#6æˆ–#7çš„RECORD_OVERFLOWè­¦æŠ¥ã€‚</p>
<p>æˆ‘ä»¬è®¤ä¸ºå…·æœ‰å¯†ç å¥—ä»¶æŒ‡çº¹#2çš„æœåŠ¡å™¨æ˜¯<em>strong</em> Oracleã€‚æ­¤ç»„ä¸­çš„æœåŠ¡å™¨ä»¥TCPè¿æ¥é‡ç½®å“åº”ã€‚å¦‚æœä»–ä»¬æ¥æ”¶åˆ°å…·æœ‰æœ‰æ•ˆå¡«å……çš„æ ¼å¼é”™è¯¯çš„è®°å½•(å‚è§æ ¼å¼é”™è¯¯çš„è®°å½•#20å’Œ#21)ã€‚è¿˜æœ‰å‡ ä¸ªç¾¤ä½“çš„è¡Œä¸ºç±»ä¼¼äºPOODLEã€‚è¿™äº›ç»„å¿½ç•¥MACå­—èŠ‚ä¸­çš„ä¿®æ”¹ï¼Œå¹¶ä»¥ä¸åŒæ–¹å¼å“åº”æ ¼å¼é”™è¯¯çš„è®°å½•#8ã€#9ã€#17å’Œ#18ã€‚</p>
<h2 id="å¯åˆ©ç”¨æ€§"><a href="#å¯åˆ©ç”¨æ€§" class="headerlink" title="å¯åˆ©ç”¨æ€§"></a>å¯åˆ©ç”¨æ€§</h2><p>æˆ‘ä»¬è®¤ä¸ºçœ‹å¾—è§çš„POODLEå’Œçœ‹å¾—è§çš„<em>strong</em> Oracleæ˜¯å¯ä»¥å¼€å‘çš„ã€‚æˆ‘ä»¬è®¤ä¸ºæ‰€æœ‰å…¶ä»–çš„Oracleéƒ½æ˜¯ä¸å¯åˆ©ç”¨çš„ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œå¯ä»¥ä½¿ç”¨æ›´é«˜çº§çš„æŠ€æœ¯æ¥åˆ©ç”¨<em>weak</em> Oracleã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹å¯åˆ©ç”¨ä¸»æœºæ•°é‡çš„ä¼°è®¡æ˜¯ä¿å®ˆçš„è¾ƒä½ä¼°è®¡ã€‚</p>
<ul>
<li><strong>å¯åˆ©ç”¨ä¸»æœºçš„ä¼°è®¡ï¼š</strong>æˆ‘ä»¬çš„æ‰«æå‘ç°18,257å°ä¸»æœºæ˜“å—Padding Oracleæ”»å‡»ã€‚å…¶ä¸­ï¼Œ11225æ¡(61.4%)è¡¨ç°å‡ºå¯è§‚å¯Ÿåˆ°çš„æ¼æ´ï¼Œä½¿å¾—æ”»å‡»è€…èƒ½å¤ŸåŒºåˆ†ä¸¤æ¡æ ¼å¼é”™è¯¯çš„è®°å½•ã€‚å¦è¯·å‚è§è¡¨2ä¸­çš„åˆ—R1ã€‚è‡³å°‘æœ‰10,688å°ä¸»æœºæä¾›äº†<em>strong</em>æˆ–POODLEæ ·å¼çš„Oracleï¼Œå æ˜“å—æ”»å‡»ä¸»æœºçš„58%ã€‚å¦è¯·å‚è§è¡¨2ä¸­çš„åˆ—R2ã€‚æ€»å…±æœ‰10,501å°ä¸»æœºå®é™…ä¸Šæ˜¯å¯åˆ©ç”¨çš„ï¼Œå³å®ƒä»¬åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªè¦æ±‚ã€‚</li>
<li>CBCå¯†ç å¥—ä»¶åå•†å¥½äº†å—ï¼Ÿå¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒAEADå¯†ç å¥—ä»¶ã€‚å¦‚æœæ˜“å—æ”»å‡»çš„æœåŠ¡å™¨åçˆ±AEADå¯†ç å¥—ä»¶ï¼Œåˆ™å®ƒä»¬å¯èƒ½ä¼šè¢«åå•†ï¼Œä»è€Œé˜»æ­¢CBCæ”»å‡»ã€‚31651å°ä¸»æœº(4.03%)ä»…æ”¯æŒRC4æˆ–CBCå¯†ç å¥—ä»¶ã€‚ç”±äº[30]çš„åŸå› ï¼Œå¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½ç¦ç”¨äº†å¯¹RC4å¯†ç å¥—ä»¶çš„æ”¯æŒï¼Œå› æ­¤ç°ä»£æµè§ˆå™¨å¯èƒ½ä¼šä¸è¿™äº›ä¸»æœºåå•†CBCå¯†ç å¥—ä»¶ã€‚åœ¨è¿™äº›ä¸»æœºä¸­ï¼Œæœ‰1400å°å®¹æ˜“å—åˆ°Padding Oracleæ”»å‡»ã€‚</li>
</ul>
<h1 id="å…«ã€å‘ç°"><a href="#å…«ã€å‘ç°" class="headerlink" title="å…«ã€å‘ç°"></a>å…«ã€å‘ç°</h1><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å›é¡¾æˆ‘ä»¬çš„å‡è®¾ï¼Œå¹¶ä»‹ç»æˆ‘ä»¬åœ¨ä¸åŒå®ç°ä¸­å‘ç°çš„å€¼å¾—æ³¨æ„çš„æ¼æ´ã€‚</p>
<h2 id="æˆ‘ä»¬æœ€åˆçš„å‡è®¾æˆç«‹å—ï¼Ÿ"><a href="#æˆ‘ä»¬æœ€åˆçš„å‡è®¾æˆç«‹å—ï¼Ÿ" class="headerlink" title="æˆ‘ä»¬æœ€åˆçš„å‡è®¾æˆç«‹å—ï¼Ÿ"></a>æˆ‘ä»¬æœ€åˆçš„å‡è®¾æˆç«‹å—ï¼Ÿ</h2><p>æˆ‘ä»¬æ‰§è¡Œæ‰«æçš„å‰ææ˜¯ï¼Œä¸ºäº†æ£€æµ‹æ˜“å—æ”»å‡»çš„ä¸»æœºï¼Œå¿…é¡»ä½¿ç”¨ä¸åŒçš„å¯†ç å¥—ä»¶å’Œåè®®ç‰ˆæœ¬è¿›è¡Œæ‰«æã€‚å¦‚ä¸‹æ‰€è¿°ï¼Œæˆ‘ä»¬çš„å‘ç°è¯å®äº†è¿™ä¸€å‡è®¾ã€‚</p>
<ul>
<li><p><strong>æ˜¯å¦æœ‰å¿…è¦ä½¿ç”¨ä¸åŒçš„åè®®ç‰ˆæœ¬è¿›è¡Œæ‰«æï¼Ÿ</strong>BÃ¶ckç­‰äººå‘ç°ä¸€äº›æœåŠ¡å™¨ä»…åœ¨å…¶æ”¯æŒçš„æŸäº›åè®®ç‰ˆæœ¬ä¸Šè¡¨ç°å‡ºRSA Padding Oracleæ¼æ´[9]ã€‚å¦‚ç¬¬3.5èŠ‚æ‰€è¿°ï¼Œæˆ‘ä»¬æ€€ç–‘CBC Paddingæ¼æ´ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æˆ‘ä»¬çš„å‘ç°è¯å®äº†è¿™ä¸€å‡è®¾ï¼šæˆ‘ä»¬å‘ç°è‡³å°‘æœ‰744å°ä¸»æœºåœ¨TLS 1.0å’Œ1.2ä¸­éƒ½æ”¯æŒç›¸åŒçš„å¯†ç å¥—ä»¶ï¼Œä½†ä»…åœ¨å…¶ä¸­ä¸€ä¸ªç‰ˆæœ¬ä¸­ä½¿ç”¨è¯¥å¯†ç å¥—ä»¶æ—¶æ˜“å—æ”»å‡»ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ˜“å—æ”»å‡»çš„åè®®ç‰ˆæœ¬æ˜¯è¾ƒæ–°çš„ç‰ˆæœ¬ï¼Œè€Œåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œåˆ™æ˜¯è¾ƒæ—§çš„ç‰ˆæœ¬ã€‚ä½œä¸ºå‰ä¸€ç§æƒ…å†µçš„ç¤ºä¾‹ï¼Œvine.coåœ¨ä½¿ç”¨TLS 1.2å’ŒTLS_RSA_WITH_3DES_EDE_CBC_SHAå¯†ç å¥—ä»¶æ—¶å®¹æ˜“å—åˆ°æ”»å‡»ï¼Œä½†åœ¨TLS 1.0ä¸­ä½¿ç”¨ç›¸åŒçš„å¯†ç å¥—ä»¶æ—¶ä¸ä¼šå—åˆ°æ”»å‡»ã€‚</p>
<p>ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå½“åªæœ‰ä¸€ä¸ªåè®®ç‰ˆæœ¬ä½¿ç”¨ç›¸åŒçš„å¯†ç å¥—ä»¶æ˜“å—æ”»å‡»æ—¶ï¼Œæ–°ç‰ˆæœ¬æ˜“å—æ”»å‡»çš„æƒ…å†µä¼šæ›´å¤šã€‚åœ¨è¿™744å°ä¸»æœºä¸­ï¼Œ120å°ä¸»æœºåœ¨TLS 1.0ä¸­æ˜“å—æ”»å‡»ï¼Œä½†åœ¨TLS 1.2ä¸­ä¸æ˜“å—æ”»å‡»ï¼›624å°ä¸»æœºåœ¨TLS 1.2ä¸­æ˜“å—æ”»å‡»ï¼Œä½†åœ¨TLS 1.0ä¸­ä¸æ˜“å—æ”»å‡»ã€‚</p>
</li>
<li><p><strong>æœ‰å¿…è¦ä½¿ç”¨ä¸åŒçš„å¯†ç å¥—ä»¶è¿›è¡Œæ‰«æå—ï¼Ÿ</strong>BÃ¶ckç­‰äººè¿˜å‘ç°ï¼Œä¸ºäº†æ£€æµ‹å‡ºå°½å¯èƒ½å¤šçš„æ¼æ´ï¼Œæœ‰å¿…è¦ä½¿ç”¨ä¸åŒçš„å¯†ç å¥—ä»¶è¿›è¡Œæ‰«æ[9]ã€‚åœ¨ä¸Šé¢çš„å·¥ä½œä¸­ï¼Œå³ä½¿åœ¨ä½¿ç”¨ä¸åŒçš„å¯¹ç§°å¯†ç æ‰«æå¯†ç å¥—ä»¶æ—¶ï¼Œè¿™ä¸€å‘ç°ä»ç„¶æˆç«‹ï¼Œè€Œæ¼æ´å­˜åœ¨äº(ç†è®ºä¸Šæ— å…³çš„)RSAå®ç°ä¸­ã€‚</p>
<p>æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ç»“æœä¸­å‘ç°äº†ç±»ä¼¼çš„è¡Œä¸ºã€‚æˆ‘ä»¬å‘ç°è‡³å°‘601å°ä¸»æœºå…·æœ‰ä¸¤ä¸ªå¯†ç å¥—ä»¶ï¼Œä¸€ä¸ªæ˜¯æ˜“å—æ”»å‡»çš„ï¼Œä¸€ä¸ªæ˜¯å®‰å…¨çš„ï¼Œä¸¤ä¸ªå¯†ç å¥—ä»¶ä¹‹é—´å”¯ä¸€çš„åŒºåˆ«æ˜¯å¯†é’¥äº¤æ¢ç®—æ³•ã€‚è¿™ä¸€å‘ç°æ˜¯ä¸ç›´è§‚çš„ï¼Œå› ä¸ºäººä»¬ä¼šè®¤ä¸ºä¸€ä¸ªå®ç°åœ¨ä½¿ç”¨ç›¸åŒå¯¹ç§°å¯†ç çš„æ‰€æœ‰å¯†ç å¥—ä»¶ä¸Šéƒ½æ˜¯ç»Ÿä¸€æ˜“å—æ”»å‡»æˆ–å®‰å…¨çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“å°†TLS_RSA_WITH_AES_256_CBC_SHA256ä¸TLS 1.2ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œä¸€ä¸ªç½‘ç«™æ˜¯å®‰å…¨çš„ï¼Œä½†å½“å°†TLS_DHE_RSA_WITH_AES_256_CBC_SHA256ä¸TLS 1.2ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œç½‘ç«™å®¹æ˜“å—åˆ°æ”»å‡»ã€‚</p>
</li>
<li><p><strong>æœåŠ¡å™¨è¡Œä¸ºèƒŒåçš„åŸºæœ¬åŸç†ï¼š</strong>è¿™ä¸¤ç§è¡Œä¸ºçœ‹èµ·æ¥éƒ½ä¸ç›´è§‚ï¼Œä½†å®é™…ä¸Šéƒ½æ˜¯æ„æ–™ä¹‹ä¸­çš„ã€‚è®¸å¤šå®ç°é‡‡ç”¨å®Œå…¨ä¸åŒçš„ä»£ç è·¯å¾„ï¼Œå…·ä½“å–å†³äºåå•†çš„å¯†ç å¥—ä»¶æˆ–åè®®ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼Œè¿™äº›ä»£ç è·¯å¾„å¯èƒ½ä¾èµ–äºç¡¬ä»¶åŠ é€Ÿï¼Œæˆ–è€…åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ä¼˜åŒ–çš„ç¨‹åºé›†å®ç°ã€‚å› æ­¤ï¼Œå³ä½¿ä½¿ç”¨ç›¸åŒçš„å¯¹ç§°å¯†ç ï¼Œä¹Ÿå¾ˆå¯èƒ½(å¦‚æˆ‘ä»¬æ‰€è§ï¼Œè¿™å¾ˆå¸¸è§)å‘ç°ä»…åœ¨æŸäº›å—æ”¯æŒçš„å¯†ç å¥—ä»¶å’Œåè®®ç‰ˆæœ¬ä¸­æ˜¾ç¤ºæ¼æ´çš„å®ç°ã€‚</p>
</li>
</ul>
<h2 id="å€¼å¾—æ³¨æ„çš„æ¼æ´"><a href="#å€¼å¾—æ³¨æ„çš„æ¼æ´" class="headerlink" title="å€¼å¾—æ³¨æ„çš„æ¼æ´"></a>å€¼å¾—æ³¨æ„çš„æ¼æ´</h2><p>åœ¨æˆ‘ä»¬çš„æ‰«æä¸­ï¼Œæˆ‘ä»¬è¯†åˆ«äº†æ¥è‡ªCiscoçš„å¤šä¸ªè®¾å¤‡ã€ä¸¤ä¸ªä¸åŒçš„IBMæœåŠ¡å™¨ä»¥åŠæ¥è‡ªSonicWallå’ŒOracleçš„å¤šä¸ªè®¾å¤‡ã€‚åœ¨ä¸‹é¢ï¼Œæˆ‘ä»¬å°†æè¿°æˆ‘ä»¬åœ¨Citrixã€OpenSSLå’ŒIBMæœåŠ¡å™¨ä¸­å‘ç°å¹¶è´Ÿè´£ä»»åœ°æŠ«éœ²çš„ç‰¹å®šæ¼æ´ã€‚æˆ‘ä»¬çš„æŠ«éœ²ä»åœ¨è¿›è¡Œä¸­ã€‚åœ¨<a href="https://github.com/RUB-NDS/TLS-Padding-Oracles">https://github.com/RUB-NDS/TLS-Padding-Oracles</a> ä¸Šæ€»ç»“äº†æˆ‘ä»¬çš„æœ€æ–°å‘ç°å’Œå—å½±å“ä¾›åº”å•†å®æ–½çš„å¯¹ç­–çš„ç°çŠ¶ã€‚</p>
<ul>
<li><p><strong>Amazon/OpenSSLï¼š</strong>åœ¨Amazonå®‰å…¨å›¢é˜Ÿçš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæ¼æ´(å¯†ç å¥—ä»¶æŒ‡çº¹#15)ï¼Œè¯¥æ¼æ´ä¸»è¦å­˜åœ¨äºAmazonæœåŠ¡å™¨å’ŒAmazonç½‘ç»œæœåŠ¡(Amazon Web Servicesï¼ŒAWS)ä¸Šã€‚å—æ­¤æ¼æ´å½±å“çš„ä¸»æœºä¼šç«‹å³ä½¿ç”¨BAD_RECORD_MACå’ŒCLOSE_NOTIFYè­¦æŠ¥å“åº”å¤§å¤šæ•°è®°å½•ï¼Œç„¶åå…³é—­è¿æ¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸»æœºé‡åˆ°å…·æœ‰æœ‰æ•ˆå¡«å……å’ŒMACçš„é›¶é•¿åº¦è®°å½•ï¼Œåˆ™æ— è®ºMACçš„æœ‰æ•ˆæ€§å¦‚ä½•ï¼Œå®ƒä»¬éƒ½ä¸ä¼šç«‹å³å…³é—­TCPè¿æ¥ã€‚ç›¸åï¼Œå®ƒä»¬åœ¨å‘é€CLOSE_NOTIFYè­¦æŠ¥åä½¿è¿æ¥ä¿æŒæ´»åŠ¨çŠ¶æ€è¶…è¿‡4ç§’ã€‚è¿™ç§è¡Œä¸ºå·®å¼‚åœ¨ç½‘ç»œä¸Šå¾ˆå®¹æ˜“è§‚å¯Ÿåˆ°ã€‚è¯·æ³¨æ„ï¼Œè§¦å‘æ­¤è¶…æ—¶ä¸éœ€è¦MACå€¼æ­£ç¡®ï¼Œåªéœ€åˆ›å»ºå¯¼è‡´è§£å¯†æ•°æ®é•¿åº¦ä¸ºé›¶çš„æœ‰æ•ˆå¡«å……å³å¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æŠŠå®ƒå½’ç±»ä¸ºä¸€ä¸ª<em>strong</em> Oracleï¼Œä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚</p>
<p>è¿›ä¸€æ­¥è°ƒæŸ¥å‘ç°ï¼ŒAmazonæœåŠ¡å™¨æ­£åœ¨è¿è¡Œä¸€ä¸ªä½¿ç”¨OpenSSL 1.0.2 APIçš„å®ç°ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ ¹æ®å‘ç”Ÿçš„æ˜¯MACé”™è¯¯è¿˜æ˜¯å¡«å……é”™è¯¯ï¼Œå¯¹APIçš„å‡½æ•°è°ƒç”¨ä¼šè¿”å›ä¸åŒçš„é”™è¯¯ä»£ç ã€‚ç„¶åï¼ŒAmazonåº”ç”¨ç¨‹åºæ ¹æ®è¿™äº›é”™è¯¯ä»£ç é‡‡ç”¨ä¸åŒçš„ä»£ç è·¯å¾„ï¼Œä¸åŒçš„è·¯å¾„ä¼šåœ¨TCPå±‚äº§ç”Ÿæ˜æ˜¾çš„å·®å¼‚ã€‚ä»…å½“æœªä½¿ç”¨AES-NIæ—¶ï¼Œæ‰ä¼šå‡ºç°æ˜“å—æ”»å‡»çš„è¡Œä¸ºã€‚</p>
<p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»åœ¨å®éªŒå®¤ç¯å¢ƒä¸­æ‰‹åŠ¨æµ‹è¯•äº†æ˜“å—æ”»å‡»çš„OpenSSLä»£ç ï¼Œä½†æ²¡æœ‰å‘ç°æ­¤æ¼æ´ã€‚è¿™æ˜¯å› ä¸ºè¯¥æ¼æ´ä»…åœ¨ç‰¹å®šæ¡ä»¶çš„ç»„åˆä¸‹è¡¨ç°å‡ºæ¥ï¼šOpenSSLå’Œå¤–éƒ¨ä»£ç ä¹‹é—´çš„å¾®å¦™äº¤äº’ï¼Œå¹¶ä¸”ä»…åœ¨ä¸ä½¿ç”¨AES-NIçš„æƒ…å†µä¸‹æ‰ä¼šå‡ºç°ï¼Œè¿™åœ¨å½“ä»Šæ˜¯å¾ˆå°‘è§çš„ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªä¾‹è¯ï¼Œè¯´æ˜äº†å¤§è§„æ¨¡æ‰«æåœ¨æ£€æµ‹å®éªŒå®¤æµ‹è¯•æœ‰æ—¶å¯èƒ½ä¼šé—æ¼çš„æ¼æ´æ–¹é¢çš„ç”¨å¤„ã€‚</p>
<p>æˆ‘ä»¬æ€€ç–‘æ­¤OpenSSLè¡Œä¸ºæ˜¯æˆ‘ä»¬å‘ç°çš„è®¸å¤šç±»ä¼¼æ¼æ´çš„åŸºç¡€ï¼Œè€Œä¸ä»…ä»…æ˜¯æ¼æ´#15ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€æ—¦OpenSSLå‘å¸ƒä¿®è¡¥ç¨‹åºï¼Œå…¶ä»–æ¼æ´ä¹Ÿä¼šå› æ­¤å¾—åˆ°ä¿®å¤ã€‚è¯¥æ¼æ´è¢«åˆ†é…åˆ°CVE-2019-1559ã€‚</p>
</li>
<li><p><strong>IBMçš„æ¼æ´ï¼š</strong>æˆ‘ä»¬åœ¨IBMæ‰˜ç®¡çš„æœåŠ¡å™¨ä¸­å‘ç°äº†å¤šä¸ªæ¼æ´ã€‚è¡¨2ä¸­çš„å¯†ç å¥—ä»¶æŒ‡çº¹#77æè¿°äº†å…¶ä¸­ä¸€ä¸ªæ¼æ´ã€‚å¦‚æœMACæˆ–å¡«å……ä¸æ­£ç¡®ï¼Œå—å½±å“çš„æœåŠ¡å™¨ä¼šå‘å‡ºBAD_RECORD_MACè­¦æŠ¥ã€‚å¦‚æœå¡«å……æ­£ç¡®ä¸”MACä¸å®Œæ•´æˆ–ä¸å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†ä»¥DECODE_ERRORè­¦æŠ¥å“åº”ã€‚å³ä½¿è®°å½•å¤ªçŸ­è€Œä¸èƒ½åŒ…å«MACï¼Œä¹Ÿä¼šå‘ç”Ÿåä¸€ç§è¡Œä¸ºï¼Œåªè¦è®°å½•åŒ…å«è‡³å°‘ä¸¤ä¸ªå¯†æ–‡å—ï¼Œè€Œä¸ä½¿ç”¨çš„MACç®—æ³•æ— å…³ã€‚æ”»å‡»è€…åªèƒ½ä½¿ç”¨IVå‘é€ä¸¤ä¸ªå—ï¼Œè¿™ä¿è¯æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®¹çº³MACã€‚è¿™ä¸ºæ”»å‡»è€…æä¾›äº†å…¸å‹çš„CBC Padding Oracleã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª<em>strong</em> Oracleã€‚ç”±äºè­¦æŠ¥æ˜¯åŠ å¯†çš„ï¼Œå› æ­¤æˆ‘ä»¬å°†æ­¤æ¼æ´å½’ç±»ä¸ºä¸å¯å¯Ÿè§‰ï¼Œå› æ­¤æ— æ³•åˆ©ç”¨Oracleã€‚IBMå®‰å…¨å›¢é˜Ÿå†³å®šåœ¨å—å½±å“çš„æœåŠ¡å™¨ä¸Šç¦ç”¨CBCå¯†ç å¥—ä»¶ï¼Œåªæ”¯æŒAES-GCMã€‚</p>
</li>
<li><p><strong>Citrixï¼š</strong>è¡¨2ä¸­çš„å¯†ç å¥—ä»¶æŒ‡çº¹#84æ ‡è¯†äº†æè¿°çš„æ¼æ´ã€‚æ˜“å—æ”»å‡»çš„å®ç°é¦–å…ˆæ£€æŸ¥æœ€åä¸€ä¸ªå¡«å……å­—èŠ‚ï¼Œç„¶åéªŒè¯MACã€‚å¦‚æœMACæ— æ•ˆï¼ŒæœåŠ¡å™¨å°†å…³é—­è¿æ¥ã€‚è¿™æ˜¯é€šè¿‡è¿æ¥è¶…æ—¶æˆ–RSTæ¥å®Œæˆçš„ï¼Œå…·ä½“å–å†³äºå‰©ä½™å¡«å……å­—èŠ‚çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œå¦‚æœMACæœ‰æ•ˆï¼ŒæœåŠ¡å™¨ä¼šæ£€æŸ¥å…¶ä½™æ‰€æœ‰å¡«å……å­—èŠ‚æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœå®ƒä»¬ä¸æ˜¯ï¼Œåˆ™æœåŠ¡å™¨ä»¥BAD_RECORD_MACå’ŒRSTä½œä¸ºå“åº”(å¦‚æœå®ƒä»¬æœ‰æ•ˆï¼Œåˆ™è®°å½•æ ¼å¼è‰¯å¥½å¹¶è¢«æ¥å—)ã€‚æˆ‘ä»¬åœ¨å›¾7ä¸­å¯è§†åŒ–äº†è¿™ç§è¡Œä¸ºã€‚å¯ä»¥é€šè¿‡ç±»ä¼¼äºPOODLEçš„æ”»å‡»æ¥åˆ©ç”¨è¿™ç§è¡Œä¸ºã€‚å› ä¸ºOracleä¹Ÿæ˜¯å¯ä»¥è§‚å¯Ÿåˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªç¾¤ä½“æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚æˆ‘ä»¬é¦–å…ˆåœ¨Amazon WebæœåŠ¡ä¸­æ£€æµ‹åˆ°æ­¤æ¼æ´ã€‚æˆ‘ä»¬ä¸äºšé©¬é€Šå®‰å…¨å›¢é˜Ÿåˆä½œï¼Œç¡®å®šCitrix Application Delivery Controller(ADC)å’ŒNetScaler Gatewayåº”å¯¹æ­¤è¡Œä¸ºè´Ÿè´£ã€‚è¯¥æ¼æ´è¢«æŒ‡å®šä¸ºCVE-2019-6485ã€‚</p>
</li>
</ul>
<p><img src="/images/USS-2020-paper/Figure-7.jpg" alt="Figure-7ï¼šä½¿ç”¨å¯†ç å¥—ä»¶æŒ‡çº¹#84çš„Citrixå®æ–½çš„è¡Œä¸ºã€‚"></p>
<h1 id="ä¹ã€ç›¸å…³å·¥ä½œ"><a href="#ä¹ã€ç›¸å…³å·¥ä½œ" class="headerlink" title="ä¹ã€ç›¸å…³å·¥ä½œ"></a>ä¹ã€ç›¸å…³å·¥ä½œ</h1><p>ç°åœ¨ï¼Œæˆ‘ä»¬é‡ç‚¹ä»‹ç»è¿‡å»çš„å·¥ä½œï¼Œè¿™äº›å·¥ä½œä¾§é‡äºå¯¹ç°ä»£Internetä¸Šçš„æ¼æ´è¿›è¡Œå¤§è§„æ¨¡æ‰«æã€‚å¯¹äºæœ‰å…³padding oracleæ”»å‡»çš„ç›¸å…³å·¥ä½œçš„è°ƒæŸ¥ï¼Œæˆ‘ä»¬è¯·è¯»è€…å‚è€ƒç¬¬3èŠ‚ã€‚ZMap [18]æ˜¯ä¸€ç§èƒ½å¤Ÿè¾¾åˆ°è¾ƒé«˜æ‰«æé€Ÿåº¦çš„ç½‘ç»œæ‰«æä»ªã€‚ Durumericç­‰äºº[17]ä½¿ç”¨ZMapæ‰«æIPv4åœ°å€ç©ºé—´ä»¥é‡åŒ–Heartbleedæ¼æ´[32]çš„å½±å“ã€‚ Heningerç­‰äºº[19]æ‰«æTLSå’ŒSSHï¼Œä»¥æŸ¥æ‰¾ç”±äºç†µä¸è¶³è€Œäº§ç”Ÿçš„å¼±å¯†é’¥ã€‚Adrianç­‰äºº[2]å¼•å…¥äº†Logjamæ¼æ´ï¼Œå¹¶æ ¹æ®æ”»å‡»è€…çš„è®¡ç®—èµ„æºï¼Œä½¿ç”¨InternetèŒƒå›´å†…çš„æ‰«ææ¥é‡åŒ–å…¶å½±å“ã€‚ Aviramç­‰äºº[5]å¼•å…¥äº†DROWNæ¼æ´ï¼Œå¹¶ç±»ä¼¼åœ°ä½¿ç”¨äº†InternetèŒƒå›´å†…çš„æ‰«ææ¥é‡åŒ–å…¶å½±å“ã€‚ BÃ¶ckç­‰äºº[9]åƒæˆ‘ä»¬åœ¨è¿™é‡Œä¸€æ ·ï¼Œå¯¹Bleichenbacherçš„æ¼æ´è¿›è¡Œäº†å¤§è§„æ¨¡æ‰«æï¼ŒåŒæ—¶è¿˜è§‚å¯Ÿäº†è¯¸å¦‚TCPè¿æ¥çŠ¶æ€å˜åŒ–ä¹‹ç±»çš„ä¾§ä¿¡é“ã€‚ Valentaç­‰äºº[38]æ‰«æäº†æ¤­åœ†æ›²çº¿å®æ–½ä¸­çš„å·²çŸ¥æ¼æ´ï¼Œå¯»æ‰¾å¯ä»¥å¯ç”¨å¼ºå¤§æ”»å‡»çš„ç»„åˆCurveSwapã€‚</p>
<h1 id="åã€æ€»ç»“å’Œæœªæ¥å·¥ä½œ"><a href="#åã€æ€»ç»“å’Œæœªæ¥å·¥ä½œ" class="headerlink" title="åã€æ€»ç»“å’Œæœªæ¥å·¥ä½œ"></a>åã€æ€»ç»“å’Œæœªæ¥å·¥ä½œ</h1><p>è¿™é¡¹å·¥ä½œè¡¨æ˜ï¼Œç°ä»£Internetä¸Šä»ç„¶å­˜åœ¨padding oracleæ¼æ´ï¼Œå¹¶ä¸”å¾ˆå¯èƒ½ç»§ç»­å¨èƒç”¨æˆ·çš„å®‰å…¨ã€‚ è¿™äº›æ¼æ´é€šå¸¸å¾ˆéš¾è¢«å‘ç°ï¼šå®ƒä»¬å¯èƒ½ä¾èµ–äºç»†å¾®çš„ä¾§ä¿¡é“æˆ–éœ€è¦ä¸“é—¨è®¾è®¡çš„è¾“å…¥æ‰èƒ½è§¦å‘ã€‚</p>
<p>è¿‡å»ï¼Œæ–°çš„é‡å¤§TLSæ”»å‡»å¯¹ç”Ÿæ€ç³»ç»Ÿäº§ç”Ÿäº†ç§¯æå½±å“ã€‚ ä¾‹å¦‚ï¼ŒAdrianç­‰äººçš„å·¥ä½œ[2]å¯¼è‡´äº†â€œenforcementâ€å·¥ä½œï¼Œä¸»è¦çš„æµè§ˆå™¨æ”¹å˜äº†è¡Œä¸ºå¹¶æ‹’ç»è¿æ¥åˆ°å…·æœ‰å¼±DHå‚æ•°çš„æœåŠ¡å™¨ã€‚ å®‰å…¨ç¤¾åŒºå¦‚ä½•æ›´å¥½åœ°å¸®åŠ©æœåŠ¡å™¨æ“ä½œå‘˜æ£€æµ‹å’Œè¡¥æ•‘æ›´ç»†å¾®çš„æ¼æ´ï¼ˆå°¤å…¶æ˜¯CBC oracleå’Œä¸€èˆ¬çš„å…¶ä»–ç±»åˆ«çš„æ¼æ´ï¼‰æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å¼€æ”¾é—®é¢˜ã€‚</p>
<p>åœ¨CBC oracleçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å®Œå…¨ç¦æ­¢CBCå¯†ç å¥—ä»¶ã€‚ æœ€è¿‘ï¼Œä¸»è¦çš„æµè§ˆå™¨ä¾›åº”å•†å·²ç»å®£å¸ƒæ‰“ç®—åˆ é™¤å¯¹æ—§çš„1.0å’Œ1.1 TLSç‰ˆæœ¬çš„æ”¯æŒã€‚ è¿™è¿«ä½¿è®¸å¤šæœåŠ¡å™¨æ“ä½œå‘˜å‡çº§å…¶å®ç°æˆ–æ›´æ”¹é…ç½®ã€‚ ç¡®å®ï¼Œæµè§ˆå™¨ä¾›åº”å•†ä¹Ÿå¯ä»¥å–æ¶ˆå¯¹CBCå¯†ç å¥—ä»¶çš„æ”¯æŒï¼Œå†æ¬¡è¿«ä½¿æœåŠ¡å™¨è¿è¥å•†è¿›è¡Œå‡çº§ã€‚ è¿™äº›å˜åŒ–å¹¶éæ²¡æœ‰ä»£ä»·ã€‚ å®ƒä»¬é€šå¸¸éœ€è¦æå‰å‡ ä¸ªæœˆé€šçŸ¥ï¼Œå¯èƒ½éœ€è¦æµè§ˆå™¨ä¾›åº”å•†ä¹‹é—´è¿›è¡Œåè°ƒï¼Œå¹¶ä¸”æ˜¾ç„¶ä¼šä¸ºæœåŠ¡å™¨æ“ä½œè€…å¢åŠ å·¥ä½œé‡ã€‚</p>
<p>æˆ‘ä»¬çš„ç»“æœå†æ¬¡è¯å®ï¼Œå¤§è§„æ¨¡æ‰«æä½¿å‘ç°ä»¥å‰åœ¨å®éªŒå®¤æµ‹è¯•ä¸­æœªå‘ç°çš„å„ç§å®‰å…¨æ¼æ´å˜å¾—å¯è¡Œã€‚ æˆ‘ä»¬ç›¸ä¿¡ï¼Œåœ¨æ‰§è¡Œå¤§è§„æ¨¡æ‰«ææ—¶ï¼Œä¸ä»…åœ¨TLSä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚ ä¸€ä¸ªæœªè§£å†³çš„é—®é¢˜æ˜¯å¦‚ä½•ç¡®å®šæ˜“å—æ”»å‡»çš„å®ç°ç‰ˆæœ¬åŠå…¶ä¾›åº”å•†ã€‚ åœ¨SSHå’ŒIPsecåè®®ä¸­ï¼Œè¿™äº›æ•°æ®é€šå¸¸ä½œä¸ºåè®®ä¸­çš„æ¶ˆæ¯å­—æ®µè¿›è¡Œä¼ è¾“ã€‚åœ¨TLSä¸­ä¼ è¾“æ­¤ç±»æ•°æ®å°†ä½¿æŠ«éœ²æ›´å®¹æ˜“ï¼Œä½†å¦ä¸€æ–¹é¢å°†å¯¼è‡´éšç§é—®é¢˜å’Œæ›´å®¹æ˜“çš„æŒ‡çº¹è¯†åˆ«ã€‚</p>
<h1 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h1><p>æˆ‘ä»¬è¦æ„Ÿè°¢Dennis Felschï¼Œä»–åœ¨æˆ‘ä»¬çš„ç¡¬ä»¶å’Œç½‘ç»œåŸºç¡€è®¾æ–½æ–¹é¢ä¸ºæˆ‘ä»¬æä¾›äº†å¸®åŠ©ï¼Œä»¥åŠæˆ‘ä»¬çš„åŒ¿åè¯„è®ºè€…æä¾›äº†è®¸å¤šæœ‰æ´å¯ŸåŠ›çš„æ„è§ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¦æ„Ÿè°¢Amazonã€Citrixå’ŒOpenSSLå›¢é˜Ÿçš„ä¸“ä¸šå›åº”å’Œå¯¹ä¿¡æ¯æŠ«éœ²çš„å¸®åŠ©ã€‚</p>
<p>Nimrod Aviramå¾—åˆ°äº†ä»¥è‰²åˆ—ç§‘æŠ€éƒ¨çš„å¥–å­¦é‡‘ã€Check Pointä¿¡æ¯å®‰å…¨ç ”ç©¶æ‰€çš„å¥–å­¦é‡‘ä»¥åŠYitzhakå’ŒChaya Weinsteinä¿¡å·å¤„ç†ç ”ç©¶æ‰€çš„å¥–å­¦é‡‘ã€‚Juraj Somorovskyé€šè¿‡æœªæ¥ä¿¡æ‰˜é¡¹ç›®å¾—åˆ°æ¬§ç›Ÿå§”å‘˜ä¼šçš„æ”¯æŒ(èµ æ¬¾700542-æœªæ¥-ä¿¡æ‰˜-H2020-DS2015-1)ã€‚Robert Mergeté€šè¿‡SIWECOSé¡¹ç›®å¾—åˆ°äº†å¾·å›½è”é‚¦ç»æµäº‹åŠ¡å’Œèƒ½æºéƒ¨çš„æ”¯æŒï¼Œè¯¥é¡¹ç›®åä¸ºâ€œIT-Sinherheit in der Wirtschaftâ€(IT-Silherheit in der Wirtschaft)è®¡åˆ’ã€‚</p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[1] Openssl security advisory. CVE-2018-0733.</span><br><span class="line">[2] ADRIAN, D., BHARGAVAN, K., DURUMERIC, Z., GAUDRY, P., GREEN, M., HALDERMAN, J. A., HENINGER, N., SPRINGALL, D., THOMÃ‰, E., VALENTA, L., ET AL. Imperfect forward secrecy: How diffie-hellman fails in practice. In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security (2015), ACM, pp. 5â€“17.</span><br><span class="line">[3] ALBRECHT, M. R., AND PATERSON, K. G. Lucky microseconds: A timing attack on amazonâ€™s s2n implementation of TLS. In Advances in Cryptology - EUROCRYPT 2016 - 35th Annual International Conference on the Theory and Applications of Cryptographic Techniques, Vienna, Austria, May 8-12, 2016, Proceedings, Part I (2016), pp. 622â€“643.</span><br><span class="line">[4] ALFARDAN, N. J., AND PATERSON, K. G. Lucky Thirteen: Breaking the TLS and DTLS Record Protocols. 2013 IEEE Symposium on Security and Privacy 0 (2013), 526â€“540.</span><br><span class="line">http:&#x2F;&#x2F;www.isg.rhul.ac.uk&#x2F;tls&#x2F;TLStiming.pdf.</span><br><span class="line">[5] AVIRAM, N., SCHINZEL, S., SOMOROVSKY, J., HENINGER, N., DANKEL, M., STEUBE, J., VALENTA, L., ADRIAN, D., HALDERMAN, J. A., DUKHOVNI, V., KÃ„SPER, E., COHNEY, S., ENGELS, S., PAAR, C., AND SHAVITT, Y. DROWN: Breaking TLS Using SSLv2. In 25th USENIX Security Symposium (USENIX Security 16) (Austin, TX, Aug. 2016), pp. 689â€“706.</span><br><span class="line">[6] BARDOU, R., FOCARDI, R., KAWAMOTO, Y., STEEL, G., AND TSAY, J.-K. Efficient Padding Oracle Attacks on Cryptographic Hardware. In Advances in Cryptology â€“ CRYPTO (2012), Canetti and R. Safavi-Naini, Eds.</span><br><span class="line">[7] BENJAMIN, D. Tls ecosystem woes, Jan. 2018. Real World Crypto Symposium.</span><br><span class="line">[8] BLEICHENBACHER, D.</span><br><span class="line">Chosen ciphertext attacks against protocols based on the RSA encryption standard PKCS #1.</span><br><span class="line">In Advances in Cryptology â€” CRYPTO â€™98, vol. 1462 of Lecture Notes in Computer Science. Springer Berlin &#x2F; Heidelberg, 1998.</span><br><span class="line">[9] BÃ–CK, H., SOMOROVSKY, J., AND YOUNG, C. Return of bleichenbacherâ€™s oracle threat (ROBOT). In 27th USENIX Security Symposium (USENIX Security 18) (Baltimore, MD, 2018), USENIX Association, pp. 817â€“849.</span><br><span class="line">[10] BÃ–CK, H.</span><br><span class="line">A little POODLE left in GnuTLS (old versions), Nov. 2015. https:&#x2F;&#x2F;blog.hboeck.de&#x2F;archives&#x2F; 877-A-little-POODLE-left-in-GnuTLS-old-versions.</span><br><span class="line">html.</span><br><span class="line">[11] CANVEL, B., HILTGEN, A., VAUDENAY, S., AND VUAGNOUX, M. Password Interception in a SSL&#x2F;TLS Channel. In Advances in Cryptology - CRYPTO 2003, vol. 2729 of Lecture Notes in Computer Science. Springer Berlin &#x2F; Heidelberg, Aug. 2003.</span><br><span class="line">[12] DIERKS, T., AND ALLEN, C. The TLS Protocol Version 1.0.</span><br><span class="line">RFC 2246 (Proposed Standard), Jan. 1999. Obsoleted by RFC 4346, updated by RFCs 3546, 5746, 6176, 7465, 7507.</span><br><span class="line">[13] DIERKS, T., AND RESCORLA, E. The Transport Layer Security (TLS) Protocol Version 1.1. RFC 4346 (Proposed Standard), Apr. 2006. Obsoleted by RFC 5246, updated by RFCs 4366, 4680, 4681, 5746, 6176, 7465, 7507.</span><br><span class="line">[14] DIERKS, T., AND RESCORLA, E. The Transport Layer Security (TLS) Protocol Version 1.2. RFC 5246 (Proposed Standard), Aug. 2008. Updated by RFCs 5746, 5878, 6176, 7465, 7507, 7568, 7627, 7685.</span><br><span class="line">[15] DUONG, T., AND RIZZO, J. Cryptography in the web: The case of cryptographic design flaws in ASP.NET. In IEEE Symposium on Security and Privacy (2011).</span><br><span class="line">[16] DURUMERIC, Z., ADRIAN, D., MIRIAN, A., BAILEY, M., AND HALDERMAN, J. A.</span><br><span class="line">A search engine backed by Internet-wide scanning. In 22nd ACM Conference on Computer and Communications Security (Oct. 2015).</span><br><span class="line">[17] DURUMERIC, Z., LI, F., KASTEN, J., AMANN, J., BEEKMAN, J., PAYER, M., WEAVER, N., ADRIAN, D., PAXSON, V., BAILEY, M., ET AL. The matter of heartbleed. In Proceedings of the 2014 conference on internet measurement conference (2014), ACM, pp. 475â€“488.</span><br><span class="line">[18] DURUMERIC, Z., WUSTROW, E., AND HALDERMAN, J. A.</span><br><span class="line">Zmap: Fast internet-wide scanning and its security applications.</span><br><span class="line">[19] HENINGER, N., DURUMERIC, Z., WUSTROW, E., AND HALDERMAN, J. A. Mining your ps and qs: Detection of widespread weak keys in network devices.</span><br><span class="line">[20] IRAZOQUI, G., INCI, M. S., EISENBARTH, T., AND SUNAR, B. Lucky 13 strikes back. In Proceedings of the 10th ACM Symposium on Information, Computer and Communications Security (New York, NY, USA, 2015), ASIA CCS â€™15, ACM, pp. 85â€“96.</span><br><span class="line">[21] JACOMY, M., VENTURINI, T., HEYMANN, S., AND BASTIAN, M. Forceatlas2, a continuous graph layout algorithm for handy network visualization designed for the gephi software. PLOS ONE 9, 6 (06 2014), 1â€“12.</span><br><span class="line">[22] JAGER, T., SCHINZEL, S., AND SOMOROVSKY, J. Bleichenbacherâ€™s attack strikes again: breaking PKCS#1 v1.5 in XML Encryption. In Computer Security - ESORICS 2012 - 17th European Symposium on Research in Computer Security, Pisa, Italy, September 10-14, 2012. Proceedings (2012), S. Foresti and M. Yung, Eds., LNCS, Springer.</span><br><span class="line">[23] JAGER, T., AND SOMOROVSKY, J. How To Break XML Encryption. In The 18th ACM Conference on Computer and Communications Security (CCS) (Oct. 2011).</span><br><span class="line">[24] LABS, A. W. S. s2n: An implementation of the tls&#x2F;ssl protocols.</span><br><span class="line">[25] LANGLEY, A.</span><br><span class="line">The POODLE bites again, Nov. 2014.</span><br><span class="line">https:&#x2F;&#x2F;www.imperialviolet.org&#x2F;2014&#x2F;12&#x2F;08&#x2F; poodleagain.html.</span><br><span class="line">[26] MEYER, C., SOMOROVSKY, J., WEISS, E., SCHWENK, J., SCHINZEL, S., AND TEWS, E. Revisiting SSL&#x2F;TLS Implementations: New Bleichenbacher Side Channels and Attacks.</span><br><span class="line">In 23rd USENIX Security Symposium, San Diego, USA (August 2014).</span><br><span class="line">[27] MÃ–LLER, B., DUONG, T., AND KOTOWICZ, K. This POODLE bites: exploiting the SSL 3.0 fallback, 2014.</span><br><span class="line">[28] PETTERSSEN, Y. The POODLE has friends.</span><br><span class="line">[29] PETTERSSEN, Y. There are more POODLEs in the forest.</span><br><span class="line">[30] POPOV, A. Prohibiting RC4 Cipher Suites. RFC 7465 (Proposed Standard), Feb. 2015.</span><br><span class="line">[31] RESCORLA, E. The Transport Layer Security (TLS) Protocol Version 1.3. RFC 8446, 2018.</span><br><span class="line">[32] RIKU, ANTTI, MATTI, AND MEHTA. Heartbleed, cve-20140160, 2015. http:&#x2F;&#x2F;heartbleed.com&#x2F;.</span><br><span class="line">[33] RIZZO, J., AND DUONG, T.</span><br><span class="line">Practical padding oracle attacks. In Proceedings of the 4th USENIX conference on Offensive technologies (Berkeley, CA, USA, 2010), WOOTâ€™10, USENIX Association, pp. 1â€“8.</span><br><span class="line">[34] RIZZO, J., AND DUONG, T. Here Come The XOR Ninjas, May 2011.</span><br><span class="line">[35] RONEN, E., PATERSON, K. G., AND SHAMIR, A. Pseudo constant time implementations of tls are only pseudo secure. In Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security (2018), ACM, pp. 1397â€“1414.</span><br><span class="line">[36] SCHEITLE, Q., HOHLFELD, O., GAMBA, J., JELTEN, J., ZIMMERMANN, T., STROWES, S. D., AND VALLINARODRIGUEZ, N. A Long Way to the Top: Significance, Structure, and Stability of Internet Top Lists. In Internet Measurement Conference (IMCâ€™18), IMCâ€™18 Community Contribution Award (Boston, USA, Nov. 2018), ACM, pp. 478â€“493.</span><br><span class="line">[37] SOMOROVSKY, J. Systematic fuzzing and testing of tls libraries. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security (2016), ACM, pp. 1492â€“1504.</span><br><span class="line">[38] VALENTA, L., SULLIVAN, N., SANSO, A., AND HENINGER, N. In search of curveswap: Measuring elliptic curve implementations in the wild. In 2018 IEEE European Symposium on Security and Privacy (EuroS&amp;P) (2018), IEEE, pp. 384â€“398.</span><br><span class="line">[39] VAUDENAY, S. Security Flaws Induced by CBC Padding â€”Applications to SSL, IPSEC, WTLS... In Advances in Cryptology â€” EUROCRYPT 2002, vol. 2332 of Lecture Notes in Computer Science. Springer Berlin &#x2F; Heidelberg, Apr. 2002.</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>paper</tag>
      </tags>
  </entry>
  <entry>
    <title>TLS1.2 RFC-5246æ–‡æ¡£ç¿»è¯‘å­¦ä¹ </title>
    <url>/2021/05/20/TLS1-2-RFC-5246%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.rfc-editor.org/info/rfc5246">RFC-5246</a></p>
<ul>
<li><strong>æ–‡ç« ç»“æ„è¯·çœ‹å³è¾¹çš„ç›®å½•</strong>ğŸ‘‰</li>
</ul>
]]></content>
      <tags>
        <tag>RFC6246</tag>
        <tag>TLS1.2</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œé€ä½ ä¸€æœµå°çº¢èŠ±ã€</title>
    <url>/2021/04/26/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/</url>
    <content><![CDATA[<p><img src="https://img0.utuku.china.com/550x0/ent/20200612/8f5ba9c8-3738-4c6f-bc10-9c64c27d1c58.jpg"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC17.JPG" alt="LHC17"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC16.JPG" alt="LHC16"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC15.JPG" alt="LHC15"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC14.JPG" alt="LHC14"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC13.jpg" alt="LHC13"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC12.jpg" alt="LHC12"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC11.jpg" alt="LHC11"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC10.JPG" alt="LHC10"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC9.jpg" alt="LHC9"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC8.jpg" alt="LHC8"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC6.GIF" alt="LHC6"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC5.jpg" alt="LHC5"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC4.JPG" alt="LHC4"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/LHC3.jpg" alt="LHC3"></p>
<p><img src="../images/%E3%80%8C%E9%80%81%E4%BD%A0%E4%B8%80%E6%9C%B5%E5%B0%8F%E7%BA%A2%E8%8A%B1%E3%80%8D/run&start%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB.jpg" alt="run&amp;startæ–¹æ³•åŒºåˆ«"></p>
]]></content>
      <tags>
        <tag>movie</tag>
      </tags>
  </entry>
  <entry>
    <title>å›½å¯†ç®—æ³•/åè®®/å·¥æ§</title>
    <url>/2021/04/28/%E5%9B%BD%E5%AF%86%E7%AE%97%E6%B3%95-%E5%8D%8F%E8%AE%AE-%E5%B7%A5%E6%8E%A7/</url>
    <content><![CDATA[<h1 id="å›½å¯†SSL-TLS"><a href="#å›½å¯†SSL-TLS" class="headerlink" title="å›½å¯†SSL/TLS"></a>å›½å¯†SSL/TLS</h1><p>ğŸŒŸğŸŒŸğŸŒŸ<a href="https://www.gmssl.cn/gmssl/index.jsp?go=down">å›½å¯†SSLå®éªŒå®¤</a>ï¼ˆé‡ç‚¹ï¼‰ï¼šå¥½å¤šä½¿ç”¨çš„å·¥å…·ï¼ŒåŒ…æ‹¬å›½å¯†Webæµè§ˆå™¨ã€å›½å¯†WebæœåŠ¡å™¨ã€å›½å¯†æ€§èƒ½æµ‹è¯•ã€å›½å¯†å·¥å…·ç®±ç­‰ç­‰ã€‚å¯ä»¥ä»è¿™é‡Œé¢ä¸‹è½½WebæœåŠ¡å™¨ï¼Œæ­å»ºå¹¶è¿›è¡ŒTLS-Attackerçš„æµ‹è¯•ã€‚ä¸€ä¸ª<a href="https://developer.aliyun.com/article/770830">é˜¿é‡Œäº‘çš„å®æˆ˜åšå®¢</a>ï¼Œè¯¥åšå®¢å®æˆ˜äº†GMSSLçš„Nginxå®‰è£…å’Œä½¿ç”¨ã€‚ä¸€ä¸ªç›¸å…³æµ‹è¯•çš„ä¸“æ æ–‡ç« -<a href="https://segmentfault.com/a/1190000024448440">å›½å¯†SSLä¹‹æ€§èƒ½æµ‹è¯•</a>ã€‚</p>
<p>ä¸€ä¸ªåœ¨çº¿å·¥å…·ï¼š<a href="https://myssl.com/">SSL/TLSå®‰å…¨è¯„ä¼°æŠ¥å‘Š-åœ¨çº¿ç½‘ç«™æ£€æµ‹</a>ã€‚å…¶æ”¯æŒå›½å¯†HTTPSçš„æ£€æµ‹åˆ†æã€‚</p>
<p>æ±Ÿå—å¤©å®‰<a href="https://github.com/jntass">Githubä¸»é¡µ-jntass</a>ï¼šæä¾›æºç ä¸‹è½½å’ŒNginxæœåŠ¡å™¨çš„å®‰è£…ã€‚</p>
<p><a href="http://gmssl.org/">GmSSL</a>ï¼šæ”¯æŒå›½å¯†çš„å¯†ç å·¥å…·ç®±ï¼ŒGmSSLä½œè€…å…³å¿—æ•™æˆçš„Githubä¸»é¡µï¼š<a href="https://github.com/guanzhi">GmSSL-guanzhi</a>ã€‚å…¶ä¸­å…³å¿—æ•™æˆå°†<a href="https://github.com/guanzhi/GM-Standards">GM-Standards</a>éƒ½åˆ—äº†å‡ºæ¥ï¼Œæ‰€æœ‰å›½å¯†è¡Œä¸šçš„æ ‡å‡†pdfã€‚</p>
<p><a href="https://www.doubleca.com/test_toIndexPage.action">å¤§å®CAæ•°å­—è¯ä¹¦æµ‹è¯•å¹³å°</a>ï¼ˆå·¥å…·å¹³å°/Java/æœåŠ¡å™¨ï¼‰ï¼šè¯¥å¹³å°æœ‰Javaå›½å¯†ç®—æ³•åŸºæœ¬ç»„ä»¶ï¼ˆJSEï¼‰ï¼Œæœ‰Javaå›½å¯†SSLç®—æ³•åŸºç¡€å¥—ä»¶ï¼Œæœ‰å›½å¯†SSLè§„èŒƒçš„Tomcatç»„ä»¶ï¼Œæœ‰å›½å¯†SSLè§„èŒƒNginxæœåŠ¡å™¨ã€‚</p>
<h1 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h1><h2 id="ç¬¬ä¸€æ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰ï¼š"><a href="#ç¬¬ä¸€æ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰ï¼š" class="headerlink" title="ç¬¬ä¸€æ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰ï¼š"></a>ç¬¬ä¸€æ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰ï¼š</h2><ul>
<li><a href="https://developer.aliyun.com/article/770830">å›½å¯†SSLåè®®ä¹‹Nginxé›†æˆ</a>ï¼šç»“åˆå‰é¢çš„<em>å›½å¯†SSLå®éªŒå®¤</em>è¿›è¡Œï¼Œåœ¨CentOS 7ç¯å¢ƒä¸Šå®éªŒ<del>ï¼ˆå¤±è´¥ï¼‰</del></li>
</ul>
<ol>
<li>å…ˆåœ¨å›½å¯†SSLå®éªŒå®¤å®˜ç½‘ä¸‹è½½å›½å¯†WebæœåŠ¡å™¨ï¼šgmssl_openssl_1.1_b4.tar.gz</li>
<li>åœ¨CentOS8è™šæ‹Ÿæœºä¸­ï¼Œè§£å‹æ–‡ä»¶åˆ°/usr/localç›®å½•ä¸‹é¢ï¼Œè§£å‹åæ–‡ä»¶ä¸º/gmssl</li>
<li>ä»Nginxå®˜ç½‘ä¸‹è½½Nginxï¼šnginx-1.18.0.tar.gzï¼Œå°†confä¸­çš„OPENSSLä½ç½®è¿›è¡Œæ›´æ”¹ï¼ˆè¿™é‡Œæ”¹æ–‡ä»¶å‡ºäº†ä¸€ç‚¹å°å·®é”™ï¼Œè¿˜å¥½çœ‹å‡ºæ¥å¹¶è§£å†³äº†ï¼‰</li>
<li>ä»GMSSLä¸­ç”Ÿæˆè¯ä¹¦ï¼Œç„¶åå¼€å¯nginxæœåŠ¡</li>
<li>ä¸‹è½½360æé€Ÿæµè§ˆå™¨ï¼Œè®¿é—®centosæœåŠ¡å™¨çš„åœ°å€ã€‚å‡ºé”™è¯¯äº†ï¼Œåœ¨è¿™é‡Œè®¿é—®CentOSçš„IPåœ°å€å¹¶ä¸èƒ½æˆåŠŸè¿›è¡Œè®¿é—®ã€‚è¿™é‡Œèƒ½æ­£å¸¸è®¿é—®httpä½†æ˜¯ä¸èƒ½è®¿é—®httpsï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸è¡Œï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯æµè§ˆå™¨çš„é—®é¢˜ã€‚æ— æ³•è§£å†³ï¼Œæ¢ä¸€ä¸ªç¯å¢ƒã€‚</li>
</ol>
<h2 id="ç¬¬äºŒæ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆGmSSL-å…³å¿—æ•™æˆï¼‰ï¼š"><a href="#ç¬¬äºŒæ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆGmSSL-å…³å¿—æ•™æˆï¼‰ï¼š" class="headerlink" title="ç¬¬äºŒæ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆGmSSL-å…³å¿—æ•™æˆï¼‰ï¼š"></a>ç¬¬äºŒæ¬¡GmSSLç¯å¢ƒæ­å»ºå®éªŒï¼ˆGmSSL-å…³å¿—æ•™æˆï¼‰ï¼š</h2><ul>
<li><a href="https://cloud.tencent.com/developer/article/1597165">æ­å»ºå›½å¯†SSLå¼€å‘æµ‹è¯•ç¯å¢ƒ</a>ï¼šç»“åˆå‰é¢çš„<em><strong>GmSSL-å…³å¿—æ•™å¸ˆ-Github</strong></em>è¿›è¡Œï¼Œåœ¨CentOS 7ç¯å¢ƒä¸Šè¿›è¡Œå®éªŒ<strong>ï¼ˆæˆåŠŸï¼‰</strong></li>
</ul>
<ol>
<li>å†³å®šæ¢ä¸€ä¸ªï¼Œæ¢æˆguanzhiçš„GmSSLç¯å¢ƒæ­å»ºï¼Œè¯•ä¸€ä¸‹æœ‰æ— ç”¨ï¼Œå¦‚æœåœ¨ä¸è¡Œï¼Œå°±æ¢æˆTaSSLçš„ç¯å¢ƒã€‚</li>
<li>å…ˆå®‰è£…CentOS 7ï¼Œæ¥ä¸‹æ¥å®‰è£…ç›¸å…³è½¯ä»¶ï¼ŒOpensslã€Gccã€GmSSLï¼Œç¯å¢ƒéƒ½æ­å»ºå¥½äº†ï¼Œä¸”éƒ½èƒ½æˆåŠŸè¿è¡Œæµ‹è¯•ã€‚</li>
<li>æ¥ä¸‹æ¥è¿›è¡Œserverçš„åˆ›å»ºï¼Œç„¶åæœ¬åœ°è¿æ¥æœåŠ¡å™¨ï¼Œè¿›è¡Œå›½å¯†SSLæµ‹è¯•</li>
<li>å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æç¤ºlibcrypto.so.1.1å’Œlibssl.so.1.1æ–‡ä»¶æœ‰é—®é¢˜ã€‚è¿™é‡Œæ‰“ç®—é‡æ–°å®‰è£…dç‰ˆæœ¬çš„opensslè¯•ä¸€ä¸‹æ˜¯å¦æœ‰é”™è¯¯ã€‚è¿™æ¬¡é‡è£…äº†ä¸€æ¬¡GmSSLä¹‹åï¼Œå°±æ²¡æœ‰å‡ºç°é”™è¯¯äº†ã€‚</li>
<li>å¼€å§‹æ‰“å¼€GmSSLçš„æœåŠ¡ç«¯ï¼Œè¯•ä¸€ä¸‹å›½å¯†æµè§ˆå™¨æ˜¯å¦èƒ½è¿æ¥ã€‚</li>
<li>åˆå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸»æœºä¸Šå¹¶ä¸èƒ½è®¿é—®è™šæ‹Ÿæœºopensslçš„ipåœ°å€ï¼Œè¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œèƒ½ç›¸äº’pingé€šï¼Œä½†æ˜¯ä¸èƒ½åœ¨ä¸»æœºæµè§ˆå™¨ä¸Šè¿›è¡Œè®¿é—®ï¼Œä½†æ˜¯èƒ½åœ¨è™šæ‹Ÿæœºä¸Šå¯¹æœ¬åœ°è¿›è¡Œè¿æ¥ã€‚å°è¯•å…³é—­è™šæ‹Ÿæœºçš„é˜²ç«å¢™ä¹‹åï¼Œä¸»æœºèƒ½å¯¹è™šæ‹Ÿæœºè¿›è¡Œæ­£å¸¸è®¿é—®ã€‚</li>
<li>é€šè¿‡åœ¨Macä¸Šä¸‹è½½GmBrowserå¹¶ä¸”è®¿é—®CentOSæœåŠ¡å™¨çš„åœ°å€ï¼ŒæˆåŠŸè¿›è¡Œå›½å¯†è¿æ¥ã€‚</li>
<li>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨TLS-Attackerå’ŒTLS-Scnnerå¯¹æœ¬åœ°ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚å¼€å§‹ç€æ‰‹TLS-Attackerå’ŒTLS-Scannerçš„ç†Ÿæ‚‰å’Œç¼–ç¨‹ä¿®æ”¹ä¼˜åŒ–ã€‚</li>
</ol>
<h2 id="ç¬¬ä¸‰æ¬¡GMSSLç¯å¢ƒæ­å»ºï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰"><a href="#ç¬¬ä¸‰æ¬¡GMSSLç¯å¢ƒæ­å»ºï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰" class="headerlink" title="ç¬¬ä¸‰æ¬¡GMSSLç¯å¢ƒæ­å»ºï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰"></a>ç¬¬ä¸‰æ¬¡GMSSLç¯å¢ƒæ­å»ºï¼ˆå›½å¯†SSLå®éªŒå®¤ï¼‰</h2><p>ç»“åˆå‰é¢çš„<em>å›½å¯†SSLå®éªŒå®¤</em>è¿›è¡Œï¼Œåœ¨CentOS 7ç¯å¢ƒä¸Šå®éªŒï¼ˆ<strong>æˆåŠŸ</strong>ï¼‰</p>
<p>ä¸»è¦æ˜¯åœ¨å¤–éƒ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œæ­å»ºæµ‹è¯•ï¼Œè¿™æ¬¡æµ‹è¯•äº†2ç§æ­å»ºï¼ˆç‰¹æ®Šï¼šè¿™ä¸ªæ”¯æŒCBCæ¨¡å¼ï¼‰</p>
<ol>
<li><p>Nginxï¼ˆå›½å¯†ç‰ˆï¼‰æ­å»ºï¼ˆå®Œæˆï¼‰</p>
</li>
<li><p>Apacheï¼ˆå›½å¯†ç‰ˆï¼‰æ­å»ºï¼ˆå®Œæˆï¼‰</p>
</li>
<li><p>å›½å¯†HTTPSåœ¨çº¿Demoï¼ˆå®Œæˆï¼‰ï¼ŒDemoå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/images/%E5%9B%BD%E5%AF%86%E7%AE%97%E6%B3%95-%E5%8D%8F%E8%AE%AE-%E5%B7%A5%E6%8E%A7/%E5%9B%BD%E5%AF%86HTTPS%E5%9C%A8%E7%BA%BFDemo.png" alt="å›½å¯†HTTPSåœ¨çº¿Demo"></p>
</li>
</ol>
<h2 id="æ­£å¼å®éªŒè®°å½•ï¼š"><a href="#æ­£å¼å®éªŒè®°å½•ï¼š" class="headerlink" title="æ­£å¼å®éªŒè®°å½•ï¼š"></a>æ­£å¼å®éªŒè®°å½•ï¼š</h2><ol>
<li><p>å…ˆç†Ÿæ‚‰GmSSLçš„ç”Ÿæˆè¯ä¹¦ä»¥åŠå›½å¯†ç®—æ³•ç»„ä»¶</p>
<ul>
<li>æ–°å¢å›½å¯†å¯†ç å¥—ä»¶å¦‚ä¸‹ï¼Œæœ‰å¯¹åº”çš„16è¿›åˆ¶è¡¨ç¤º</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> 1 ECDHE-SM1-SM3   0xE001</span><br><span class="line"> 2 ECC-SM1-SM3     0xE003</span><br><span class="line"> 3 IBSDH-SM1-SM3   0xE005</span><br><span class="line"> 4 IBC-SM1-SM3     0xE007</span><br><span class="line"> 5 RSA-SM1-SM3     0xE009</span><br><span class="line"> 6 RSA-SM1-SHA1    0xE00A</span><br><span class="line"> 7 ECDHE-SM4-SM3   0xE011</span><br><span class="line"> 8 ECC-SM4-SM3     0xE013</span><br><span class="line"> 9 IBSDH-SM4-SM3   0xE015</span><br><span class="line">10 IBC-SM4-SM3     0xE017</span><br><span class="line">11 RSA-SM4-SM3     0xE019</span><br><span class="line">12 RSA-SM4-SHA1    0xE01A</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gmsslå¯¹å›½æ ‡æ”¯æŒ</span><br><span class="line"></span><br><span class="line">gmssl ciphers -V |grep GMTLS</span><br><span class="line">0xE0,0x17 - SM9-WITH-SMS4-SM3 GMTLSv1.1 Kx&#x3D;SM9 Au&#x3D;SM9 Enc&#x3D;SMS4(128) Mac&#x3D;SM3</span><br><span class="line">0xE0,0x15 - SM9DHE-WITH-SMS4-SM3 GMTLSv1.1 Kx&#x3D;SM9DHE Au&#x3D;SM9 Enc&#x3D;SMS4(128) Mac&#x3D;SM3</span><br><span class="line">0xE0,0x13 - SM2-WITH-SMS4-SM3 GMTLSv1.1 Kx&#x3D;SM2 Au&#x3D;SM2 Enc&#x3D;SMS4(128) Mac&#x3D;SM3</span><br><span class="line">0xE0,0x11 - SM2DHE-WITH-SMS4-SM3 GMTLSv1.1 Kx&#x3D;SM2DHE Au&#x3D;SM2 Enc&#x3D;SMS4(128) Mac&#x3D;SM3</span><br><span class="line">0xE0,0x1A - RSA-WITH-SMS4-SHA1 GMTLSv1.1 Kx&#x3D;RSA Au&#x3D;RSA Enc&#x3D;SMS4(128) Mac&#x3D;SHA1</span><br><span class="line">0xE0,0x19 - RSA-WITH-SMS4-SM3 GMTLSv1.1 Kx&#x3D;RSA Au&#x3D;RSA Enc&#x3D;SMS4(128) Mac&#x3D;SM3</span><br></pre></td></tr></table></figure>

<p>GMBrosweré“¾æ¥GMæœåŠ¡å™¨ä¹‹åç½‘é¡µæ˜¾ç¤ºçš„å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">s_server -key user.key -cert user_cert.pem -port 44330 -www -debug </span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Ciphers supported in s_server binary</span><br><span class="line">TLSv1.2    :ECDHE-ECDSA-AES256-GCM-SHA384 TLSv1.2    :ECDHE-RSA-AES256-GCM-SHA384 </span><br><span class="line">TLSv1.2    :DHE-RSA-AES256-GCM-SHA384 TLSv1.2    :ECDHE-ECDSA-CHACHA20-POLY1305 </span><br><span class="line">TLSv1.2    :ECDHE-RSA-CHACHA20-POLY1305 TLSv1.2    :DHE-RSA-CHACHA20-POLY1305 </span><br><span class="line">TLSv1.2    :ECDHE-ECDSA-AES128-GCM-SHA256 TLSv1.2    :ECDHE-RSA-AES128-GCM-SHA256 </span><br><span class="line">TLSv1.2    :DHE-RSA-AES128-GCM-SHA256 TLSv1.2    :ECDHE-SM2-WITH-SMS4-GCM-SM3 </span><br><span class="line">TLSv1.2    :ECDHE-ECDSA-AES256-SHA384 TLSv1.2    :ECDHE-RSA-AES256-SHA384   </span><br><span class="line">TLSv1.2    :DHE-RSA-AES256-SHA256     TLSv1.2    :ECDHE-ECDSA-AES128-SHA256 </span><br><span class="line">TLSv1.2    :ECDHE-RSA-AES128-SHA256   TLSv1.2    :DHE-RSA-AES128-SHA256     </span><br><span class="line">TLSv1.2    :ECDHE-SM2-WITH-SMS4-SM3   SSLv3      :ECDHE-ECDSA-AES256-SHA    </span><br><span class="line">SSLv3      :ECDHE-RSA-AES256-SHA      SSLv3      :DHE-RSA-AES256-SHA        </span><br><span class="line">SSLv3      :ECDHE-ECDSA-AES128-SHA    SSLv3      :ECDHE-RSA-AES128-SHA      </span><br><span class="line">SSLv3      :DHE-RSA-AES128-SHA        TLSv1.2    :RSA-PSK-AES256-GCM-SHA384 </span><br><span class="line">TLSv1.2    :DHE-PSK-AES256-GCM-SHA384 TLSv1.2    :RSA-PSK-CHACHA20-POLY1305 </span><br><span class="line">TLSv1.2    :DHE-PSK-CHACHA20-POLY1305 TLSv1.2    :ECDHE-PSK-CHACHA20-POLY1305 </span><br><span class="line">TLSv1.2    :AES256-GCM-SHA384         TLSv1.2    :PSK-AES256-GCM-SHA384     </span><br><span class="line">TLSv1.2    :PSK-CHACHA20-POLY1305     TLSv1.2    :RSA-PSK-AES128-GCM-SHA256 </span><br><span class="line">TLSv1.2    :DHE-PSK-AES128-GCM-SHA256 TLSv1.2    :AES128-GCM-SHA256         </span><br><span class="line">TLSv1.2    :PSK-AES128-GCM-SHA256     TLSv1.2    :AES256-SHA256             </span><br><span class="line">TLSv1.2    :AES128-SHA256             TLSv1.0    :ECDHE-PSK-AES256-CBC-SHA384 </span><br><span class="line">SSLv3      :ECDHE-PSK-AES256-CBC-SHA  SSLv3      :SRP-RSA-AES-256-CBC-SHA   </span><br><span class="line">SSLv3      :SRP-AES-256-CBC-SHA       TLSv1.0    :RSA-PSK-AES256-CBC-SHA384 </span><br><span class="line">TLSv1.0    :DHE-PSK-AES256-CBC-SHA384 SSLv3      :RSA-PSK-AES256-CBC-SHA    </span><br><span class="line">SSLv3      :DHE-PSK-AES256-CBC-SHA    SSLv3      :AES256-SHA                </span><br><span class="line">TLSv1.0    :PSK-AES256-CBC-SHA384     SSLv3      :PSK-AES256-CBC-SHA        </span><br><span class="line">TLSv1.0    :ECDHE-PSK-AES128-CBC-SHA256 SSLv3      :ECDHE-PSK-AES128-CBC-SHA  </span><br><span class="line">SSLv3      :SRP-RSA-AES-128-CBC-SHA   SSLv3      :SRP-AES-128-CBC-SHA       </span><br><span class="line">TLSv1.0    :RSA-PSK-AES128-CBC-SHA256 TLSv1.0    :DHE-PSK-AES128-CBC-SHA256 </span><br><span class="line">SSLv3      :RSA-PSK-AES128-CBC-SHA    SSLv3      :DHE-PSK-AES128-CBC-SHA    </span><br><span class="line">TLSv1.0    :ECDHE-PSK-WITH-SMS4-CBC-SM3 GMTLSv1.1  :SM9-WITH-SMS4-SM3         </span><br><span class="line">GMTLSv1.1  :SM9DHE-WITH-SMS4-SM3      GMTLSv1.1  :SM2-WITH-SMS4-SM3         </span><br><span class="line">GMTLSv1.1  :SM2DHE-WITH-SMS4-SM3      SSLv3      :AES128-SHA                </span><br><span class="line">GMTLSv1.1  :RSA-WITH-SMS4-SHA1        GMTLSv1.1  :RSA-WITH-SMS4-SM3         </span><br><span class="line">TLSv1.0    :PSK-AES128-CBC-SHA256     SSLv3      :PSK-AES128-CBC-SHA        </span><br><span class="line">SSLv3      :PSK-WITH-SMS4-CBC-SM3     </span><br><span class="line">---</span><br><span class="line">Ciphers common between both SSL end points:</span><br><span class="line">ECDHE-ECDSA-AES128-GCM-SHA256 ECDHE-RSA-AES128-GCM-SHA256 ECDHE-ECDSA-AES256-GCM-SHA384</span><br><span class="line">ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-CHACHA20-POLY1305 ECDHE-RSA-CHACHA20-POLY1305</span><br><span class="line">ECDHE-RSA-AES128-SHA       ECDHE-RSA-AES256-SHA       ECDHE-SM2-WITH-SMS4-SM3   </span><br><span class="line">AES128-GCM-SHA256          AES256-GCM-SHA384          AES128-SHA                </span><br><span class="line">AES256-SHA</span><br><span class="line">Signature Algorithms: ECDSA+SHA256:0x04+0x08:RSA+SHA256:SM2+SM3:ECDSA+SHA384:0x05+0x08:RSA+SHA384:0x06+0x08:RSA+SHA512:RSA+SHA1</span><br><span class="line">Shared Signature Algorithms: ECDSA+SHA256:RSA+SHA256:SM2+SM3:ECDSA+SHA384:RSA+SHA384:RSA+SHA512:RSA+SHA1</span><br><span class="line">Supported Elliptic Curves: 0x7A7A:X25519:P-256:P-384:SM2</span><br><span class="line">Shared Elliptic curves: X25519:P-256:P-384:SM2</span><br><span class="line">---</span><br><span class="line">New, TLSv1.2, Cipher is ECDHE-SM2-WITH-SMS4-SM3</span><br><span class="line">SSL-Session:</span><br><span class="line">    Protocol  : TLSv1.2</span><br><span class="line">    Cipher    : ECDHE-SM2-WITH-SMS4-SM3</span><br><span class="line">    Session-ID: </span><br><span class="line">    Session-ID-ctx: 01000000</span><br><span class="line">    Master-Key: 7C4F28BB5846F9DFE42BFD295E441A8520D50A3FA0E9D6C51C31AA3C153A69C46126ADE3CC77D6074F8127B2C93043A6</span><br><span class="line">    PSK identity: None</span><br><span class="line">    PSK identity hint: None</span><br><span class="line">    SRP username: None</span><br><span class="line">    Start Time: 1620646292</span><br><span class="line">    Timeout   : 7200 (sec)</span><br><span class="line">    Verify return code: 0 (ok)</span><br><span class="line">    Extended master secret: yes</span><br><span class="line">---</span><br><span class="line">   0 items in the session cache</span><br><span class="line">   0 client connects (SSL_connect())</span><br><span class="line">   0 client renegotiates (SSL_connect())</span><br><span class="line">   0 client connects that finished</span><br><span class="line">   1 server accepts (SSL_accept())</span><br><span class="line">   0 server renegotiates (SSL_accept())</span><br><span class="line">   1 server accepts that finished</span><br><span class="line">   0 session cache hits</span><br><span class="line">   1 session cache misses</span><br><span class="line">   0 session cache timeouts</span><br><span class="line">   0 callback cache hits</span><br><span class="line">   0 cache full overflows (128 allowed)</span><br><span class="line">---</span><br><span class="line">no client certificate available</span><br></pre></td></tr></table></figure></li>
<li><p>GmSSLå›½å¯†è¯ä¹¦ç”Ÿæˆä»¥åŠå•å‘å’ŒåŒå‘è®¤è¯</p>
<p><a href="https://www.cnblogs.com/skills/p/13620478.html">GmSSLå¼€å‘ç¯å¢ƒæ­å»ºåŠåŒè¯ä¹¦ç”Ÿæˆ</a>ï¼šåœ¨ç”Ÿæˆè¯ä¹¦é‡Œé¢æ˜¯è®²çš„æœ€è¯¦ç»†ä¹Ÿæ˜¯æœ€å¥½çš„ä¸€ä¸ªåšå®¢æ–‡ç« ï¼ˆæ³¨æ„åšå®¢ç”Ÿæˆæ ¹è¯ä¹¦çš„æ—¶å€™å‘½ä»¤æœ‰ä¸€å¤„é”™è¯¯ï¼ŒRoot.keyåº”è¯¥æ”¹æˆCA.keyï¼‰ï¼ˆæ³¨æ„é‡Œé¢çš„keyå’Œcrtæ–‡ä»¶ï¼‰ï¼ˆå¦‚æœè¿™é‡Œçš„è¯ä¹¦ä¸è¡Œï¼Œç›´æ¥å»å›½å¯†SSLå®éªŒå®¤è¿›è¡Œç”Ÿæˆå°±è¡Œï¼Œéƒ½æœ‰ï¼‰</p>
<ul>
<li>å®éªŒç»“æœï¼š</li>
</ul>
<p>å•è¯ä¹¦å•å‘åŒå‘è®¤è¯éƒ½èƒ½å®Œæˆè¿›è¡Œï¼Œä¸”åœ¨GMBroswerä¹Ÿå¯ä»¥è¿æ¥ï¼›åŒè¯ä¹¦çš„å•é¡¹è®¤è¯å®Œæˆé€šä¿¡ï¼Œä½†æ˜¯åŒå‘è®¤è¯å¯èƒ½è¿˜å­˜åœ¨é—®é¢˜ï¼ˆæºç é—®é¢˜ï¼‰ï¼Œå¹¶ä¸èƒ½å¦‚æ„¿è¿›è¡Œï¼Œè€Œä¸”åŒè¯ä¹¦éƒ½ä¸èƒ½å’ŒGMBroswerè¿›è¡Œè¿æ¥ã€‚å¦‚æœéœ€è¦360å®‰å…¨æµè§ˆå™¨è¿›è¡Œè¿æ¥ï¼Œéœ€è¦åœ¨ç¼–è¯‘GmSSLä¿®æ”¹å…¶ä¸­çš„ä¸€ä¸ªCæ–‡ä»¶ï¼Œå…·ä½“è§ï¼š<a href="https://blog.csdn.net/qq_15077747/article/details/108602988?spm=1001.2014.3001.5501">gmsslç¼–è¯‘åä¸æ”¯æŒ360æµè§ˆå™¨åŒå‘httpsé—®é¢˜</a></p>
<ul>
<li>å®éªŒè®°å½•ï¼š</li>
</ul>
<h3 id="å•è¯ä¹¦å•å‘è®¤è¯ï¼š"><a href="#å•è¯ä¹¦å•å‘è®¤è¯ï¼š" class="headerlink" title="å•è¯ä¹¦å•å‘è®¤è¯ï¼š"></a>å•è¯ä¹¦å•å‘è®¤è¯ï¼š</h3><p>æŠ“åŒ…æ–‡ä»¶ï¼šâ€1-one-cert-one-auth.pcapngâ€</p>
<p>é¦–å…ˆæ‰“å¼€æœåŠ¡å™¨s_serverï¼ŒæœåŠ¡ç«¯å‘½ä»¤å’Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_server -key .&#x2F;sm2.server&#x2F;sm2.server.sig.key.pem -cert .&#x2F;sm2.server&#x2F;sm2.server.sig.crt.pem -CAfile sm2.trust.pem -state -accept 44330</span><br><span class="line">Using default temp DH parameters</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure>

<p>ç„¶ås_clientè¿›è¡Œè¿æ¥ï¼Œå®¢æˆ·ç«¯s_clientçš„è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_client -connect localhost:44330 -key .&#x2F;sm2.koper&#x2F;sm2.koper.sig.key.pem -cert .&#x2F;sm2.koper&#x2F;sm2.koper.sig.crt.pem -CAfile sm2.trust.pem -state</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">CONNECTED(00000003)</span><br><span class="line">SSL_connect:before SSL initialization</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server hello</span><br><span class="line">depth&#x3D;2 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; RootCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;1 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; MiddleCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;0 C &#x3D; CN, ST &#x3D; Beijing, L &#x3D; Beijing, O &#x3D; Sec, OU &#x3D; Sec, CN &#x3D; server, emailAddress &#x3D; sec@email.com</span><br><span class="line">verify return:1</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server certificate</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server done</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server session ticket</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read finished</span><br><span class="line">---</span><br><span class="line">Certificate chain</span><br><span class="line"> 0 s:&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line"> 1 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line"> 2 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">---</span><br><span class="line">Server certificate</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIICLDCCAc+gAwIBAgIGAXlllPWnMAwGCCqBHM9VAYN1BQAwSzELMAkGA1UEBhMC</span><br><span class="line">Q04xDjAMBgNVBAoTBUdNU1NMMRAwDgYDVQQLEwdQS0kvU00yMRowGAYDVQQDExFN</span><br><span class="line">aWRkbGVDQSBmb3IgVGVzdDAiGA8yMDIxMDUxMjE2MDAwMFoYDzIwMjIwNTEyMTYw</span><br><span class="line">MDAwWjB8MQswCQYDVQQGEwJDTjEQMA4GA1UECBMHQmVpamluZzEQMA4GA1UEBxMH</span><br><span class="line">QmVpamluZzEMMAoGA1UEChMDU2VjMQwwCgYDVQQLEwNTZWMxDzANBgNVBAMTBnNl</span><br><span class="line">cnZlcjEcMBoGCSqGSIb3DQEJARYNc2VjQGVtYWlsLmNvbTBZMBMGByqGSM49AgEG</span><br><span class="line">CCqBHM9VAYItA0IABBpkgKei2J+g3S&#x2F;qd&#x2F;KHQL2j6wVhHS+qD2oAxJ&#x2F;T05zIsBOI</span><br><span class="line">&#x2F;BC+&#x2F;xOYX86uk3D9V03zC3J2GNZ1le88SIb4McqjaDBmMBsGA1UdIwQUMBKAEPl&#x2F;</span><br><span class="line">VbQnlDNiplbKb8xdGv8wGQYDVR0OBBIEEDXQBbbJ66twX&#x2F;&#x2F;RjZHc4r0wEQYDVR0R</span><br><span class="line">BAowCIIGc2VydmVyMAkGA1UdEwQCMAAwDgYDVR0PAQH&#x2F;BAQDAgDAMAwGCCqBHM9V</span><br><span class="line">AYN1BQADSQAwRgIhALEqYaJDmh24cyV3mbKt+4VHBvAirFrv&#x2F;+g&#x2F;D4OeWS3YAiEA</span><br><span class="line">jUINEpX+B9UTO4onSuOslfXpsK1ZGU28YARCOjzAUq8&#x3D;</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">subject&#x3D;&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">issuer&#x3D;&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">---</span><br><span class="line">No client certificate CA names sent</span><br><span class="line">Peer signing digest: SM3</span><br><span class="line">Server Temp Key: ECDH, SM2, 256 bits</span><br><span class="line">---</span><br><span class="line">SSL handshake has read 2000 bytes and written 322 bytes</span><br><span class="line">Verification: OK</span><br><span class="line">---</span><br><span class="line">New, TLSv1.2, Cipher is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Server public key is 256 bit</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Compression: NONE</span><br><span class="line">Expansion: NONE</span><br><span class="line">No ALPN negotiated</span><br><span class="line">SSL-Session:</span><br><span class="line">    Protocol  : TLSv1.2</span><br><span class="line">    Cipher    : ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">    Session-ID: 120E30267852E4300EEACEE62B3C1FEDF38504FB71950A7E1567176E44EA04E0</span><br><span class="line">    Session-ID-ctx: </span><br><span class="line">    Master-Key: 6F092582E1943404E58EB37D13577FB3AE9C20308878A1055425E007A4412475C44C1C425B593C69A9EBFB47A8C56A67</span><br><span class="line">    PSK identity: None</span><br><span class="line">    PSK identity hint: None</span><br><span class="line">    SRP username: None</span><br><span class="line">    TLS session ticket lifetime hint: 7200 (seconds)</span><br><span class="line">    TLS session ticket:</span><br><span class="line">    0000 - 86 b6 ec 0e 15 ba c8 1b-58 61 5a 08 64 cf 92 e7   ........XaZ.d...</span><br><span class="line">    0010 - 3d 79 e1 1c 59 c4 c2 9b-1b bd 6d a7 80 f4 65 6d   &#x3D;y..Y.....m...em</span><br><span class="line">    0020 - 74 fd 9c 60 ce 70 4a 7d-11 35 ce d0 fd df 1a 3e   t..&#96;.pJ&#125;.5.....&gt;</span><br><span class="line">    0030 - 81 62 c1 13 b9 d6 22 cf-9a c2 8a 07 0e 81 c1 af   .b....&quot;.........</span><br><span class="line">    0040 - f3 44 a5 07 d9 d8 97 3c-fe fe f6 e0 e3 43 ac 41   .D.....&lt;.....C.A</span><br><span class="line">    0050 - e3 09 8c 69 b5 ab 2e f2-bb 85 cc 10 ca 54 a8 44   ...i.........T.D</span><br><span class="line">    0060 - e7 a2 80 2f f7 b4 21 49-46 a8 7a cd 1b b7 69 17   ...&#x2F;..!IF.z...i.</span><br><span class="line">    0070 - 10 68 5d 24 d2 09 4a 12-d2 bc 7e a8 1a af 4f f3   .h]$..J...~...O.</span><br><span class="line">    0080 - 95 94 1d aa b3 bc 06 46-61 cc 54 03 a3 88 75 6d   .......Fa.T...um</span><br><span class="line">    0090 - 37 a4 88 5b b0 25 83 54-ec ff 95 e2 4d f6 1e db   7..[.%.T....M...</span><br><span class="line"></span><br><span class="line">    Start Time: 1620974867</span><br><span class="line">    Timeout   : 7200 (sec)</span><br><span class="line">    Verify return code: 0 (ok)</span><br><span class="line">    Extended master secret: yes</span><br><span class="line">---</span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨ç«¯s_serverçš„æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write certificate</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read finished</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write session ticket</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write finished</span><br><span class="line">-----BEGIN SSL SESSION PARAMETERS-----</span><br><span class="line">MFoCAQECAgMDBALhBwQABDBvCSWC4ZQ0BOWOs30TV3+zrpwgMIh4oQVUJeAHpEEk</span><br><span class="line">dcRMHEJbWTxpqev7R6jFamehBgIEYJ4dE6IEAgIcIKQGBAQBAAAArQMCAQE&#x3D;</span><br><span class="line">-----END SSL SESSION PARAMETERS-----</span><br><span class="line">Shared ciphers:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:ECDHE-SM2-WITH-SMS4-GCM-SM3:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-SM2-WITH-SMS4-SM3:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:SM9-WITH-SMS4-SM3:SM9DHE-WITH-SMS4-SM3:SM2-WITH-SMS4-SM3:SM2DHE-WITH-SMS4-SM3:AES128-SHA:RSA-WITH-SMS4-SHA1:RSA-WITH-SMS4-SM3</span><br><span class="line">Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Shared Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Supported Elliptic Curve Point Formats: uncompressed:ansiX962_compressed_prime:ansiX962_compressed_char2</span><br><span class="line">Supported Elliptic Curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">Shared Elliptic curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">CIPHER is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Hello!</span><br><span class="line">ERROR</span><br><span class="line">shutting down SSL</span><br><span class="line">CONNECTION CLOSED</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure>

<p>åˆ†æï¼š</p>
<p>åœ¨<em><strong>ClientHello</strong></em>æä¾›çš„å›½å¯†ç»„ä»¶æœ‰ï¼š0xe107ï¼ˆ<strong>ECDHE-SM2-WITH-SMS4-GCM-SM3</strong>ï¼‰ï¼Œ0xe102ï¼ˆ<strong>ECDHE-SM2-WITH-SMS4-SM3</strong>ï¼‰ï¼Œ0xe011ï¼ˆ<strong>ECDHE-SM4-SM3</strong>ï¼‰ï¼Œ0xe013ï¼ˆ<strong>ECC-SM4-SM3</strong>ï¼‰ï¼Œ0xe015ï¼ˆ<strong>IBSDH-SM4-SM3</strong>ï¼‰ï¼Œ0xe017ï¼ˆ<strong>IBC-SM4-SM3</strong>ï¼‰ï¼Œ0xe019ï¼ˆ<strong>RSA-SM4-SM3</strong>ï¼‰ï¼Œ0xe01aï¼ˆ<strong>RSA-SM4-SHA1</strong>ï¼‰ï¼›</p>
<p>åœ¨<em><strong>ClientHello</strong></em>æä¾›çš„å›½å¯†Hash+ç­¾åç®—æ³•æœ‰ï¼š0x0707ï¼ˆ<strong>SM3+SM2</strong>ï¼‰</p>
<p>æ­¤æ—¶å…±åŒåå•†çš„å¯†ç ç»„ä»¶æ˜¯<strong>ECDHE-SM2-WITH-SMS4-GCM-SM3</strong>ï¼Œåœ¨æ•°æ®åŒ…ä¸­å…¶å€¼è¡¨ç¤ºä¸ºâ€œ0xe107â€ï¼Œä¼ è¾“åè®®ä¸º<strong>TLSv1.2</strong>ï¼Œå…¶å€¼ä¸ºâ€œ0x0303â€</p>
<p>å›¾è§£æ•°æ®åŒ…ï¼š</p>
<p><img src="/images/%E5%9B%BD%E5%AF%86%E7%AE%97%E6%B3%95-%E5%8D%8F%E8%AE%AE-%E5%B7%A5%E6%8E%A7/1-one-cert-one-auth-anlysis.jpg" alt="1-one-cert-one-auth-anlysis"></p>
<h3 id="å•è¯ä¹¦åŒå‘è®¤è¯"><a href="#å•è¯ä¹¦åŒå‘è®¤è¯" class="headerlink" title="å•è¯ä¹¦åŒå‘è®¤è¯"></a>å•è¯ä¹¦åŒå‘è®¤è¯</h3><p>æŠ“åŒ…æ–‡ä»¶ï¼š2-one-cert-two-auth.pcapng</p>
<p>é¦–å…ˆæ‰“å¼€æœåŠ¡å™¨s_serverï¼ŒæœåŠ¡ç«¯å‘½ä»¤å’Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_server -key .&#x2F;sm2.server&#x2F;sm2.server.sig.key.pem -cert .&#x2F;sm2.server&#x2F;sm2.server.sig.crt.pem -CAfile sm2.trust.pem -state -accept 44330 -verify 1</span><br><span class="line">verify depth is 1</span><br><span class="line">Using default temp DH parameters</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure>

<p>ç„¶ås_clientè¿›è¡Œè¿æ¥ï¼Œå®¢æˆ·ç«¯s_clientçš„è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_client -connect localhost:44330 -key .&#x2F;sm2.koper&#x2F;sm2.koper.sig.key.pem -cert .&#x2F;sm2.koper&#x2F;sm2.koper.sig.crt.pem -CAfile sm2.trust.pem -state</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">CONNECTED(00000003)</span><br><span class="line">SSL_connect:before SSL initialization</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server hello</span><br><span class="line">depth&#x3D;2 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; RootCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;1 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; MiddleCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;0 C &#x3D; CN, ST &#x3D; Beijing, L &#x3D; Beijing, O &#x3D; Sec, OU &#x3D; Sec, CN &#x3D; server, emailAddress &#x3D; sec@email.com</span><br><span class="line">verify return:1</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server certificate</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server certificate request</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server done</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client certificate</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write certificate verify</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server session ticket</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read finished</span><br><span class="line">---</span><br><span class="line">Certificate chain</span><br><span class="line"> 0 s:&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line"> 1 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line"> 2 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">---</span><br><span class="line">Server certificate</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIICLDCCAc+gAwIBAgIGAXlllPWnMAwGCCqBHM9VAYN1BQAwSzELMAkGA1UEBhMC</span><br><span class="line">Q04xDjAMBgNVBAoTBUdNU1NMMRAwDgYDVQQLEwdQS0kvU00yMRowGAYDVQQDExFN</span><br><span class="line">aWRkbGVDQSBmb3IgVGVzdDAiGA8yMDIxMDUxMjE2MDAwMFoYDzIwMjIwNTEyMTYw</span><br><span class="line">MDAwWjB8MQswCQYDVQQGEwJDTjEQMA4GA1UECBMHQmVpamluZzEQMA4GA1UEBxMH</span><br><span class="line">QmVpamluZzEMMAoGA1UEChMDU2VjMQwwCgYDVQQLEwNTZWMxDzANBgNVBAMTBnNl</span><br><span class="line">cnZlcjEcMBoGCSqGSIb3DQEJARYNc2VjQGVtYWlsLmNvbTBZMBMGByqGSM49AgEG</span><br><span class="line">CCqBHM9VAYItA0IABBpkgKei2J+g3S&#x2F;qd&#x2F;KHQL2j6wVhHS+qD2oAxJ&#x2F;T05zIsBOI</span><br><span class="line">&#x2F;BC+&#x2F;xOYX86uk3D9V03zC3J2GNZ1le88SIb4McqjaDBmMBsGA1UdIwQUMBKAEPl&#x2F;</span><br><span class="line">VbQnlDNiplbKb8xdGv8wGQYDVR0OBBIEEDXQBbbJ66twX&#x2F;&#x2F;RjZHc4r0wEQYDVR0R</span><br><span class="line">BAowCIIGc2VydmVyMAkGA1UdEwQCMAAwDgYDVR0PAQH&#x2F;BAQDAgDAMAwGCCqBHM9V</span><br><span class="line">AYN1BQADSQAwRgIhALEqYaJDmh24cyV3mbKt+4VHBvAirFrv&#x2F;+g&#x2F;D4OeWS3YAiEA</span><br><span class="line">jUINEpX+B9UTO4onSuOslfXpsK1ZGU28YARCOjzAUq8&#x3D;</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">subject&#x3D;&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">issuer&#x3D;&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">---</span><br><span class="line">Acceptable client certificate CA names</span><br><span class="line">&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">Client Certificate Types: RSA sign, DSA sign, ECDSA sign</span><br><span class="line">Requested Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Shared Requested Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Peer signing digest: SM3</span><br><span class="line">Server Temp Key: ECDH, SM2, 256 bits</span><br><span class="line">---</span><br><span class="line">SSL handshake has read 2780 bytes and written 1951 bytes</span><br><span class="line">Verification: OK</span><br><span class="line">---</span><br><span class="line">New, TLSv1.2, Cipher is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Server public key is 256 bit</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Compression: NONE</span><br><span class="line">Expansion: NONE</span><br><span class="line">No ALPN negotiated</span><br><span class="line">SSL-Session:</span><br><span class="line">    Protocol  : TLSv1.2</span><br><span class="line">    Cipher    : ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">    Session-ID: 9CD7AA2E27F5E99B8F9DBAF0DE60FF4C62F779758D273569E0A9640A4389BA33</span><br><span class="line">    Session-ID-ctx: </span><br><span class="line">    Master-Key: 8D425B913570771786862AC9A8683569B02996AFE418B5A6BED6D19AFCBCC769246D38376D1F39B05242F75CB6503D0E</span><br><span class="line">    PSK identity: None</span><br><span class="line">    PSK identity hint: None</span><br><span class="line">    SRP username: None</span><br><span class="line">    TLS session ticket lifetime hint: 7200 (seconds)</span><br><span class="line">    TLS session ticket:</span><br><span class="line">    0000 - d0 fb c1 bc 3a 89 d3 45-eb 58 1a ea 53 ad f5 71   ....:..E.X..S..q</span><br><span class="line">    0010 - 92 38 35 50 f0 99 cf 92-ea cc cd 68 e1 61 08 f8   .85P.......h.a..</span><br><span class="line">    0020 - 32 c0 c1 36 af 5c 55 fb-33 9a 87 5e e5 b9 8b f8   2..6.\U.3..^....</span><br><span class="line">    0030 - f2 e8 d1 3c aa b4 d1 e7-4c 89 00 af c0 56 29 cf   ...&lt;....L....V).</span><br><span class="line">    0040 - 3e de 8a a5 a4 90 f3 41-af 85 19 26 fb 12 a5 ec   &gt;......A...&amp;....</span><br><span class="line">    0050 - 22 29 3a 98 9d 4d bd 77-ac 07 c3 bc 98 34 72 35   &quot;):..M.w.....4r5</span><br><span class="line">    0060 - d0 6f 3e 1c 56 f7 29 32-42 fb 58 19 04 01 60 62   .o&gt;.V.)2B.X...&#96;b</span><br><span class="line">    0070 - 07 26 92 dd 25 98 b0 60-c5 ea 62 53 d6 4e a0 18   .&amp;..%..&#96;..bS.N..</span><br><span class="line">    0080 - ec b8 e5 48 3c 0b 9d c4-a4 95 de 99 9c 44 df de   ...H&lt;........D..</span><br><span class="line">    0090 - b8 04 37 ed a2 57 59 6c-89 3c f2 54 a9 bb 9e 5b   ..7..WYl.&lt;.T...[</span><br><span class="line">    00a0 - 23 de e8 cd 9a cb 19 bc-c8 ff ca 28 97 3c a2 bd   #..........(.&lt;..</span><br><span class="line">    00b0 - ce 52 28 b2 45 2f 7a 2b-77 85 c8 94 d5 a3 83 83   .R(.E&#x2F;z+w.......</span><br><span class="line">    00c0 - 5f a1 d2 d3 4e 09 62 57-87 c5 fa 21 85 17 5d ad   _...N.bW...!..].</span><br><span class="line">    00d0 - c0 f5 f1 4d b0 43 ed 05-76 d1 55 7a b0 5b 19 d3   ...M.C..v.Uz.[..</span><br><span class="line">    00e0 - 00 f5 a6 43 88 80 6b b5-1f 77 ef 9f d7 d6 d4 a7   ...C..k..w......</span><br><span class="line">    00f0 - 1a 05 2a d4 d7 0b 25 c3-54 93 35 20 03 b8 3e 02   ..*...%.T.5 ..&gt;.</span><br><span class="line">    0100 - 79 f7 ff 54 95 b4 97 73-81 10 12 2c 8d bc 2d 78   y..T...s...,..-x</span><br><span class="line">    0110 - 50 5c 5f 30 32 8f 68 f4-f4 74 3c d5 26 b2 e3 4e   P\_02.h..t&lt;.&amp;..N</span><br><span class="line">    0120 - c9 72 b5 e3 df 71 7d bf-33 4a 64 39 61 aa 58 1d   .r...q&#125;.3Jd9a.X.</span><br><span class="line">    0130 - 62 6e 4d 78 16 01 97 63-6c e9 e8 49 38 f9 3a ec   bnMx...cl..I8.:.</span><br><span class="line">    0140 - 87 ee 5a d4 89 24 41 23-af 80 4f ae 01 62 9f e5   ..Z..$A#..O..b..</span><br><span class="line">    0150 - 3e 4f ca 55 f9 ba 67 d5-55 8b c9 b5 ee 90 08 92   &gt;O.U..g.U.......</span><br><span class="line">    0160 - 12 57 28 2f c1 f8 32 d6-51 8c 39 27 8f c8 d1 5a   .W(&#x2F;..2.Q.9&#39;...Z</span><br><span class="line">    0170 - 3a f5 0a ce fd 1f 72 97-e5 3b 15 29 ab 1e 20 58   :.....r..;.).. X</span><br><span class="line">    0180 - 65 aa 26 99 ef 05 fd b5-d4 05 f6 17 a3 08 3f 38   e.&amp;...........?8</span><br><span class="line">    0190 - ba 70 90 ba c9 20 22 5d-19 a5 d4 33 0c 9f ed 2b   .p... &quot;]...3...+</span><br><span class="line">    01a0 - 3a a7 c1 d3 63 f3 71 c2-a4 7c ac 7b f2 29 04 3e   :...c.q..|.&#123;.).&gt;</span><br><span class="line">    01b0 - 6b c9 bf 93 d6 d9 1d a3-6a 42 c8 48 e1 d1 f5 7b   k.......jB.H...&#123;</span><br><span class="line">    01c0 - cf 9a fe 59 f9 9d ad 3c-0b 2b 86 b5 cb 0f cb 62   ...Y...&lt;.+.....b</span><br><span class="line">    01d0 - 47 8a 8f 99 09 00 9d 9e-03 06 90 d7 4e ca 35 97   G...........N.5.</span><br><span class="line">    01e0 - 33 8e e8 77 2c 66 86 26-d6 74 8a de 00 3a 84 95   3..w,f.&amp;.t...:..</span><br><span class="line">    01f0 - e6 4b e7 83 cf c3 4d 6d-c1 65 28 a4 0c 3e bc 37   .K....Mm.e(..&gt;.7</span><br><span class="line">    0200 - b5 f3 7c cc 03 50 ad 86-0d b6 52 61 47 d9 69 e2   ..|..P....RaG.i.</span><br><span class="line">    0210 - 1c 68 e4 4e 85 f9 47 2f-46 f3 34 75 f1 5e ad 9f   .h.N..G&#x2F;F.4u.^..</span><br><span class="line">    0220 - ff 42 dd ac b9 ea 24 b0-f7 b8 26 2b 51 4e 00 45   .B....$...&amp;+QN.E</span><br><span class="line">    0230 - 82 32 df f7 29 d9 d6 a1-13 28 59 e3 03 d1 e2 4a   .2..)....(Y....J</span><br><span class="line">    0240 - bd c5 63 0c 3f 07 4d ed-3c 02 a6 11 82 76 2b 6f   ..c.?.M.&lt;....v+o</span><br><span class="line">    0250 - f4 5e 20 d3 5d e8 24 d2-0a 30 6d d7 18 7d 43 28   .^ .].$..0m..&#125;C(</span><br><span class="line">    0260 - 32 9e 2f 17 47 a7 3e e2-8d e5 d2 2e 6b cd 4e ad   2.&#x2F;.G.&gt;.....k.N.</span><br><span class="line">    0270 - e5 bd 97 ae f7 ac 18 7b-56 cb d0 67 13 17 4b 81   .......&#123;V..g..K.</span><br><span class="line">    0280 - ea df 3f a3 79 d6 cf 07-1e e8 56 37 75 31 37 f7   ..?.y.....V7u17.</span><br><span class="line">    0290 - f6 43 d4 20 fd d7 35 89-5b 4a 4d 3c 6e 95 70 be   .C. ..5.[JM&lt;n.p.</span><br><span class="line">    02a0 - 7c 89 3c 66 1b 13 7d 63-f9 14 b0 33 9d c3 72 42   |.&lt;f..&#125;c...3..rB</span><br><span class="line">    02b0 - 70 d2 1a 07 c3 3e 43 a5-77 32 4e 9f 81 f1 89 ac   p....&gt;C.w2N.....</span><br><span class="line">    02c0 - 0f b4 43 18 95 3b 12 c3-ec 10 45 5e ec 3c 19 b0   ..C..;....E^.&lt;..</span><br><span class="line">    02d0 - d8 19 ac 2f a6 24 22 71-f1 9c 37 16 c8 35 44 28   ...&#x2F;.$&quot;q..7..5D(</span><br><span class="line"></span><br><span class="line">    Start Time: 1620975768</span><br><span class="line">    Timeout   : 7200 (sec)</span><br><span class="line">    Verify return code: 0 (ok)</span><br><span class="line">    Extended master secret: yes</span><br><span class="line">---</span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨ç«¯s_serverçš„æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write certificate</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write certificate request</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">depth&#x3D;2 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; RootCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;1 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; MiddleCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;0 C &#x3D; CN, ST &#x3D; Beijing, L &#x3D; Beijing, O &#x3D; Sec, OU &#x3D; Sec, CN &#x3D; koper, emailAddress &#x3D; sec@email.com</span><br><span class="line">verify return:1</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client certificate</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read certificate verify</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read finished</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write session ticket</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write finished</span><br><span class="line">-----BEGIN SSL SESSION PARAMETERS-----</span><br><span class="line">MIICkwIBAQICAwMEAuEHBAAEMI1CW5E1cHcXhoYqyahoNWmwKZav5Bi1pr7W0Zr8</span><br><span class="line">vMdpJG04N20fObBSQvdctlA9DqEGAgRgniCYogQCAhwgo4ICNTCCAjEwggHVoAMC</span><br><span class="line">AQICBgF5ZZUapjAMBggqgRzPVQGDdQUAMEsxCzAJBgNVBAYTAkNOMQ4wDAYDVQQK</span><br><span class="line">EwVHTVNTTDEQMA4GA1UECxMHUEtJL1NNMjEaMBgGA1UEAxMRTWlkZGxlQ0EgZm9y</span><br><span class="line">IFRlc3QwIhgPMjAyMTA1MTIxNjAwMDBaGA8yMDIyMDUxMjE2MDAwMFowezELMAkG</span><br><span class="line">A1UEBhMCQ04xEDAOBgNVBAgTB0JlaWppbmcxEDAOBgNVBAcTB0JlaWppbmcxDDAK</span><br><span class="line">BgNVBAoTA1NlYzEMMAoGA1UECxMDU2VjMQ4wDAYDVQQDEwVrb3BlcjEcMBoGCSqG</span><br><span class="line">SIb3DQEJARYNc2VjQGVtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqBHM9VAYItA0IA</span><br><span class="line">BOhXh8LQpC+cATyRNCSm2cEuMLoGY9mCPQCkl2v7z6ZlmsJNYw9ZHeHXKjOfzbN&#x2F;</span><br><span class="line">rZ1Fj2wQ6BDyEouRhIbZsQOjbzBtMBsGA1UdIwQUMBKAEPl&#x2F;VbQnlDNiplbKb8xd</span><br><span class="line">Gv8wGQYDVR0OBBIEEJQv2LqXmxUlo4nbIQCC+mMwGAYDVR0RBBEwD4ENc2VjQGVt</span><br><span class="line">YWlsLmNvbTAJBgNVHRMEAjAAMA4GA1UdDwEB&#x2F;wQEAwIAwDAMBggqgRzPVQGDdQUA</span><br><span class="line">A0gAMEUCIQDWC+&#x2F;sbV51DqGF8TyFDhlLzMFv198cmqH2WJt9bIiZgwIgJ1cO33LC</span><br><span class="line">cwmoPfuaXmQrseP+RmOEBjbRRCIh1LGrUhSkBgQEAQAAAK0DAgEB</span><br><span class="line">-----END SSL SESSION PARAMETERS-----</span><br><span class="line">Client certificate</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIICMTCCAdWgAwIBAgIGAXlllRqmMAwGCCqBHM9VAYN1BQAwSzELMAkGA1UEBhMC</span><br><span class="line">Q04xDjAMBgNVBAoTBUdNU1NMMRAwDgYDVQQLEwdQS0kvU00yMRowGAYDVQQDExFN</span><br><span class="line">aWRkbGVDQSBmb3IgVGVzdDAiGA8yMDIxMDUxMjE2MDAwMFoYDzIwMjIwNTEyMTYw</span><br><span class="line">MDAwWjB7MQswCQYDVQQGEwJDTjEQMA4GA1UECBMHQmVpamluZzEQMA4GA1UEBxMH</span><br><span class="line">QmVpamluZzEMMAoGA1UEChMDU2VjMQwwCgYDVQQLEwNTZWMxDjAMBgNVBAMTBWtv</span><br><span class="line">cGVyMRwwGgYJKoZIhvcNAQkBFg1zZWNAZW1haWwuY29tMFkwEwYHKoZIzj0CAQYI</span><br><span class="line">KoEcz1UBgi0DQgAE6FeHwtCkL5wBPJE0JKbZwS4wugZj2YI9AKSXa&#x2F;vPpmWawk1j</span><br><span class="line">D1kd4dcqM5&#x2F;Ns3+tnUWPbBDoEPISi5GEhtmxA6NvMG0wGwYDVR0jBBQwEoAQ+X9V</span><br><span class="line">tCeUM2KmVspvzF0a&#x2F;zAZBgNVHQ4EEgQQlC&#x2F;YupebFSWjidshAIL6YzAYBgNVHREE</span><br><span class="line">ETAPgQ1zZWNAZW1haWwuY29tMAkGA1UdEwQCMAAwDgYDVR0PAQH&#x2F;BAQDAgDAMAwG</span><br><span class="line">CCqBHM9VAYN1BQADSAAwRQIhANYL7+xtXnUOoYXxPIUOGUvMwW&#x2F;X3xyaofZYm31s</span><br><span class="line">iJmDAiAnVw7fcsJzCag9+5peZCux4&#x2F;5GY4QGNtFEIiHUsatSFA&#x3D;&#x3D;</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">subject&#x3D;&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;koper&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">issuer&#x3D;&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">Shared ciphers:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:ECDHE-SM2-WITH-SMS4-GCM-SM3:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-SM2-WITH-SMS4-SM3:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:SM9-WITH-SMS4-SM3:SM9DHE-WITH-SMS4-SM3:SM2-WITH-SMS4-SM3:SM2DHE-WITH-SMS4-SM3:AES128-SHA:RSA-WITH-SMS4-SHA1:RSA-WITH-SMS4-SM3</span><br><span class="line">Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Shared Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Peer signing digest: SM3</span><br><span class="line">Supported Elliptic Curve Point Formats: uncompressed:ansiX962_compressed_prime:ansiX962_compressed_char2</span><br><span class="line">Supported Elliptic Curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">Shared Elliptic curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">CIPHER is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Hello!</span><br><span class="line">ERROR</span><br><span class="line">shutting down SSL</span><br><span class="line">CONNECTION CLOSED</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure>

<h3 id="åŒè¯ä¹¦å•å‘è®¤è¯"><a href="#åŒè¯ä¹¦å•å‘è®¤è¯" class="headerlink" title="åŒè¯ä¹¦å•å‘è®¤è¯"></a>åŒè¯ä¹¦å•å‘è®¤è¯</h3><p>æŠ“åŒ…æ–‡ä»¶ï¼š3-two-cert-one-auth.pcapng</p>
<p>é¦–å…ˆæ‰“å¼€æœåŠ¡å™¨s_serverï¼ŒæœåŠ¡ç«¯å‘½ä»¤å’Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_server -key .&#x2F;sm2.server&#x2F;sm2.server.sig.key.pem -cert .&#x2F;sm2.server&#x2F;sm2.server.sig.crt.pem -dkey .&#x2F;sm2.server&#x2F;sm2.server.enc.key.pem -dcert .&#x2F;sm2.server&#x2F;sm2.server.enc.crt.pem -CAfile sm2.trust.pem -state -accept 44330</span><br><span class="line">Using default temp DH parameters</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">[GMTLS_DEBUG] set sm2 encryption certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 decryption private key</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure>

<p>ç„¶ås_clientè¿›è¡Œè¿æ¥ï¼Œå®¢æˆ·ç«¯s_clientçš„è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_client -connect localhost:44330 -key .&#x2F;sm2.koper&#x2F;sm2.koper.sig.key.pem -cert .&#x2F;sm2.koper&#x2F;sm2.koper.sig.crt.pem -dkey .&#x2F;sm2.koper&#x2F;sm2.koper.enc.key.pem -dcert .&#x2F;sm2.koper&#x2F;sm2.koper.enc.crt.pem -CAfile sm2.trust.pem -state</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">[GMTLS_DEBUG] set sm2 encryption certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 decryption private key</span><br><span class="line">CONNECTED(00000003)</span><br><span class="line">SSL_connect:before SSL initialization</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server hello</span><br><span class="line">depth&#x3D;2 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; RootCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;1 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; MiddleCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;0 C &#x3D; CN, ST &#x3D; Beijing, L &#x3D; Beijing, O &#x3D; Sec, OU &#x3D; Sec, CN &#x3D; server, emailAddress &#x3D; sec@email.com</span><br><span class="line">verify return:1</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server certificate</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server done</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server session ticket</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read finished</span><br><span class="line">---</span><br><span class="line">Certificate chain</span><br><span class="line"> 0 s:&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line"> 1 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line"> 2 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">---</span><br><span class="line">Server certificate</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIICLDCCAc+gAwIBAgIGAXlllPWnMAwGCCqBHM9VAYN1BQAwSzELMAkGA1UEBhMC</span><br><span class="line">Q04xDjAMBgNVBAoTBUdNU1NMMRAwDgYDVQQLEwdQS0kvU00yMRowGAYDVQQDExFN</span><br><span class="line">aWRkbGVDQSBmb3IgVGVzdDAiGA8yMDIxMDUxMjE2MDAwMFoYDzIwMjIwNTEyMTYw</span><br><span class="line">MDAwWjB8MQswCQYDVQQGEwJDTjEQMA4GA1UECBMHQmVpamluZzEQMA4GA1UEBxMH</span><br><span class="line">QmVpamluZzEMMAoGA1UEChMDU2VjMQwwCgYDVQQLEwNTZWMxDzANBgNVBAMTBnNl</span><br><span class="line">cnZlcjEcMBoGCSqGSIb3DQEJARYNc2VjQGVtYWlsLmNvbTBZMBMGByqGSM49AgEG</span><br><span class="line">CCqBHM9VAYItA0IABBpkgKei2J+g3S&#x2F;qd&#x2F;KHQL2j6wVhHS+qD2oAxJ&#x2F;T05zIsBOI</span><br><span class="line">&#x2F;BC+&#x2F;xOYX86uk3D9V03zC3J2GNZ1le88SIb4McqjaDBmMBsGA1UdIwQUMBKAEPl&#x2F;</span><br><span class="line">VbQnlDNiplbKb8xdGv8wGQYDVR0OBBIEEDXQBbbJ66twX&#x2F;&#x2F;RjZHc4r0wEQYDVR0R</span><br><span class="line">BAowCIIGc2VydmVyMAkGA1UdEwQCMAAwDgYDVR0PAQH&#x2F;BAQDAgDAMAwGCCqBHM9V</span><br><span class="line">AYN1BQADSQAwRgIhALEqYaJDmh24cyV3mbKt+4VHBvAirFrv&#x2F;+g&#x2F;D4OeWS3YAiEA</span><br><span class="line">jUINEpX+B9UTO4onSuOslfXpsK1ZGU28YARCOjzAUq8&#x3D;</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">subject&#x3D;&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">issuer&#x3D;&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">---</span><br><span class="line">No client certificate CA names sent</span><br><span class="line">Peer signing digest: SM3</span><br><span class="line">Server Temp Key: ECDH, SM2, 256 bits</span><br><span class="line">---</span><br><span class="line">SSL handshake has read 2000 bytes and written 322 bytes</span><br><span class="line">Verification: OK</span><br><span class="line">---</span><br><span class="line">New, TLSv1.2, Cipher is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Server public key is 256 bit</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Compression: NONE</span><br><span class="line">Expansion: NONE</span><br><span class="line">No ALPN negotiated</span><br><span class="line">SSL-Session:</span><br><span class="line">    Protocol  : TLSv1.2</span><br><span class="line">    Cipher    : ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">    Session-ID: 74900E774DFC5EA731925765651AA7AE8D919A25DCC9219E4987B0B14AC20B1D</span><br><span class="line">    Session-ID-ctx: </span><br><span class="line">    Master-Key: 8B13A72CD68C5F0B8DBFF22A9C97EB67F30F8D11A38FD58DEAD255FEAADEFE426225AA2C90F77809A9853B246A6563C3</span><br><span class="line">    PSK identity: None</span><br><span class="line">    PSK identity hint: None</span><br><span class="line">    SRP username: None</span><br><span class="line">    TLS session ticket lifetime hint: 7200 (seconds)</span><br><span class="line">    TLS session ticket:</span><br><span class="line">    0000 - 94 e5 a8 ce a0 bd 7a 15-30 4e 4b bb 6c be 41 a8   ......z.0NK.l.A.</span><br><span class="line">    0010 - fb d9 d2 a1 11 d5 5a 7d-c3 9a 7d 01 c4 50 1b ad   ......Z&#125;..&#125;..P..</span><br><span class="line">    0020 - e7 2d a9 98 5f 64 06 85-0e d7 3e 46 c3 77 d8 13   .-.._d....&gt;F.w..</span><br><span class="line">    0030 - 2a 4b 4d 45 cb 04 0f 50-d8 d2 fd 94 b7 a5 38 88   *KME...P......8.</span><br><span class="line">    0040 - 61 14 f3 e3 fb b2 93 e8-16 84 bb 95 41 ee 4f bf   a...........A.O.</span><br><span class="line">    0050 - 80 c2 ef 9e 91 49 0d 23-19 07 80 ff 88 66 fb 8c   .....I.#.....f..</span><br><span class="line">    0060 - 34 b3 1f 4a db 6a 67 29-5a d2 46 aa 4d 89 00 cb   4..J.jg)Z.F.M...</span><br><span class="line">    0070 - ce 78 f5 bc c3 c0 71 c6-d9 b5 4a a0 2c 3f 95 fb   .x....q...J.,?..</span><br><span class="line">    0080 - 38 51 68 38 15 b7 c1 c6-0f 6d 1e 92 19 f9 7b ed   8Qh8.....m....&#123;.</span><br><span class="line">    0090 - 67 45 64 e6 9f c8 af 3b-57 80 a6 31 13 13 b8 d2   gEd....;W..1....</span><br><span class="line"></span><br><span class="line">    Start Time: 1620976379</span><br><span class="line">    Timeout   : 7200 (sec)</span><br><span class="line">    Verify return code: 0 (ok)</span><br><span class="line">    Extended master secret: yes</span><br><span class="line">---</span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨ç«¯s_serverçš„æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write certificate</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read finished</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write session ticket</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write finished</span><br><span class="line">-----BEGIN SSL SESSION PARAMETERS-----</span><br><span class="line">MFoCAQECAgMDBALhBwQABDCLE6cs1oxfC42&#x2F;8iqcl+tn8w+NEaOP1Y3q0lX+qt7+</span><br><span class="line">QmIlqiyQ93gJqYU7JGplY8OhBgIEYJ4i+6IEAgIcIKQGBAQBAAAArQMCAQE&#x3D;</span><br><span class="line">-----END SSL SESSION PARAMETERS-----</span><br><span class="line">Shared ciphers:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:ECDHE-SM2-WITH-SMS4-GCM-SM3:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-SM2-WITH-SMS4-SM3:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:SM9-WITH-SMS4-SM3:SM9DHE-WITH-SMS4-SM3:SM2-WITH-SMS4-SM3:SM2DHE-WITH-SMS4-SM3:AES128-SHA:RSA-WITH-SMS4-SHA1:RSA-WITH-SMS4-SM3</span><br><span class="line">Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Shared Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Supported Elliptic Curve Point Formats: uncompressed:ansiX962_compressed_prime:ansiX962_compressed_char2</span><br><span class="line">Supported Elliptic Curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">Shared Elliptic curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">CIPHER is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Hello!</span><br><span class="line">ERROR</span><br><span class="line">shutting down SSL</span><br><span class="line">CONNECTION CLOSED</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure>

<h3 id="åŒè¯ä¹¦åŒå‘è®¤è¯"><a href="#åŒè¯ä¹¦åŒå‘è®¤è¯" class="headerlink" title="åŒè¯ä¹¦åŒå‘è®¤è¯"></a>åŒè¯ä¹¦åŒå‘è®¤è¯</h3><p>æŠ“åŒ…æ–‡ä»¶ï¼š4-two-cert-two-auth.pcapng</p>
<p>é¦–å…ˆæ‰“å¼€æœåŠ¡å™¨s_serverï¼ŒæœåŠ¡ç«¯å‘½ä»¤å’Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_server -key .&#x2F;sm2.server&#x2F;sm2.server.sig.key.pem -cert .&#x2F;sm2.server&#x2F;sm2.server.sig.crt.pem -dkey .&#x2F;sm2.server&#x2F;sm2.server.enc.key.pem -dcert .&#x2F;sm2.server&#x2F;sm2.server.enc.crt.pem -CAfile sm2.trust.pem -state -accept 44330 -verify 1</span><br><span class="line">verify depth is 1</span><br><span class="line">Using default temp DH parameters</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">[GMTLS_DEBUG] set sm2 encryption certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 decryption private key</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure>

<p>ç„¶ås_clientè¿›è¡Œè¿æ¥ï¼Œå®¢æˆ·ç«¯s_clientçš„è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost demoCA]# gmssl s_client -connect localhost:44330 -key .&#x2F;sm2.koper&#x2F;sm2.koper.sig.key.pem -cert .&#x2F;sm2.koper&#x2F;sm2.koper.sig.crt.pem -dkey .&#x2F;sm2.koper&#x2F;sm2.koper.enc.key.pem -dcert .&#x2F;sm2.koper&#x2F;sm2.koper.enc.crt.pem -CAfile sm2.trust.pem -state</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 signing private key</span><br><span class="line">[GMTLS_DEBUG] set sm2 encryption certificate</span><br><span class="line">[GMTLS_DEBUG] set sm2 decryption private key</span><br><span class="line">CONNECTED(00000003)</span><br><span class="line">SSL_connect:before SSL initialization</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client hello</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server hello</span><br><span class="line">depth&#x3D;2 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; RootCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;1 C &#x3D; CN, O &#x3D; GMSSL, OU &#x3D; PKI&#x2F;SM2, CN &#x3D; MiddleCA for Test</span><br><span class="line">verify return:1</span><br><span class="line">depth&#x3D;0 C &#x3D; CN, ST &#x3D; Beijing, L &#x3D; Beijing, O &#x3D; Sec, OU &#x3D; Sec, CN &#x3D; server, emailAddress &#x3D; sec@email.com</span><br><span class="line">verify return:1</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server certificate</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server certificate request</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server done</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client certificate</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write client key exchange</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS write finished</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read server session ticket</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_connect:SSLv3&#x2F;TLS read finished</span><br><span class="line">---</span><br><span class="line">Certificate chain</span><br><span class="line"> 0 s:&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line"> 1 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line"> 2 s:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">   i:&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">---</span><br><span class="line">Server certificate</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIICLDCCAc+gAwIBAgIGAXlllPWnMAwGCCqBHM9VAYN1BQAwSzELMAkGA1UEBhMC</span><br><span class="line">Q04xDjAMBgNVBAoTBUdNU1NMMRAwDgYDVQQLEwdQS0kvU00yMRowGAYDVQQDExFN</span><br><span class="line">aWRkbGVDQSBmb3IgVGVzdDAiGA8yMDIxMDUxMjE2MDAwMFoYDzIwMjIwNTEyMTYw</span><br><span class="line">MDAwWjB8MQswCQYDVQQGEwJDTjEQMA4GA1UECBMHQmVpamluZzEQMA4GA1UEBxMH</span><br><span class="line">QmVpamluZzEMMAoGA1UEChMDU2VjMQwwCgYDVQQLEwNTZWMxDzANBgNVBAMTBnNl</span><br><span class="line">cnZlcjEcMBoGCSqGSIb3DQEJARYNc2VjQGVtYWlsLmNvbTBZMBMGByqGSM49AgEG</span><br><span class="line">CCqBHM9VAYItA0IABBpkgKei2J+g3S&#x2F;qd&#x2F;KHQL2j6wVhHS+qD2oAxJ&#x2F;T05zIsBOI</span><br><span class="line">&#x2F;BC+&#x2F;xOYX86uk3D9V03zC3J2GNZ1le88SIb4McqjaDBmMBsGA1UdIwQUMBKAEPl&#x2F;</span><br><span class="line">VbQnlDNiplbKb8xdGv8wGQYDVR0OBBIEEDXQBbbJ66twX&#x2F;&#x2F;RjZHc4r0wEQYDVR0R</span><br><span class="line">BAowCIIGc2VydmVyMAkGA1UdEwQCMAAwDgYDVR0PAQH&#x2F;BAQDAgDAMAwGCCqBHM9V</span><br><span class="line">AYN1BQADSQAwRgIhALEqYaJDmh24cyV3mbKt+4VHBvAirFrv&#x2F;+g&#x2F;D4OeWS3YAiEA</span><br><span class="line">jUINEpX+B9UTO4onSuOslfXpsK1ZGU28YARCOjzAUq8&#x3D;</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">subject&#x3D;&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;Sec&#x2F;OU&#x3D;Sec&#x2F;CN&#x3D;server&#x2F;emailAddress&#x3D;sec@email.com</span><br><span class="line">issuer&#x3D;&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">---</span><br><span class="line">Acceptable client certificate CA names</span><br><span class="line">&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;RootCA for Test</span><br><span class="line">&#x2F;C&#x3D;CN&#x2F;O&#x3D;GMSSL&#x2F;OU&#x3D;PKI&#x2F;SM2&#x2F;CN&#x3D;MiddleCA for Test</span><br><span class="line">Client Certificate Types: RSA sign, DSA sign, ECDSA sign</span><br><span class="line">Requested Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Shared Requested Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Peer signing digest: SM3</span><br><span class="line">Server Temp Key: ECDH, SM2, 256 bits</span><br><span class="line">---</span><br><span class="line">SSL handshake has read 2204 bytes and written 334 bytes</span><br><span class="line">Verification: OK</span><br><span class="line">---</span><br><span class="line">New, TLSv1.2, Cipher is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Server public key is 256 bit</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Compression: NONE</span><br><span class="line">Expansion: NONE</span><br><span class="line">No ALPN negotiated</span><br><span class="line">SSL-Session:</span><br><span class="line">    Protocol  : TLSv1.2</span><br><span class="line">    Cipher    : ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">    Session-ID: 8F24410489864FE9CB6688032BBB484DC641531AC1BEA0CCB256C60C06DEA4FA</span><br><span class="line">    Session-ID-ctx: </span><br><span class="line">    Master-Key: EC69FA7721F60D09C2F58EFFC5CE0061FD9D73F46A13D91BE89A593282F7DAA3534D1826D1E2B5D05EDADF6A37E60B7A</span><br><span class="line">    PSK identity: None</span><br><span class="line">    PSK identity hint: None</span><br><span class="line">    SRP username: None</span><br><span class="line">    TLS session ticket lifetime hint: 7200 (seconds)</span><br><span class="line">    TLS session ticket:</span><br><span class="line">    0000 - cc 97 5c 83 02 da d4 9c-30 03 6a 4b 12 fd 24 c2   ..\.....0.jK..$.</span><br><span class="line">    0010 - a1 80 ca ff 04 95 33 39-3c 23 a6 6c 44 95 e2 33   ......39&lt;#.lD..3</span><br><span class="line">    0020 - 23 bd 56 20 9e 25 9b 7d-52 36 7a 3b 11 c6 eb b0   #.V .%.&#125;R6z;....</span><br><span class="line">    0030 - d0 bd 7a 62 3e 12 a0 39-35 a3 03 7a 2a fc 93 2e   ..zb&gt;..95..z*...</span><br><span class="line">    0040 - d0 f0 88 a1 6b 99 f3 12-8f 37 d6 cc 6f 30 5f fb   ....k....7..o0_.</span><br><span class="line">    0050 - 78 2e 45 d8 05 d4 fd 6c-69 56 66 e9 f9 73 5c d7   x.E....liVf..s\.</span><br><span class="line">    0060 - 17 68 80 b9 53 19 d4 71-ad 97 8b df a7 3b 11 5f   .h..S..q.....;._</span><br><span class="line">    0070 - 3e 32 55 77 6d 2d 1d a0-95 2e b8 cd 44 de d5 4f   &gt;2Uwm-......D..O</span><br><span class="line">    0080 - 62 ab 1a 02 8f 47 e9 ac-63 56 15 0b 80 a3 1e 84   b....G..cV......</span><br><span class="line">    0090 - 7f 54 e7 f9 d1 39 9e 7e-67 85 d5 1a e3 6e db ad   .T...9.~g....n..</span><br><span class="line"></span><br><span class="line">    Start Time: 1620976664</span><br><span class="line">    Timeout   : 7200 (sec)</span><br><span class="line">    Verify return code: 0 (ok)</span><br><span class="line">    Extended master secret: yes</span><br><span class="line">---</span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨ç«¯s_serverçš„æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:before SSL initialization</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server hello</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write certificate</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write certificate request</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write server done</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client certificate</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read client key exchange</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS read finished</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write session ticket</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write change cipher spec</span><br><span class="line">SSL_accept:SSLv3&#x2F;TLS write finished</span><br><span class="line">-----BEGIN SSL SESSION PARAMETERS-----</span><br><span class="line">MFoCAQECAgMDBALhBwQABDDsafp3IfYNCcL1jv&#x2F;FzgBh&#x2F;Z1z9GoT2Rvomlkygvfa</span><br><span class="line">o1NNGCbR4rXQXtrfajfmC3qhBgIEYJ4kGKIEAgIcIKQGBAQBAAAArQMCAQE&#x3D;</span><br><span class="line">-----END SSL SESSION PARAMETERS-----</span><br><span class="line">Shared ciphers:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:ECDHE-SM2-WITH-SMS4-GCM-SM3:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-SM2-WITH-SMS4-SM3:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:SM9-WITH-SMS4-SM3:SM9DHE-WITH-SMS4-SM3:SM2-WITH-SMS4-SM3:SM2DHE-WITH-SMS4-SM3:AES128-SHA:RSA-WITH-SMS4-SHA1:RSA-WITH-SMS4-SM3</span><br><span class="line">Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Shared Signature Algorithms: RSA+SHA512:DSA+SHA512:ECDSA+SHA512:RSA+SHA384:DSA+SHA384:ECDSA+SHA384:RSA+SHA256:DSA+SHA256:ECDSA+SHA256:RSA+SHA224:DSA+SHA224:ECDSA+SHA224:RSA+SHA1:DSA+SHA1:ECDSA+SHA1:SM2+SM3</span><br><span class="line">Supported Elliptic Curve Point Formats: uncompressed:ansiX962_compressed_prime:ansiX962_compressed_char2</span><br><span class="line">Supported Elliptic Curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">Shared Elliptic curves: SM2:X25519:P-256:P-521:P-384</span><br><span class="line">CIPHER is ECDHE-SM2-WITH-SMS4-GCM-SM3</span><br><span class="line">Secure Renegotiation IS supported</span><br><span class="line">Hello!</span><br><span class="line">ERROR</span><br><span class="line">shutting down SSL</span><br><span class="line">CONNECTION CLOSED</span><br><span class="line">ACCEPT</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h1><h2 id="å›½å¯†SSL-HTTP"><a href="#å›½å¯†SSL-HTTP" class="headerlink" title="å›½å¯†SSL/HTTP"></a>å›½å¯†SSL/HTTP</h2><ul>
<li><p><a href="https://blog.csdn.net/WoTrusCA">æ²ƒé€šçš„CSDNå®˜æ–¹åšå®¢</a>æœ‰è®¸å¤šGMç›¸å…³çš„ä¸œè¥¿ï¼Œå¯ä»¥å¤šçœ‹çœ‹</p>
<p><a href="https://blog.csdn.net/WoTrusCA/article/details/108366659?spm=1001.2014.3001.5501">æ²ƒé€šï¼šå…³äºå›½å¯†HTTPSçš„é‚£äº›äº‹ï¼ˆä¸€ï¼‰</a>ï¼šå›½å¯†SSLçš„åè®®è¿‡ç¨‹çš„å›¾è§£è¯¦ç»†åˆ†æï¼ˆåŒè¯ä¹¦å’ŒåŒå‘è®¤è¯ï¼‰ã€‚</p>
<p><img src="/images/%E5%9B%BD%E5%AF%86%E7%AE%97%E6%B3%95-%E5%8D%8F%E8%AE%AE-%E5%B7%A5%E6%8E%A7/GM-SSL-Process.png" alt="GM-SSL-Process"></p>
<p><a href="https://blog.csdn.net/WoTrusCA/article/details/108398730?spm=1001.2014.3001.5501">æ²ƒé€šï¼šå…³äºå›½å¯†HTTPSçš„é‚£äº›äº‹ï¼ˆäºŒï¼‰</a>ï¼šæ¯ä¸ªåè®®ç‰ˆæœ¬å’Œå¯†ç ç»„ä»¶éƒ½æœ‰å…¶å¯¹åº”çš„å€¼ï¼ˆValue)ï¼ŒClientHelloä¸­åŒ…å«å®¢æˆ·ç«¯æœ¬åœ°æ”¯æŒçš„æ‰€æœ‰å¯†ç ç»„ä»¶ï¼Œä»¥ä¾›æœåŠ¡ç«¯å¯ä»¥é€‰æ‹©ã€‚</p>
<p><a href="https://blog.csdn.net/WoTrusCA/article/details/108440658?spm=1001.2014.3001.5501">æ²ƒé€šï¼šå…³äºå›½å¯†HTTPSçš„é‚£äº›äº‹ï¼ˆä¸‰ï¼‰</a>ï¼š12ä¸ªå›½å¯†ç»„ä»¶åŠå…¶å¯¹åº”å€¼ï¼Œç®€å•é˜è¿°äº†å›½å¯†SSLå’ŒOpensslçš„åŒºåˆ«ã€‚</p>
<p><img src="/images/%E5%9B%BD%E5%AF%86%E7%AE%97%E6%B3%95-%E5%8D%8F%E8%AE%AE-%E5%B7%A5%E6%8E%A7/GM-CipherSuites.png" alt="GM-CipherSuites"></p>
</li>
<li><p><strong>GmSSL-Github-guanzhiç›¸å…³ï¼š</strong></p>
<p>CSDN-viqjeeeï¼š<a href="https://blog.csdn.net/qq_39952971/article/details/115178980">gmssl å›½å¯†sslæµç¨‹æµ‹è¯•</a></p>
<p>CSDN-viqjeeeï¼š<a href="https://blog.csdn.net/qq_39952971/article/details/115168241">gmsslå›½å¯†åŒè¯ä¹¦åˆ¶ä½œ</a></p>
<p>CSDN-viqjeeeï¼š<a href="https://blog.csdn.net/qq_39952971/article/details/115251306?spm=1001.2014.3001.5501">ç™»å½•è¿‡ç¨‹ä¸­å¯†ç çš„å®‰å…¨å’Œæ”»å‡»é£é™©</a></p>
<p>CSDN-viqjeeeï¼š<a href="https://blog.csdn.net/qq_39952971/article/details/114868960?spm=1001.2014.3001.5501">ä½¿ç”¨ç¬¬ä¸‰æ–¹PCå¯¹é€šä¿¡è®¾å¤‡è¿›è¡ŒæŠ“åŒ…çš„æ–¹æ³•</a></p>
<p>CSDN-å°ç«é¾™å‘¢ï¼š<a href="https://blog.csdn.net/qq_15077747/article/details/108218240">GMSSLç¼–è¯‘åŠhttpsé“¾æ¥(ä¸€)</a></p>
<p>CSDN-å°ç«é¾™å‘¢ï¼š<a href="https://blog.csdn.net/qq_15077747/article/details/102501978?spm=1001.2014.3001.5501">TCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹ç†è§£</a></p>
<p><a href="https://kb.cnblogs.com/page/162080/">SSLåè®®è¯¦è§£</a></p>
<p>CSDN-å°ç«é¾™å‘¢ï¼š<a href="https://blog.csdn.net/qq_15077747/article/details/108220046?spm=1001.2014.3001.5501">ç¼–è¯‘é…ç½®nginxæ”¯æŒå›½å¯†ï¼ˆäºŒï¼‰</a></p>
<p>CSDN-å°ç«é¾™å‘¢ï¼š<a href="https://blog.csdn.net/qq_15077747/article/details/108602988?spm=1001.2014.3001.5501">gmsslç¼–è¯‘åä¸æ”¯æŒ360æµè§ˆå™¨åŒå‘httpsé—®é¢˜</a></p>
<p><a href="https://www.cnblogs.com/bigben0123/p/12650545.html">OpenSSLå’ŒGmSSLåœ¨Windowsä¸‹ç¼–è¯‘è¿‡ç¨‹</a></p>
<p><a href="https://www.cnblogs.com/cherishui/p/14626196.html">SSL/TLS ä¸å›½å¯†ç®—æ³•</a></p>
<p><a href="https://www.cnblogs.com/skills/p/13620478.html">GmSSLå¼€å‘ç¯å¢ƒæ­å»ºåŠåŒè¯ä¹¦ç”Ÿæˆ</a>ï¼šåœ¨ç”Ÿæˆè¯ä¹¦é‡Œé¢æ˜¯è®²çš„æœ€è¯¦ç»†ä¹Ÿæ˜¯æœ€å¥½çš„ä¸€ä¸ªåšå®¢æ–‡ç« ï¼ˆæ³¨æ„åšå®¢ç”Ÿæˆæ ¹è¯ä¹¦çš„æ—¶å€™å‘½ä»¤æœ‰ä¸€å¤„é”™è¯¯ï¼ŒRoot.keyåº”è¯¥æ”¹æˆCA.keyï¼‰ï¼ˆæ³¨æ„é‡Œé¢çš„keyå’Œcrtæ–‡ä»¶ï¼‰ï¼ˆå¦‚æœè¿™é‡Œçš„è¯ä¹¦ä¸è¡Œï¼Œç›´æ¥å»å›½å¯†SSLå®éªŒå®¤è¿›è¡Œç”Ÿæˆå°±è¡Œï¼Œéƒ½æœ‰ï¼‰</p>
<p><a href="https://blog.csdn.net/mogoweb/article/details/105020965">ä½•ä¸ºå•è¯ä¹¦å’ŒåŒè¯ä¹¦ï¼Ÿ</a></p>
</li>
</ul>
<h2 id="åˆæœŸèµ„æ–™"><a href="#åˆæœŸèµ„æ–™" class="headerlink" title="åˆæœŸèµ„æ–™"></a>åˆæœŸèµ„æ–™</h2><p><a href="https://juejin.cn/post/6844904114879463438">æ˜é‡‘ï¼šæµ…è°ˆå›½å¯†ç®—æ³•</a>ï¼›</p>
<p><a href="https://www.jianshu.com/p/3ac6d7b3cf02">ç®€ä¹¦ï¼šå›½å¯†ç®—æ³•</a>ï¼›</p>
<p><a href="https://github.com/PopezLotado/SM2Java">SM2çš„Javaç®—æ³•å®ç°</a></p>
<p><a href="https://github.com/windard/sm4/blob/master/README.md">SM4ï¼šGithubçš„ä¸€ä¸ªé¡¹ç›®</a>ï¼›</p>
<p><a href="https://www.huaweicloud.com/theme/484689-1-G">åä¸ºäº‘ï¼šå›½äº§å¯†ç ç®—æ³•</a>ï¼›</p>
<p><a href="https://github.com/hwyqb/SM2_SM3_SM4Encrypt">SM2/SM3/SM4çš„Javaç®—æ³•å®ç°-Github</a>ï¼›</p>
<p><a href="https://www.wosign.com/FAQ/faq_2019062501.htm">å›½å¯†SSLåè®®</a>ï¼›</p>
<p><a href="https://fisco-bcos-documentation.readthedocs.io/zh_CN/latest/docs/articles/3_features/36_cryptographic/index.html">å›½å¯†ç®—æ³•å’Œåè®®</a>ï¼›</p>
<p><a href="https://patents.google.com/patent/CN106656939A/zh">ä¸“åˆ©ï¼šå›½å¯†SSLåè®®å’Œæ ‡å‡†SSLåè®®è½¬å‘ç³»ç»ŸåŠæ–¹æ³•</a>ï¼›</p>
<p><a href="https://patents.google.com/patent/CN104394179A/zh">ä¸“åˆ©ï¼šæ”¯æŒå›½å¯†ç®—æ³•çš„å®‰å…¨å¥—æ¥å±‚åè®®æ‰©å±•æ–¹æ³•</a>ï¼›</p>
<p><a href="https://blog.csdn.net/mrpre/article/details/78015580">CSDNï¼šå›½å¯†SSLåè®®</a>ï¼›CSDNçš„æºç ï¼š<a href="https://github.com/mrpre/atls">Githubï¼šATls</a>ï¼›æœ‰wiresharkæŠ“åŒ…è¿›è¡Œåˆ†æ</p>
<p><a href="https://blog.csdn.net/WoTrusCA/article/details/108440658">å…³äºå›½å¯†HTTPSçš„é‚£äº›äº‹</a></p>
<p><a href="https://blog.csdn.net/upset_ming/article/details/79880688">å›½å¯†SSLåè®®å¼€å‘æ€»ç»“ï¼ˆé™„æŠ¥æ–‡è¯¦ç»†åˆ†æï¼‰</a>ï¼šè¯¦ç»†åˆ†æäº†GMSSLåè®®çš„åˆæ ¼éƒ¨åˆ†å’Œè¿‡ç¨‹ï¼ˆå¾ˆå…¨äº†ï¼‰ï¼Œå…¶<a href="https://blog.csdn.net/upset_ming">å¤§å®CAå›½å¯†SSLå›½å¯†TOMCAT_CSDNåšå®¢</a>)æœ‰ä¸€äº›ç›¸å…³çš„ä¸œè¥¿ï¼Œæ³¨æ„è¿˜æœ‰ä¸€ä¸ª<a href="https://www.doubleca.com/test_toIndexPage.action">å¤§å®CAæ•°å­—è¯ä¹¦æµ‹è¯•å¹³å°</a>ã€‚</p>
<p><em><strong>segmentfaultå¹³å°ï¼š</strong></em><a href="https://segmentfault.com/a/1190000024448440">å›½å¯†SSLæ€§èƒ½æµ‹è¯•</a>-å¯ä»¥ç»“åˆå‰é¢å›½å¯†SSLå®éªŒå®¤çš„æµ‹è¯•å·¥å…·è¿›è¡Œã€‚<a href="https://segmentfault.com/a/1190000023890321?utm_source=sf-similar-article">å›½å¯†SSLä¹‹Javaå®ç°</a>-æœ‰Javaæºç ï¼Œæ„Ÿè§‰å¯èƒ½ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚<a href="https://segmentfault.com/a/1190000016808783?utm_source=sf-similar-article">Bytomå›½å¯†ç½‘è¯´æ˜å’ŒæŒ‡å—</a>-æœ‰Githubæºç ã€‚</p>
<p><a href="https://developer.aliyun.com/article/770830">å›½å¯†SSLåè®®ä¹‹Nginxé›†æˆ</a>ï¼šç»“åˆå‰é¢çš„<em>å›½å¯†SSLå®éªŒå®¤</em>è¿›è¡Œï¼Œåœ¨CentOS 7ç¯å¢ƒä¸Šå®éªŒï¼ˆå¤±è´¥ï¼‰</p>
<p><a href="https://cloud.tencent.com/developer/article/1597165">æ­å»ºå›½å¯†SSLå¼€å‘æµ‹è¯•ç¯å¢ƒ</a>ï¼šç»“åˆå‰é¢çš„<em><strong>GmSSL-å…³å¿—æ•™å¸ˆ-Github</strong></em>è¿›è¡Œï¼Œåœ¨CentOS 7ç¯å¢ƒä¸Šè¿›è¡Œå®éªŒï¼ˆæˆåŠŸï¼‰</p>
]]></content>
      <tags>
        <tag>algorithm</tag>
        <tag>protocol</tag>
        <tag>Industrial control</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>/manifest.json</url>
    <content><![CDATA[{"name":"Koper","short_name":"Koper","start_url":"/","icons":[{"src":"/images/siteicon/android-chrome-36x36.png","sizes":"36x36","type":"image/png"},{"src":"/images/siteicon/android-chrome-48x48.png","sizes":"48x48","type":"image/png"},{"src":"/images/siteicon/android-chrome-72x72.png","sizes":"72x72","type":"image/png"},{"src":"/images/siteicon/android-chrome-96x96.png","sizes":"96x96","type":"image/png"},{"src":"/images/siteicon/android-chrome-144x144.png","sizes":"144x144","type":"image/png"},{"src":"/images/siteicon/android-chrome-192x192.png","sizes":"192x192","type":"image/png"},{"src":"/images/siteicon/android-chrome-256x256.png","sizes":"256x256","type":"image/png"},{"src":"/images/siteicon/android-chrome-384x384.png","sizes":"384x384","type":"image/png"},{"src":"/images/siteicon/android-chrome-512x512.png","sizes":"512x512","type":"image/png"}],"theme_color":"#ffffff","background_color":"#ffffff","display":"standalone"}]]></content>
  </entry>
  <entry>
    <title>archives</title>
    <url>/archives/index.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>categories</title>
    <url>/categories/index.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>tags</title>
    <url>/tags/index.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>about</title>
    <url>/about/index.html</url>
    <content><![CDATA[<p>å…³äºæˆ‘ï¼š</p>
<p>ä¸€ååœ¨è¯»çš„æ‰“å·¥äººï¼Œæ¯å¤©çš„äº‹å°±æ˜¯ç§‘ç ”ç§‘ç ”</p>
<p>åŒæ—¶åˆ†äº«è‡ªå·±åœ¨è¯»çš„ç”Ÿæ´»å’Œä¸€äº›æ—¥å¸¸</p>
]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/images/siteicon/README.html</url>
    <content><![CDATA[<h1 id="Your-Favicon-Package"><a href="#Your-Favicon-Package" class="headerlink" title="Your Favicon Package"></a>Your Favicon Package</h1><p>This package was generated with <a href="https://realfavicongenerator.net/">RealFaviconGenerator</a> <a href="https://realfavicongenerator.net/change_log#v0.16">v0.16</a></p>
<h2 id="Install-instructions"><a href="#Install-instructions" class="headerlink" title="Install instructions"></a>Install instructions</h2><p>To install this package:</p>
<p>Extract this package in <code>&lt;web site&gt;/images/siteicon/</code>. If your site is <code><a href="http://www.example.com/">http://www.example.com</a></code>, you should be able to access a file named <code><a href="http://www.example.com/images/siteicon/favicon.ico">http://www.example.com/images/siteicon/favicon.ico</a></code>.</p>
<p>Insert the following code in the <code>head</code> section of your pages:</p>
<pre><code>&lt;link rel=&quot;apple-touch-icon&quot; sizes=&quot;180x180&quot; href=&quot;/images/siteicon/apple-touch-icon.png&quot;&gt;
&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;32x32&quot; href=&quot;/images/siteicon/favicon-32x32.png&quot;&gt;
&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;16x16&quot; href=&quot;/images/siteicon/favicon-16x16.png&quot;&gt;
&lt;link rel=&quot;manifest&quot; href=&quot;/images/siteicon/site.webmanifest&quot;&gt;
&lt;link rel=&quot;mask-icon&quot; href=&quot;/images/siteicon/safari-pinned-tab.svg&quot; color=&quot;#5bbad5&quot;&gt;
&lt;link rel=&quot;shortcut icon&quot; href=&quot;/images/siteicon/favicon.ico&quot;&gt;
&lt;meta name=&quot;apple-mobile-web-app-title&quot; content=&quot;Koper&quot;&gt;
&lt;meta name=&quot;application-name&quot; content=&quot;Koper&quot;&gt;
&lt;meta name=&quot;msapplication-TileColor&quot; content=&quot;#c4bdc5&quot;&gt;
&lt;meta name=&quot;msapplication-config&quot; content=&quot;/images/siteicon/browserconfig.xml&quot;&gt;
&lt;meta name=&quot;theme-color&quot; content=&quot;#ffffff&quot;&gt;
</code></pre>
<p><em>Optional</em> - Check your favicon with the <a href="https://realfavicongenerator.net/favicon_checker">favicon checker</a></p>
]]></content>
  </entry>
</search>
